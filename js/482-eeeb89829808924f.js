try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="594db7d0-7819-48d1-b4d6-5a933efdb01e",e._sentryDebugIdIdentifier="sentry-dbid-594db7d0-7819-48d1-b4d6-5a933efdb01e")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[482],{1409:(e,t,n)=>{"use strict";n.d(t,{N:()=>rq});var a,r=n(6029),o=n(2283),i=n(69443),l=n(96059),s=n(3735),d=n(28157),u=n(55729),c=function(e){return e.TEXT="text",e.IMAGE="image",e.VIDEO="video",e.EMBED="embed",e.AUDIO="audio",e}({}),p=function(e){return e.TEXT="text input",e.NUMBER="number input",e.EMAIL="email input",e.URL="url input",e.DATE="date input",e.TIME="time input",e.PHONE="phone number input",e.CHOICE="choice input",e.PICTURE_CHOICE="picture choice input",e.PAYMENT="payment input",e.RATING="rating input",e.FILE="file input",e.CARDS="cards",e}({}),m=function(e){return e.GOOGLE_SHEETS="Google Sheets",e.OPEN_AI="OpenAI",e.GOOGLE_ANALYTICS="Google Analytics",e.HTTP_REQUEST="Webhook",e.EMAIL="Email",e.ZAPIER="Zapier",e.MAKE_COM="Make.com",e.PABBLY_CONNECT="Pabbly",e.CHATWOOT="Chatwoot",e.PIXEL="Pixel",e}({}),b=function(e){return e.SET_VARIABLE="Set variable",e.CONDITION="Condition",e.REDIRECT="Redirect",e.SCRIPT="Code",e.TYPEBOT_LINK="Typebot link",e.WAIT="Wait",e.AB_TEST="AB test",e.WEBHOOK="webhook",e.JUMP="Jump",e.RETURN="Return",e}({});let g=["openai","cal-com","chat-node","qr-code","dify-ai","mistral","elevenlabs","anthropic","together-ai","open-router","nocodb","segment","posthog","groq","zendesk","perplexity","deepseek","blink","gmail"],h=e=>{if("number"==typeof e)return e;if(!e)return;let t=Number.parseFloat(e.toString().replace(",","."));return isNaN(t)?void 0:t};var y=n(31078),f=n(61686);(e=>{void 0===e.ZodType.prototype.layout&&(e.ZodType.prototype.layout=function(e){return new this.constructor({...this._def,layout:e})})})(y.z),(0,f.I)(y.z);let v=e=>!!e&&e.startsWith("{{")&&e.endsWith("}}")&&2===e.split("{{").length,w=y.z.array(y.z.string().nullable()),I=y.z.object({id:y.z.string(),name:y.z.string(),isSessionVariable:y.z.boolean().optional()});I.extend({value:y.z.string().or(w).nullish()}),I.extend({value:y.z.string().or(w)}),I.extend({value:y.z.unknown()}),y.z.custom(e=>/^{{.+}}$/g.test(e));let E=y.z.string().or(y.z.number()).transform(e=>"string"==typeof e?v(e)?e:h(e):e).openapi({effectType:"input"});y.z.object({resultId:y.z.string(),index:y.z.number(),blockId:y.z.string(),variableId:y.z.string(),value:y.z.string().or(w).nullable()});let x={object:e=>y.z.object(e),literal:e=>y.z.literal(e),string:y.z.string().optional(),boolean:y.z.boolean().optional(),enum:e=>y.z.enum(e).optional(),number:E.optional(),staticNumber:y.z.number().optional(),array:e=>y.z.array(e).optional(),discriminatedUnion:(e,t)=>y.z.discriminatedUnion(e,[y.z.object({[e]:y.z.undefined()}),...t]),saveResponseArray:(e,t)=>{var n,a;return y.z.array(y.z.object({item:y.z.enum(e).optional().layout({...null!=(n=null==t?void 0:t.item)?n:{},placeholder:"Select a response"}),variableId:y.z.string().optional().layout({...null!=(a=null==t?void 0:t.variableId)?a:{},inputType:"variableDropdown"})})).optional()},filter:e=>{let{operators:t=_,isJoinerHidden:n}=e;return y.z.object({comparisons:y.z.array(y.z.object({input:y.z.string().optional().layout({label:"Enter a field "}),operator:y.z.enum(t).optional().layout({defaultValue:"Equal to"}),value:y.z.string().optional().layout({placeholder:"Enter a value"})})),joiner:y.z.enum(["AND","OR"]).optional().layout({placeholder:"Select joiner",isHidden:n})}).optional()}},_=["Equal to","Not equal","Contains","Does not contain","Greater than","Less than","Is set","Is empty","Starts with","Ends with","Matches regex","Does not match regex"];var T=n(69394);let C=e=>{var t,n;return null==(n=e.responseMapping)||null==(t=n.find(e=>"Message content"===e.item||!e.item))?void 0:t.variableId};var S=n(20996);let k=async e=>{let{err:t,context:n}=e;try{if("string"==typeof t)return{context:n,description:t,details:void 0};if(t instanceof Error)return{context:n,description:t.message,details:await P(t)};return{context:n,description:JSON.stringify(t)}}catch(e){return console.error(e),S.Cp(e),{context:n,description:"Unknown error (failed to parse)"}}},N=e=>{let{err:t,context:n}=e;try{if("string"==typeof t)return{context:n,description:t,details:void 0};if(t instanceof Error)return{context:n,description:t.message,details:A(t)};return{context:n,description:JSON.stringify(t)}}catch(e){return S.Cp(e),{context:n,description:"Unknown error (failed to parse)"}}},A=e=>"responseBody"in e?"string"==typeof e.responseBody?e.responseBody:JSON.stringify(e.responseBody):"string"==typeof e.cause?e.cause:JSON.stringify(e.cause),P=async e=>"responseBody"in e?"string"==typeof e.responseBody?e.responseBody:JSON.stringify(e.responseBody):"response"in e&&"object"==typeof e.response&&e.response&&"text"in e.response&&"function"==typeof e.response.text&&!e.response.bodyUsed?await e.response.text():"string"==typeof e.cause?e.cause:JSON.stringify(e.cause);var R=n(17072);let j=["Message content","Total tokens","Prompt tokens","Completion tokens"];var L=n(70491),U=n(11335);let O=async e=>{let{input:t,shouldDownloadImages:n}=e,a=t.split("\n\n"),r=[];for(let e of a){var o,i;if(e.startsWith("http")||e.startsWith('["http'))for(let t of e.startsWith("[")?JSON.parse(e):[e]){let e=t.trim();try{let a=await L.Ay.get(e);a.ok&&(null==(o=a.headers.get("content-type"))?void 0:o.startsWith("image/"))?r.push({type:"image",image:n?await a.arrayBuffer():t.trim()}):r.push({type:"text",text:e})}catch(e){e instanceof U.H?console.log(e.response.status,await e.response.text()):console.error(e)}}else if((null==(i=r.at(-1))?void 0:i.type)==="text"){let t=r.at(-1);(r=r.slice(0,-1)).push({type:"text",text:t.text+"\n\n"+e})}else r.push({type:"text",text:e})}return r},V=async e=>{let{messages:t,isVisionEnabled:n,shouldDownloadImages:a,variables:r}=e;return t?(await Promise.all(t.map(async e=>{if(e.role)return"Dialogue"===e.role?D({message:e,variables:r,isVisionEnabled:n,shouldDownloadImages:a}):B({message:e,variables:r,isVisionEnabled:n,shouldDownloadImages:a})}))).flat().filter(o.O9):[]},D=async e=>{var t;let{message:n,variables:a,isVisionEnabled:r,shouldDownloadImages:o}=e;if(!n.dialogueVariableId)return;let i=null!=(t=a.get(n.dialogueVariableId))?t:[];return Promise.all((Array.isArray(i)?i:[i]).map(async(e,t)=>{if(e)return 0===t&&"assistant"===n.startsBy?{role:"assistant",content:e}:t%("assistant"===n.startsBy?1:2)==0?{role:"user",content:r?await O({input:null!=e?e:"",shouldDownloadImages:o}):e}:{role:"assistant",content:e}}))},B=async e=>{let{message:t,variables:n,isVisionEnabled:a,shouldDownloadImages:r}=e;if(!t.content)return;let i=n.parse(t.content);if(!(0,o.Im)(i))return"user"===t.role?{role:"user",content:a?await O({input:i,shouldDownloadImages:r}):i}:{role:t.role,content:i}},z=e=>{if((0,o.pN)(e))return null;if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return console.warn("Failed to safely stringify variable value",e),null}};var M=n(47668),H=n.n(M);let K=e=>{if(null===e)return null;if(void 0===e)return;if("string"!=typeof e)return e;let t=e.startsWith("0")&&!e.startsWith("0.")&&e.length>1;if("string"==typeof e&&t)return e;let n=e.startsWith("+");return"string"==typeof e&&n||"number"==typeof e?e:"true"===e||"false"!==e&&("null"===e?null:"undefined"!==e?isNaN(e)?e:Number(e):void 0)},G=e=>{let{variables:t,sessionStore:n}=e,a=n.getOrCreateIsolate().createContextSync(),r=a.global;return r.setSync("global",r.derefInto()),t.forEach(e=>{r.setSync(e.id,W(K(e.value)))}),e=>a.evalClosureSync("return (function() {\n    return new Function($0)();\n  }())",[e],{result:{copy:!0},timeout:1e4})},W=e=>"object"==typeof e?new(H()).ExternalCopy(e).copyInto():e,F=e=>t=>[...t.matchAll(/\{\{(.*?)\}\}/g)].reduce((t,n)=>{let a=n[1],r=e.find(e=>e.name===a);return!r||t.find(e=>e.id===r.id)?t:[...t,r]},[]),q=/\{\{=(.+?)=\}\}/g,X=/\{\{([^{}]+)\}\}|(\$)\{\{([^{}]+)\}\}/g,Y=(e,t)=>{let{variables:n,sessionStore:a,fieldToParse:r="value",isInsideJson:i=!1,takeLatestIfList:l=!1,isInsideHtml:s=!1}=t;return e&&""!==e?e.replace(q,(e,t)=>{var r;let o=J(t,{variables:n,sessionStore:a});return null!=(r=z(o))?r:o}).replace(X,(e,t,a,d)=>{let u=null!=a?a:"",c=null!=t?t:d,p=n.find(e=>c===e.name&&("id"===r||(0,o.O9)(e.value)));if(!p)return u+"";if("id"===r)return u+p.id;let{value:m}=p;if(i)return u+$(m);let b=u+z(l&&Array.isArray(m)?m[m.length-1]:m);return b?s?Q(b):b:u+""}):""},J=(e,t)=>{let{variables:n,sessionStore:a}=t;try{let t=Y(e,{variables:n,sessionStore:a,fieldToParse:"id"});return G({variables:n,sessionStore:a})(t.includes("return ")?t:"return ".concat(t))}catch(t){return Y(e,{variables:n,sessionStore:a})}},$=e=>{let t=JSON.stringify(e);return"string"==typeof e?t.slice(1,-1):t},Q=e=>"string"==typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;"):JSON.stringify(e).replace(/</g,"&lt;").replace(/>/g,"&gt;"),Z=async e=>{let{variables:t,body:n,sessionStore:a,args:r}=e,i=Y(n,{fieldToParse:"id",variables:t,sessionStore:a}),l=F(t)(n).map(e=>({id:e.id,value:K(e.value)})).concat(r?Object.entries(r).map(e=>{let[t,n]=e;return{id:t,value:n}}):[]),d=new Map,u=a.getOrCreateIsolate().createContextSync(),c=u.global;c.setSync("global",c.derefInto()),u.evalClosure("globalThis.setVariable = (...args) => $0.apply(undefined, args, { arguments: { copy: true }, promise: true, result: { copy: true, promise: true } })",[new M.Reference((e,t)=>{d.set(e,t)})]),u.evalClosure("globalThis.fetch = (...args) => $0.apply(undefined, args, { arguments: { copy: true }, promise: true, result: { copy: true, promise: true } })",[new M.Reference(async function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(await fetch(...t)).text()})]),l.forEach(e=>{let{id:t,value:n}=e;c.setSync(t,W(n))});try{let e=await u.evalClosure("return (async function() {\n		const AsyncFunction = async function () {}.constructor;\n		return new AsyncFunction($0)();\n	}())",[i],{result:{copy:!0,promise:!0},timeout:1e4});return u.release(),{output:e,newVariables:Array.from(d.entries()).map(e=>{let[n,a]=e,r=t.find(e=>e.name===n);if(r)return{id:r.id,name:r.name,value:a}}).filter(o.O9)}}catch(t){u.release(),"development"===s._.NODE_ENV&&(console.log("Error while executing the function"),console.error(t));let e=await k({err:t,context:"While executing function"});return{error:e,output:e}}},ee=e=>{let{tools:t,variables:n,sessionStore:a}=e;return(null==t?void 0:t.length)?t.reduce((e,t)=>(t.code&&t.name&&(e[t.name]={description:t.description,parameters:et(t.parameters),execute:async e=>{var r;let{output:o,newVariables:i}=await Z({sessionStore:a,variables:n.list(),args:e,body:t.code});return i&&i.length>0&&n.set(i),null!=(r=z(o))?r:""}}),e),{}):{}},et=e=>{if(!e||(null==e?void 0:e.length)===0)return y.z.object({});let t={};return e.forEach(e=>{if(e.name){switch(e.type){case"string":t[e.name]=y.z.string();break;case"number":t[e.name]=y.z.number();break;case"boolean":t[e.name]=y.z.boolean();break;case"enum":if(!e.values||0===e.values.length)return;t[e.name]=y.z.enum(e.values)}(0,o.hj)(e.description)&&(t[e.name]=t[e.name].describe(e.description)),!1===e.required&&(t[e.name]=t[e.name].optional())}}),y.z.object(t)},en=async e=>{let{variables:t,messages:n,model:a,isVisionEnabled:r,temperature:o,tools:i,responseMapping:l,logs:s,sessionStore:d,headers:u}=e;try{let e=await V({messages:n,variables:t,isVisionEnabled:r,shouldDownloadImages:!1}),s=await (0,R.Df)({model:a,temperature:o,messages:e,tools:ee({tools:i,variables:t,sessionStore:d}),maxSteps:6,headers:u});return null==l||l.forEach(e=>{e.variableId&&(e.item&&"Message content"!==e.item||t.set([{id:e.variableId,value:s.text}]),"Total tokens"===e.item&&t.set([{id:e.variableId,value:s.usage.totalTokens}]),"Prompt tokens"===e.item&&t.set([{id:e.variableId,value:s.usage.promptTokens}]),"Completion tokens"===e.item&&t.set([{id:e.variableId,value:s.usage.completionTokens}]))}),s}catch(e){s.add(await k({err:e,context:"While generating chat completion"}))}},ea=async e=>{let{variables:t,messages:n,model:a,isVisionEnabled:r,temperature:o,tools:i,responseMapping:l,onFinish:s,sessionStore:d,headers:u}=e;try{let e=await V({messages:n,variables:t,isVisionEnabled:r,shouldDownloadImages:!1});return{stream:(0,R.gM)({model:a,messages:e,temperature:o,tools:ee({tools:i,variables:t,sessionStore:d}),maxSteps:6,headers:u,onFinish:e=>{null==l||l.forEach(n=>{n.variableId&&("Total tokens"===n.item&&t.set([{id:n.variableId,value:e.usage.totalTokens}]),"Prompt tokens"===n.item&&t.set([{id:n.variableId,value:e.usage.promptTokens}]),"Completion tokens"===n.item&&t.set([{id:n.variableId,value:e.usage.completionTokens}]))}),null==s||s(e)}}).toDataStream({getErrorMessage:e=>JSON.stringify(N({err:e,context:"While streaming AI"})),sendUsage:!1})}}catch(e){return{error:await k({err:e,context:"While running chat completion stream"})}}},er={name:x.string.layout({label:"Name",placeholder:"myVariable",withVariableButton:!1}),description:x.string.layout({label:"Description",withVariableButton:!1}),required:x.boolean.layout({label:"Is required?"})},eo=x.array(x.discriminatedUnion("type",[x.object({type:x.literal("string")}).extend(er),x.object({type:x.literal("number")}).extend(er),x.object({type:x.literal("boolean")}).extend(er),x.object({type:x.literal("enum"),values:x.array(x.string).layout({itemLabel:"possible value"})}).extend(er)])).layout({accordion:"Parameters",itemLabel:"parameter"}),ei=x.object({type:x.literal("function"),name:x.string.layout({label:"Name",placeholder:"myFunctionName",withVariableButton:!1}),description:x.string.layout({label:"Description",placeholder:"A brief description of what this function does.",withVariableButton:!1}),parameters:eo,code:x.string.layout({inputType:"code",label:"Code",lang:"javascript",moreInfoTooltip:"A javascript code snippet that can use the defined parameters. It should return a value.",withVariableButton:!1})}),el=x.array(x.discriminatedUnion("type",[ei])).layout({accordion:"Tools",itemLabel:"tool"}),es={type:"encryptedCredentials",name:"Anthropic account",schema:x.object({apiKey:x.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can generate an API key [here](https://console.anthropic.com/settings/keys).",placeholder:"sk-...",withVariableButton:!1,isDebounceDisabled:!0})})},ed=["claude-opus-4-1","claude-sonnet-4-0","claude-opus-4-0","claude-3-7-sonnet-latest","claude-3-5-haiku-latest","claude-3-5-sonnet-latest","claude-3-opus-latest"],eu=["claude-3*"];function ec(e){return"-"===e||"^"===e||"$"===e||"+"===e||"."===e||"("===e||")"===e||"|"===e||"["===e||"]"===e||"{"===e||"}"===e||"*"===e||"?"===e||"\\"===e?"\\".concat(e):e}function ep(e,t){if("string"!=typeof t)throw TypeError("Sample must be a string, but ".concat(typeof t," given"));return e.test(t)}let em=(e,t)=>{if("string"!=typeof e&&!Array.isArray(e))throw TypeError("The first argument must be a single pattern string or an array of patterns, but ".concat(typeof e," given"));if(("string"==typeof t||"boolean"==typeof t)&&(t={separator:t}),"\\"===(t=t||{}).separator)throw Error("\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead");let n=function e(t){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(Array.isArray(t)){let a=t.map(t=>"^".concat(e(t,n),"$"));return"(?:".concat(a.join("|"),")")}let a="",r="",o=".";!0===n?(a="/",r="[/\\\\]",o="[^/\\\\]"):n&&((r=function(e){let t="";for(let n=0;n<e.length;n++)t+=ec(e[n]);return t}(a=n)).length>1?(r="(?:".concat(r,")"),o="((?!".concat(r,").)")):o="[^".concat(r,"]"));let i=n?"".concat(r,"+?"):"",l=n?"".concat(r,"*?"):"",s=n?t.split(a):[t],d="";for(let e=0;e<s.length;e++){let t=s[e],a=s[e+1],r="";if(t||!(e>0)){if(n&&(r=e===s.length-1?l:"**"!==a?i:""),n&&"**"===t){r&&(d+=0===e?"":r,d+="(?:".concat(o,"*?").concat(r,")*?"));continue}if(t){for(let e=0;e<t.length;e++){let n=t[e];"\\"===n?e<t.length-1&&(d+=ec(t[e+1]),e++):"?"===n?d+=o:"*"===n?d+="".concat(o,"*?"):d+=ec(n)}d+=r}}}return d}(e,t.separator),a=new RegExp("^".concat(n,"$"),t.flags),r=ep.bind(null,a);return r.options=t,r.pattern=e,r.regexp=a,r},eb=e=>!!e&&em(eu)(e),eg={content:x.string.layout({inputType:"textarea",placeholder:"Content"})},eh=x.object({role:x.literal("user")}).extend(eg),ey=x.object({role:x.literal("assistant")}).extend(eg),ef=x.object({role:x.literal("Dialogue"),dialogueVariableId:x.string.layout({inputType:"variableDropdown",placeholder:"Dialogue variable"}),startsBy:x.enum(["user","assistant"]).layout({label:"starts by",direction:"row",defaultValue:"user"})}),ev=x.object({model:x.string.layout({placeholder:"Select a model",allowCustomValue:!0,autoCompleteItems:ed,label:"Model"}),messages:x.array(x.discriminatedUnion("role",[eh,ey,ef])).layout({accordion:"Messages",itemLabel:"message",isOrdered:!0}),tools:el,systemMessage:x.string.layout({accordion:"Advanced Settings",label:"System prompt",direction:"row",inputType:"textarea"}),temperature:x.number.layout({accordion:"Advanced Settings",label:"Temperature",direction:"row",placeholder:"1"}),maxTokens:x.number.layout({accordion:"Advanced Settings",label:"Max Tokens",direction:"row",defaultValue:1024}),responseMapping:y.z.preprocess(e=>Array.isArray(e)?e.map(e=>"Message Content"===e.item?{...e,item:"Message content"}:e):void 0,x.saveResponseArray(["Message content"]).layout({accordion:"Save Response"}))}),ew=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{...e,model:t?void 0:e.model,action:"Create chat completion"}},eI={variableId:x.string.layout({inputType:"variableDropdown"}),description:x.string.layout({label:"Description",accordion:"Advanced"}),isRequired:x.boolean.layout({label:"Is required",moreInfoTooltip:"If set to false, there is a chance the variable will be empty",accordion:"Advanced",defaultValue:!0})},eE=x.array(x.discriminatedUnion("type",[x.object({type:x.literal("string")}).extend(eI),x.object({type:x.literal("number")}).extend(eI),x.object({type:x.literal("boolean")}).extend(eI),x.object({type:x.literal("array")}).extend(eI),x.object({type:x.literal("enum"),values:x.array(x.string).layout({itemLabel:"possible value",mergeWithLastField:!0})}).extend(eI)])).layout({itemLabel:"variable mapping",accordion:"Schema"}),ex=e=>{let{models:t}=e;return x.object({model:x.string.layout({placeholder:"Select a model",label:"Model",allowCustomValue:!0,helperText:t.helperText,autoCompleteItems:"static"===t.type?t.models:void 0,fetcher:"fetcher"===t.type?t.id:void 0}),prompt:x.string.layout({label:"Prompt",placeholder:"Type your text here",inputType:"textarea",isRequired:!0,moreInfoTooltip:'Meant to guide the model on what to generate. i.e. "Generate a role-playing game character", "Extract the company name from this text", etc.'}),variablesToExtract:eE})},e_=async e=>{let{variablesToExtract:t,model:n,prompt:a,variables:r,logs:o}=e;if(!a)return o.add("No prompt provided");let i=r.list(),l=eT({variablesToExtract:t,variables:i});if(!l)return void o.add("Could not parse variables to extract");let s=null==t?void 0:t.some(e=>!1===e.isRequired);try{let{object:e}=await (0,R.pY)({model:n,schema:l,prompt:"".concat(a,"\n\nYou should generate a JSON object")+(s?" and provide empty values if the information is not there or if you are unsure.":".")});Object.entries(e).forEach(e=>{let[t,n]=e;if(null===n)return;let a=i.find(e=>e.name===t);a&&r.set([{id:a.id,value:n}])})}catch(e){o.add(await k({err:e}))}},eT=e=>{let{variablesToExtract:t,variables:n}=e;if(!t||(null==t?void 0:t.length)===0)return;let a={};return t.forEach(e=>{if(!e)return;let t=n.find(t=>t.id===e.variableId);if(t){switch(e.type){case"string":a[t.name]=y.z.string();break;case"number":a[t.name]=y.z.number();break;case"boolean":a[t.name]=y.z.boolean();break;case"array":a[t.name]=y.z.array(y.z.string());break;case"enum":if(!e.values||0===e.values.length)return;a[t.name]=y.z.enum(e.values)}!1===e.isRequired&&(a[t.name]=a[t.name].nullish()),(0,o.hj)(e.description)&&(a[t.name]=a[t.name].describe(e.description))}}),y.z.object(a)},eC={name:"Generate variables",auth:es,options:ex({models:{type:"static",models:ed}}),turnableInto:[{blockId:"openai"},{blockId:"mistral"}],aiGenerate:{models:{type:"static",items:ed},getModel:e=>{let{credentials:t,model:n}=e;return(0,T.n)({apiKey:t.apiKey})(n)}},getSetVariableIds:e=>{var t,n;return null!=(n=null==(t=e.variablesToExtract)?void 0:t.map(e=>e.variableId).filter(o.O9))?n:[]},run:{server:e=>{let{credentials:t,options:n,variables:a,logs:r}=e;return(null==t?void 0:t.apiKey)===void 0?r.add("No API key provided"):void 0===n.model?r.add("No model provided"):e_({model:(0,T.n)({apiKey:t.apiKey})(n.model),prompt:n.prompt,variablesToExtract:n.variablesToExtract,variables:a,logs:r})}}},eS={type:"encryptedCredentials",name:"Blink app",schema:x.object({apiKey:x.string.layout({label:"App token",isRequired:!0,inputType:"password",helperText:"You can generate an app token by following [the official Blink instructions](https://developer.joinblink.com/docs/creating-an-integration).",withVariableButton:!1,isDebounceDisabled:!0})})},ek={email:"Emails",company_name:"Company Names",first_name:"First Names",second_name:"Second Names",display_name:"Display Names",initials:"Initials",job_title:"Job Titles",profile_photo_id:"Profile Photo IDs",timezone:"Timezones",manager_id:"Manager IDs",department_name:"Department Names",account_status:"Account Statuses",id:"User IDs",employee_id:"Employee IDs"},eN="https://api.joinblink.com/v2",eA={name:"Get Users",auth:eS,options:x.object({filter:x.discriminatedUnion("type",[x.object({type:x.literal("User ID"),userId:x.string}),x.object({type:x.literal("Employee ID"),employeeId:x.string})]).optional().layout({accordion:"Filter"}),responseMapping:x.saveResponseArray(Object.values(ek)).layout({accordion:"Save in variables"})}),getSetVariableIds:e=>{var t,n;return null!=(n=null==(t=e.responseMapping)?void 0:t.map(e=>e.variableId).filter(o.O9))?n:[]},run:{server:async e=>{let{credentials:t,options:n,variables:a,logs:r}=e;if((null==t?void 0:t.apiKey)===void 0)return r.add("No API key provided");if(!n.filter)return r.add("No filter provided");try{var i;let e=await L.Ay.get("".concat(eN,"/user"),{headers:{Authorization:"Bearer ".concat(t.apiKey)},searchParams:"Employee ID"===n.filter.type&&n.filter.employeeId?{employeeId:n.filter.employeeId}:"User ID"===n.filter.type&&n.filter.userId?{userId:n.filter.userId}:void 0}).json(),r=null==(i=n.responseMapping)?void 0:i.map(t=>{if(!t.variableId)return;let n=Object.keys(ek).find(e=>ek[e]===t.item);if(!n)return;let a=e.data.flatMap(e=>e[n]);return{id:t.variableId,value:a.length>1?a:a[0]}}).filter(o.O9);if(!r)return;a.set(r)}catch(e){if(e instanceof U.H)return r.add(await k({err:e,context:"While searching Blink users"}));console.error(e)}}}};var eP=function(e){return e.URL="url",e.YOUTUBE="youtube",e.VIMEO="vimeo",e.TIKTOK="tiktok",e.GUMLET="gumlet",e}({});let eR={aspectRatio:"16/9",maxWidth:"100%"},ej={aspectRatio:"9/16",maxWidth:"400px"},eL=/youtube\.com\/(watch\?v=|shorts\/)([\w-]+)|youtu\.be\/([\w-]+)(\?.+)*/,eU={t:"start"},eO=/vimeo\.com\/(\d+)/,eV=/tiktok\.com\/@[\w.-]+\/video\/(\d+)/,eD=/gumlet\.(com|tv)\/watch\/(\w+)/,eB=/https:\/\/onedrive.live.com\/embed\?[^"]+/,ez=e=>{var t,n,a,r,o,i,l;if(eL.test(e)){let a=e.match(eL),r=null!=(t=null==a?void 0:a.at(2))?t:null==a?void 0:a.at(3),o=(null==a?void 0:a.at(4))?new URLSearchParams(a.at(4)):void 0;Object.entries(eU).forEach(e=>{let[t,n]=e;(null==o?void 0:o.has(t))&&(o.set(n,o.get(t)),o.delete(t))});let i=null!=(n=null==a?void 0:a.at(0))?n:e;return r?{type:eP.YOUTUBE,url:i,id:r,queryParamsStr:o?"?"+o.toString():void 0,videoSizeSuggestion:e.includes("shorts")?ej:eR}:{type:eP.URL,url:i}}if(eO.test(e)){let t=e.match(eO),n=null==t?void 0:t.at(1),r=null!=(a=null==t?void 0:t.at(0))?a:e;return n?{type:eP.VIMEO,url:r,id:n,videoSizeSuggestion:eR}:{type:eP.URL,url:r}}if(eV.test(e)){let t=e.match(eV),n=null==(r=e.match(eV))?void 0:r.at(1),a=null!=(o=null==t?void 0:t.at(0))?o:e;return n?{type:eP.TIKTOK,url:a,id:n,videoSizeSuggestion:ej}:{type:eP.URL,url:a}}if(eD.test(e)){let t=e.match(eD),n=null==t?void 0:t.at(2),a=null!=(i=null==t?void 0:t.at(0))?i:e;return n?{type:eP.GUMLET,url:a,id:n,videoSizeSuggestion:eR}:{type:eP.URL,url:a}}if(eB.test(e)){let t=e.match(eB),n=null!=(l=null==t?void 0:t.at(0))?l:e;return{type:eP.URL,url:n.replace("/embed","/download")}}return{type:eP.URL,url:e}},eM={"audio/aac":"aac","audio/mp3":"mp3","audio/mp4":"m4a","audio/mpeg":"mp3","audio/ogg":"ogg","audio/wav":"wav","audio/wave":"wav","audio/webm":"weba","image/avif":"avif","image/bmp":"bmp","image/gif":"gif","image/heic":"heic","image/heif":"heif","image/jpeg":"jpeg","image/jpg":"jpg","image/png":"png","image/svg+xml":"svg","image/tiff":"tif","image/webp":"webp","image/wmf":"wmf","video/mp4":"mp4","video/mpeg":"mpeg","video/ogg":"ogv","video/quicktime":"mov","video/webm":"webm","application/pdf":"pdf","application/msword":"doc","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","application/vnd.ms-excel":"xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","application/vnd.ms-powerpoint":"ppt","application/vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","application/zip":"zip","application/x-rar-compressed":"rar","application/x-7z-compressed":"7z","application/json":"json","application/xml":"xml","application/javascript":"js","application/x-tar":"tar","application/gzip":"gz","application/vnd.android.package-archive":"apk","application/x-executable":"exe","application/vnd.apple.installer+xml":"mpkg","application/rtf":"rtf","application/x-sh":"sh","application/x-font-ttf":"ttf","application/vnd.oasis.opendocument.text":"odt","application/vnd.oasis.opendocument.spreadsheet":"ods","application/vnd.oasis.opendocument.presentation":"odp"},eH=x.discriminatedUnion("type",[x.object({type:x.literal("Header"),title:x.string,iconUrl:x.string.layout({label:"Icon URL",placeholder:"https://example.com/icon.png"})}),x.object({type:x.literal("Text"),value:x.string.layout({inputType:"textarea"})}),x.object({type:x.literal("Labelled Text"),label:x.string.layout({label:"Label"}),value:x.string.layout({label:"Value",inputType:"textarea"}),iconUrl:x.string.layout({label:"Icon URL",placeholder:"https://example.com/icon.png"})}),x.object({type:x.literal("Image"),imageUrl:x.string.layout({placeholder:"https://example.com/image.jpg"}),fitImage:x.boolean.layout({label:"Fit Image"}),width:x.number.layout({label:"Width (px)",direction:"row"}),height:x.number.layout({label:"Height (px)",direction:"row"})}),x.object({type:x.literal("Image gallery"),imageUrls:x.array(x.string).layout({label:"URLs",itemLabel:"Image URL"})}),x.object({type:x.literal("YouTube"),link:x.string.layout({placeholder:"i.e. https://www.youtube.com/watch?v=dQw4w9WgXcQ"})}),x.object({type:x.literal("Link"),url:x.string.layout({placeholder:"https://example.com"}),title:x.string.layout({label:"Title"}),description:x.string.layout({label:"Description"}),imageUrl:x.string.layout({label:"Image URL"}),imagePlacement:x.enum(["left","right","top"]).layout({label:"Image Placement",defaultValue:"left"})}),x.object({type:x.literal("Buttons"),buttons:x.array(x.object({clientAction:x.discriminatedUnion("type",[x.object({type:x.literal("Open Link"),url:x.string.layout({placeholder:"https://example.com"})}),x.object({type:x.literal("Open Webview"),url:x.string.layout({placeholder:"https://example.com"})})]),label:x.string.layout({label:"Label"}),iconUrl:x.string.layout({label:"Icon URL"})}))}),x.object({type:x.literal("Attachment"),url:x.string.layout({placeholder:"https://example.com"})}),x.object({type:x.literal("Event"),title:x.string.layout({label:"Title"}),description:x.string.layout({label:"Description",inputType:"textarea"}),start:x.string.layout({label:"Start Date",placeholder:"2025-01-01T00:00:00Z"}),end:x.string.layout({label:"End Date",placeholder:"2025-01-01T08:00:00Z"}),allDay:x.boolean.layout({label:"All‑day Event"})}),x.object({type:x.literal("Horizontal Bar Chart"),total:x.number.layout({label:"Global Total"}),data:x.array(x.object({name:x.string.layout({label:"Name"}),value:x.number.layout({label:"Total"}),label:x.string.layout({label:"Total label"})})).layout({itemLabel:"bar"})})]),eK={name:"Send Feed Event",auth:eS,options:x.object({categoryId:x.string.layout({label:"Category ID"}),ribbonColor:x.string.layout({label:"Ribbon Color",placeholder:"#FF0000",accordion:"Card Content"}),sections:x.array(eH).layout({accordion:"Card Content",isOrdered:!0}),allowComments:x.boolean.layout({label:"Allow Comments",accordion:"Options"}),allowReactions:x.boolean.layout({label:"Allow Reactions",accordion:"Options"}),userIds:x.array(x.string).layout({label:"User IDs",accordion:"Send to"}),groupIds:x.array(x.string).layout({label:"Group IDs",accordion:"Send to"}),pushNotification:x.object({title:x.string.layout({label:"Title",accordion:"Push Notification"}),text:x.string.layout({label:"Text",accordion:"Push Notification"})}).optional(),responseMapping:x.saveResponseArray(["Event ID"]).optional().layout({accordion:"Save in variables"})}),getSetVariableIds:e=>{var t,n;return null!=(n=null==(t=e.responseMapping)?void 0:t.map(e=>e.variableId).filter(o.O9))?n:[]},run:{server:async e=>{var t,n,a;let{credentials:r,options:i,variables:l,logs:s}=e;if(!(null==r?void 0:r.apiKey))return s.add("No API key provided.");if(!i.userIds&&!i.groupIds)return s.add("You must supply at least one user ID or group ID.");if(!i.sections||0===i.sections.length)return s.add("No card content provided.");let d=(await Promise.all(i.sections.map(async e=>{var t,n,a,r,i,l;switch(e.type){case"Header":return{type:"header",title:e.title,icon_url:e.iconUrl};case"Text":return{type:"text",value:e.value,is_markdown:!0};case"Labelled Text":return{type:"labelled_text",label:e.label,value:e.value,icon_url:e.iconUrl,is_markdown:!0};case"Image":return{type:"image",image_url:e.imageUrl,fit_image:e.fitImage,width:e.width,height:e.height};case"Image gallery":return{type:"gallery",data:null==(t=e.imageUrls)?void 0:t.map(e=>({type:"gallery_image",image_url:e}))};case"YouTube":if(!e.link)return;let{id:d}=ez(e.link);if(!d)return s.add("Invalid YouTube URL.");return{type:"youtube",video_id:d};case"Link":return{type:"link",title:e.title,url:e.url,subtitle:e.description,image_url:e.imageUrl,image_placement:e.imagePlacement};case"Buttons":return{type:"buttons",data:null==(n=e.buttons)?void 0:n.map(e=>{if(!e.clientAction.url)return;let t=btoa(e.clientAction.url),n="";return"Open Link"===e.clientAction.type&&(n="blink:link?url=".concat(t,"&action=open")),"Open Webview"===e.clientAction.type&&(n="blink:webview?url=".concat(t,"&action=open")),{label:e.label,client_action:n,icon_url:e.iconUrl}}).filter(o.O9)};case"Attachment":{if(!e.url)return;let{headers:t}=await L.Ay.head(e.url),n=eM[null!=(r=t.get("content-type"))?r:""],o=null!=(i=null==(a=t.get("content-disposition"))?void 0:a.split("filename=")[1])?i:e.url.split("/").pop(),l=Number(t.get("content-length"));if(!o||!n||!l||isNaN(l))return s.add("Could not get proper file attachement metadata.");return{type:"attachment",file_name:o,file_ext:n,file_size:l,download_url:e.url,open_url:e.url}}case"Event":return{type:"event",title:e.title,start:e.start,end:e.end,subtitle:e.description,all_day:e.allDay};case"Horizontal Bar Chart":return{type:"horizontal_bar_chart",total_raw_value:e.total,data:null==(l=e.data)?void 0:l.map(e=>({name:e.name,raw_value:e.value,display_value:e.label}))}}}))).filter(o.O9),u={body:{ribbon_color:i.ribbonColor,sections:d},category:i.categoryId,user_ids:i.userIds,group_ids:i.groupIds,notification_title:null==(t=i.pushNotification)?void 0:t.title,notification_text:null==(n=i.pushNotification)?void 0:n.text,allow_comments:i.allowComments,allow_reactions:i.allowReactions};try{let{data:e}=await L.Ay.post("".concat(eN,"/feed/events"),{headers:{Authorization:"Bearer ".concat(r.apiKey),"Content-Type":"application/json"},json:u}).json();null==(a=i.responseMapping)||a.filter(e=>(0,o.O9)(e.variableId)).forEach(t=>l.set([{id:t.variableId,value:e.event_id}]))}catch(e){e instanceof U.H?s.add(await k({err:e,context:"While sending Blink feed event"})):e instanceof SyntaxError?s.add("Invalid JSON provided for the body."):(console.error(e),s.add("Unexpected error. Check function logs for details."))}}}},eG="https://app.cal.com",eW=x.object({baseUrl:x.string.layout({label:"Base origin",placeholder:"https://cal.com",defaultValue:eG,accordion:"Customize host"})}),eF={name:"Book event",baseOptions:eW,options:x.object({link:x.string.layout({label:"Event link",placeholder:"https://cal.com/..."}),layout:x.enum(["Month","Weekly","Columns"]).layout({label:"Layout:",defaultValue:"Month",direction:"row"}),name:x.string.layout({accordion:"Prefill information",label:"Name",placeholder:"John Doe"}),email:x.string.layout({accordion:"Prefill information",label:"Email",placeholder:"johndoe@gmail.com"}),additionalNotes:x.string.layout({accordion:"Prefill information",label:"Additional notes"}),phone:x.string.layout({accordion:"Prefill information",label:"Attendee Phone Number",moreInfoTooltip:"Will be used as meeting location",placeholder:"+919999999999"}),anyPrefilledInformations:x.array(x.object({questionId:x.string.layout({label:"Question Identifier"}),value:x.string.layout({label:"Value"})})).layout({accordion:"Prefill information"}),saveBookedDateInVariableId:x.string.layout({label:"Save booked date",inputType:"variableDropdown"})}),getSetVariableIds:e=>{let{saveBookedDateInVariableId:t}=e;return t?[t]:[]},run:{web:{displayEmbedBubble:{parseUrl:e=>{let{options:t}=e;return t.link},waitForEvent:{getSaveVariableId:e=>{let{saveBookedDateInVariableId:t}=e;return t},parseFunction:()=>({args:{},content:'{\n                const callback = (e) => {\n                  continueFlow(e.detail.data.date)\n                  Cal("off", {\n                    action: "bookingSuccessful",\n                    callback\n                  })\n                }\n\n                Cal("on", {\n                  action: "bookingSuccessful",\n                  callback\n                })\n              }'})},parseInitFunction:e=>{var t,n,a,r,o,i,l,s;let{options:d}=e;if(!d.link)throw Error("Missing link");let u=null!=(a=d.baseUrl)?a:eG,c=(null==(t=d.link)?void 0:t.startsWith("http"))?d.link.replace(/http.+:\/\/[^/]+\//,""):d.link;return{args:{baseUrl:u,link:null!=c?c:"",name:null!=(r=d.name)?r:null,email:null!=(o=d.email)?o:null,layout:eq(d.layout),phone:null!=(i=d.phone)?i:null,additionalNotes:null!=(l=d.additionalNotes)?l:null,otherPrefilledInformations:null!=(s=null==(n=d.anyPrefilledInformations)?void 0:n.reduce((e,t)=>(t.questionId&&t.value&&(e[t.questionId]=t.value),e),{}))?s:null},content:'(function (C, A, L) {\n                let p = function (a, ar) {\n                  a.q.push(ar);\n                };\n                let d = C.document;\n                C.Cal =\n                  C.Cal ||\n                  function () {\n                    let cal = C.Cal;\n                    let ar = arguments;\n                    if (!cal.loaded) {\n                      cal.ns = {};\n                      cal.q = cal.q || [];\n                      d.head.appendChild(d.createElement("script")).src = A;\n                      cal.loaded = true;\n                    }\n                    if (ar[0] === L) {\n                      const api = function () {\n                        p(api, arguments);\n                      };\n                      const namespace = ar[1];\n                      api.q = api.q || [];\n                      typeof namespace === "string"\n                        ? (cal.ns[namespace] = api) && p(api, ar)\n                        : p(cal, ar);\n                      return;\n                    }\n                    p(cal, ar);\n                  };\n              })(window, baseUrl + "/embed/embed.js", "init");\n\n              Cal("init", { origin: baseUrl });\n\n              const location = phone ? JSON.stringify({\n                value: "phone",\n                optionValue: phone\n              }) : undefined\n\n              Cal("inline", {\n                elementOrSelector: typebotElement,\n                calLink: link,\n                layout,\n                config: {\n                  name: name ?? undefined,\n                  email: email ?? undefined,\n                  notes: additionalNotes ?? undefined,\n                  location,\n                  ...otherPrefilledInformations,\n                }\n              });\n\n              Cal("ui", {"hideEventTypeDetails":false,layout});'}}}}}},eq=e=>{switch(e){case"Weekly":return"week_view";case"Columns":return"column_view";default:return"month_view"}},eX={type:"encryptedCredentials",name:"ChatNode account",schema:x.object({apiKey:x.string.layout({label:"API key",isRequired:!0,helperText:"You can generate an API key [here](https://go.chatnode.ai/typebot).",inputType:"password",withVariableButton:!1,isDebounceDisabled:!0})})},eY={auth:eX,name:"Send Message",turnableInto:void 0,options:x.object({botId:x.string.layout({label:"Bot ID",placeholder:"68c052c5c3680f63",moreInfoTooltip:"The bot_id you want to ask question to. You can find it at the end of your ChatBot URl in your dashboard"}),threadId:x.string.layout({label:"Thread ID",moreInfoTooltip:"Used to remember the conversation with the user. If empty, a new thread is created."}),message:x.string.layout({label:"Message",placeholder:"Hi, what can I do with ChatNode",inputType:"textarea"}),responseMapping:x.saveResponseArray(["Message","Thread ID"]).layout({accordion:"Save response"})}),getSetVariableIds:e=>{var t;let{responseMapping:n}=e;return null!=(t=null==n?void 0:n.map(e=>e.variableId).filter(o.O9))?t:[]},run:{server:async e=>{let{credentials:{apiKey:t},options:{botId:n,message:a,responseMapping:r,threadId:i},variables:l,logs:s}=e;try{let e=await L.Ay.post("https://api.public.chatnode.ai/v1/"+n,{headers:{Authorization:"Bearer ".concat(t)},json:{message:a,chat_session_id:(0,o.Im)(i)?void 0:i},timeout:!1}).json();null==r||r.forEach(t=>{var n;if(!t.variableId)return;let a=null!=(n=t.item)?n:"Message";"Message"===a&&l.set([{id:t.variableId,value:e.message}]),"Thread ID"===a&&l.set([{id:t.variableId,value:e.chat_session_id}])})}catch(e){if(e instanceof U.H)return s.add(await k({err:e,context:"While sending message to ChatNode"}))}}}};var eJ=n(47694);let e$=e=>{var t,n;return null!=(n=null==(t=e.responseMapping)?void 0:t.map(e=>e.variableId).filter(o.O9))?n:[]},eQ={content:x.string.layout({inputType:"textarea",placeholder:"Content"})},eZ=x.object({role:x.literal("system")}).extend(eQ),e0=x.object({role:x.literal("user")}).extend(eQ),e1=x.object({role:x.literal("assistant")}).extend(eQ),e2=x.object({role:x.literal("Dialogue"),dialogueVariableId:x.string.layout({inputType:"variableDropdown",placeholder:"Dialogue variable"}),startsBy:x.enum(["user","assistant"]).layout({label:"starts by",direction:"row",defaultValue:"user"})}),e5=e=>{let{models:t}=e;return x.object({model:x.string.layout({placeholder:"Select a model",label:"Model",allowCustomValue:!0,helperText:t.helperText,autoCompleteItems:"static"===t.type?t.models:void 0,fetcher:"fetcher"===t.type?t.id:void 0}),messages:x.array(x.discriminatedUnion("role",[eZ,e0,e1,e2])).layout({accordion:"Messages",itemLabel:"message",isOrdered:!0}),tools:el,temperature:x.number.layout({accordion:"Advanced settings",label:"Temperature",direction:"row",defaultValue:1}),responseMapping:x.saveResponseArray(j).layout({accordion:"Save response"})})},e3={type:"encryptedCredentials",name:"DeepSeek account",schema:x.object({apiKey:x.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can generate an API key [here](https://platform.deepseek.com/api_keys).",placeholder:"sk-...",withVariableButton:!1,isDebounceDisabled:!0}),baseUrl:x.string.layout({label:"Base URL",defaultValue:"https://api.deepseek.com/v1",withVariableButton:!1,isDebounceDisabled:!0})})},e4={name:"Create chat completion",auth:e3,options:e5({models:{type:"static",models:["deepseek-chat","deepseek-reasoner"]}}),getSetVariableIds:e$,turnableInto:[{blockId:"open-router"},{blockId:"together-ai"},{blockId:"groq",transform:e=>({...e,model:void 0})},{blockId:"perplexity",transform:e=>({...e,model:void 0})},{blockId:"anthropic",transform:e=>({...e,model:void 0,action:"Create Chat Message"})},{blockId:"openai",transform:e=>({...e,model:void 0})},{blockId:"mistral",transform:e=>({...e,model:void 0})}],run:{server:async e=>{var t;let{credentials:{apiKey:n,baseUrl:a},options:r,variables:o,logs:i,sessionStore:l}=e;if(!n)return i.add("No API key provided");let s=null==(t=r.model)?void 0:t.trim();return s?r.messages?void await en({model:(0,eJ.P)({apiKey:n,baseURL:null!=a?a:void 0})(s),variables:o,messages:r.messages,tools:r.tools,isVisionEnabled:!1,temperature:r.temperature,logs:i,responseMapping:r.responseMapping,sessionStore:l}):i.add("No messages provided"):i.add("No model provided")},stream:{getStreamVariableId:C,run:async e=>{var t;let{credentials:{apiKey:n,baseUrl:a},options:r,variables:o,sessionStore:i}=e;if(!n)return{error:{description:"No API key provided"}};let l=null==(t=r.model)?void 0:t.trim();return l?r.messages?ea({model:(0,eJ.P)({apiKey:n,baseURL:null!=a?a:void 0})(l),variables:o,messages:r.messages,isVisionEnabled:!1,responseMapping:r.responseMapping,tools:r.tools,temperature:r.temperature,sessionStore:i}):{error:{description:"No messages provided"}}:{error:{description:"No model provided"}}}}}};var e9=n(14576),e6=n(20248);let e7=(e,t)=>(0,e6.isURL)(e,{protocols:["https","http"],require_protocol:!0,...t}),e8="https://api.dify.ai",te="dify-chat",tt="system@typebot.io",tn=["Answer","Total Tokens"],ta={type:"encryptedCredentials",name:"Dify.AI account",schema:x.object({apiKey:x.string.layout({label:"App API key",inputType:"password",placeholder:"app-...",withVariableButton:!1,isDebounceDisabled:!0}),knowledgeApiKey:x.string.layout({label:"Knowledge API key",inputType:"password",placeholder:"dataset-...",withVariableButton:!1}),apiEndpoint:x.string.layout({label:"API Endpoint",isRequired:!0,withVariableButton:!1,defaultValue:e8,accordion:"Advanced settings"}).refine(e=>!e||e7(e)).transform(e=>e?new URL(e).origin:e)})},tr=e=>{let t={};return null==e||e.forEach(e=>{let{key:n,value:a}=e;n&&(t[n]=a)}),t},to={Answer:"Message content","Total Tokens":"Total tokens","Conversation ID":"Conversation ID"},ti=(e,t)=>{var n;return(null==t?void 0:t.trim())?{success:!0,apiKey:t.trim(),apiEndpoint:null!=(n=null==e?void 0:e.trim())?n:e8}:{success:!1,error:"No API key provided"}},tl={name:"Create Chat Message",auth:ta,options:x.object({query:x.string.layout({label:"Query",placeholder:"User input/question content",inputType:"textarea",isRequired:!0}),conversationVariableId:x.string.layout({label:"Conversation ID",moreInfoTooltip:"Used to remember the conversation with the user. If empty, a new conversation ID is created.",inputType:"variableDropdown"}),user:x.string.layout({label:"User",moreInfoTooltip:"The user identifier, defined by the developer, must ensure uniqueness within the app.",isHidden:!0}),inputs:x.array(x.object({key:x.string.layout({label:"Key"}),value:x.string.layout({label:"Value"})})).layout({accordion:"Inputs"}),responseMapping:x.saveResponseArray([...tn,...j],{item:{hiddenItems:tn}}).layout({accordion:"Save response"}).transform(e=>{if(e)return e.map(e=>({...e,item:e.item?to[e.item]||e.item:void 0})).filter(e=>!e.item||[...j,"Conversation ID"].includes(e.item))}).openapi({effectType:"input"})}),getSetVariableIds:e=>{var t;let{responseMapping:n}=e;return null!=(t=null==n?void 0:n.map(e=>e.variableId).filter(o.O9))?t:[]},run:{server:async e=>{var t,n,a;let{credentials:{apiKey:r,apiEndpoint:o},options:i,variables:l,logs:s,sessionStore:d}=e,u=ti(o,r);if(!u.success)return s.add(u.error);let c=(0,e9.g)({baseURL:"".concat(u.apiEndpoint,"/v1")})(te,{apiKey:u.apiKey,inputs:tr(i.inputs),responseMode:"blocking"}),p=await en({model:c,variables:l,responseMapping:i.responseMapping,logs:s,sessionStore:d,tools:void 0,temperature:void 0,isVisionEnabled:!1,headers:{"user-id":null!=(a=i.user)?a:tt,"chat-id":i.conversationVariableId?null==(t=l.get(i.conversationVariableId))?void 0:t.toString():void 0},messages:[{role:"user",content:i.query}]});if(!p)return s.add({status:"error",description:"No response from Dify"});i.conversationVariableId&&l.set([{id:i.conversationVariableId,value:null==(n=p.providerMetadata)?void 0:n.difyWorkflowData.conversationId}])},stream:{getStreamVariableId:e=>{var t;let{responseMapping:n}=e;return null==n||null==(t=n.find(e=>"Message content"===e.item))?void 0:t.variableId},run:async e=>{var t,n;let{credentials:{apiKey:a,apiEndpoint:r},options:o,variables:i,sessionStore:l}=e,s=ti(r,a);return s.success?ea({model:(0,e9.g)({baseURL:"".concat(s.apiEndpoint,"/v1")})(te,{apiKey:s.apiKey,inputs:tr(o.inputs),responseMode:"streaming"}),variables:i,responseMapping:o.responseMapping,sessionStore:l,isVisionEnabled:!1,tools:void 0,temperature:void 0,headers:{"user-id":null!=(n=o.user)?n:tt,"chat-id":o.conversationVariableId?null==(t=i.get(o.conversationVariableId))?void 0:t.toString():void 0},messages:[{role:"user",content:o.query}],onFinish:e=>{var t;o.conversationVariableId&&i.set([{id:o.conversationVariableId,value:null==(t=e.providerMetadata)?void 0:t.difyWorkflowData.conversationId}])}}):{error:{description:s.error}}}}}},ts={name:"Query Knowledge Base",auth:ta,fetchers:[{id:"fetchKnowledgeBases",dependencies:[],fetch:async e=>{let{credentials:{knowledgeApiKey:t,apiEndpoint:n}={}}=e;return t?{data:(await L.Ay.get("".concat(null!=n?n:e8,"/v1/datasets"),{headers:{Authorization:"Bearer ".concat(t)},searchParams:{limit:100}}).json()).data.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).map(e=>{let{id:t,name:n}=e;return{label:n,value:t}})}:{data:[]}}}],options:x.object({datasetId:x.string.layout({label:"Knowledge Base ID",isRequired:!0,fetcher:"fetchKnowledgeBases"}),query:x.string.layout({label:"Query",isRequired:!0,inputType:"textarea"}),responseMapping:x.saveResponseArray(["Retrieved chunks"]).layout({accordion:"Save response"})}),getSetVariableIds:e=>{var t,n;return null!=(n=null==(t=e.responseMapping)?void 0:t.map(e=>e.variableId).filter(o.O9))?n:[]},run:{server:async e=>{let{credentials:{knowledgeApiKey:t,apiEndpoint:n},options:a,variables:r,logs:o}=e;if(!a.datasetId)return o.add("Knowledge Base ID is empty");if(!a.query)return o.add("Query is empty");if(!a.responseMapping)return o.add("Missing result variable");try{var i;let e=await L.Ay.post("".concat(null!=n?n:e8,"/v1/datasets/").concat(a.datasetId,"/retrieve"),{headers:{Authorization:"Bearer ".concat(t)},json:{query:a.query}}).json();null==(i=a.responseMapping)||i.forEach(t=>{t.variableId&&(!t.item||"Retrieved chunks"===t.item)&&r.set([{id:t.variableId,value:e.records.map(e=>e.segment.content)}])})}catch(e){return o.add(await k({err:e,context:"While querying Dify knowledge base"}))}}}};var td=n(26739),tu=n(57608);let tc=()=>{if(!s._.S3_ENDPOINT||!s._.S3_ACCESS_KEY||!s._.S3_SECRET_KEY)throw Error("S3 not properly configured. Missing one of those variables: S3_ENDPOINT, S3_ACCESS_KEY, S3_SECRET_KEY");return new tu.Client({endPoint:s._.S3_ENDPOINT,port:s._.S3_PORT,useSSL:s._.S3_SSL,accessKey:s._.S3_ACCESS_KEY,secretKey:s._.S3_SECRET_KEY,region:s._.S3_REGION})},tp=()=>s._.S3_PUBLIC_CUSTOM_DOMAIN?s._.S3_PUBLIC_CUSTOM_DOMAIN:"http".concat(s._.S3_SSL?"s":"","://").concat(s._.S3_ENDPOINT).concat(s._.S3_PORT?":".concat(s._.S3_PORT):"","/").concat(s._.S3_BUCKET),tm=async e=>{let{key:t,file:n,mimeType:a}=e,r=tc();return await r.putObject(s._.S3_BUCKET,"public/"+t,n,{"Content-Type":a,"Cache-Control":"public, max-age=86400"}),"".concat(tp(),"/public/").concat(t)},tb={type:"encryptedCredentials",name:"ElevenLabs account",schema:x.object({apiKey:x.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can generate an API key in your ElevenLabs dashboard in the Profile menu.",isDebounceDisabled:!0,withVariableButton:!1})})},tg="https://api.elevenlabs.io";var th=n(51642).Buffer;let ty={name:"Convert text to speech",auth:tb,options:x.object({text:x.string.layout({label:"Text",inputType:"textarea",placeholder:"Enter the text to convert to speech"}),voiceId:x.string.layout({fetcher:"fetchVoices",label:"Voice",placeholder:"Select a voice"}),modelId:x.string.layout({fetcher:"fetchModels",label:"Model",placeholder:"Select a model"}),saveUrlInVariableId:x.string.layout({label:"Save audio URL in variable",placeholder:"Select a variable",inputType:"variableDropdown"})}),getSetVariableIds:e=>{let{saveUrlInVariableId:t}=e;return t?[t]:[]},fetchers:[{id:"fetchVoices",fetch:async e=>{let{credentials:t}=e;if(!(null==t?void 0:t.apiKey))return{data:[]};try{return{data:(await L.Ay.get(tg+"/v1/voices",{headers:{"xi-api-key":t.apiKey}}).json()).voices.map(e=>({value:e.voice_id,label:e.name}))}}catch(e){return{error:await k({err:e})}}},dependencies:[]},{id:"fetchModels",fetch:async e=>{let{credentials:t}=e;if(!(null==t?void 0:t.apiKey))return{data:[]};try{return{data:(await L.Ay.get(tg+"/v1/models",{headers:{"xi-api-key":t.apiKey}}).json()).filter(e=>e.can_do_text_to_speech).map(e=>({value:e.model_id,label:e.name}))}}catch(e){return{error:await k({err:e})}}},dependencies:[]}],run:{server:async e=>{let{credentials:t,options:n,variables:a,logs:r}=e;if(!n.voiceId)return r.add("Voice ID is missing");if(!n.text)return r.add("Text is missing");if(!n.saveUrlInVariableId)return r.add("Save variable is missing");try{let e=await L.Ay.post(tg+"/v1/text-to-speech/"+n.voiceId,{headers:{Accept:"audio/mpeg","xi-api-key":t.apiKey},json:{model_id:n.modelId,text:n.text},timeout:!1}).arrayBuffer(),r=await tm({file:th.from(e),key:"tmp/elevenlabs/audio/".concat((0,td.sX)()+(0,td.sX)(),".mp3"),mimeType:"audio/mpeg"});a.set([{id:n.saveUrlInVariableId,value:r}])}catch(e){return r.add(await k({err:e,context:"While converting text to ElevenLabs speech"}))}}}},tf={type:"oauth",name:"Gmail account",authUrl:"https://accounts.google.com/o/oauth2/v2/auth",tokenUrl:"https://oauth2.googleapis.com/token",scopes:["https://www.googleapis.com/auth/gmail.modify","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/userinfo.email"],defaultClientEnvKeys:{id:"GMAIL_CLIENT_ID",secret:"GMAIL_CLIENT_SECRET"},extraAuthParams:{access_type:"offline",prompt:"consent"}};var tv=n(73848),tw=n.n(tv),tI=n(51642).Buffer;let tE=async e=>{let{to:t,from:n,subject:a,body:r,attachmentUrls:o}=e,i=o&&o.length>0?await Promise.all(o.map(async(e,t)=>{var n,a,r;let o=await L.Ay.get(e);return{filename:null!=(a=null==(n=e.split("/").pop())?void 0:n.split("?")[0])?a:"attachment-".concat(t),content:tI.from(await o.arrayBuffer()),contentType:null!=(r=o.headers.get("content-type"))?r:"application/octet-stream"}})):[],l=new(tw())({to:t,from:n,subject:a,text:r,attachments:i});return new Promise((e,t)=>l.compile().build((n,a)=>{n?t(n):e(a)}))};var tx=n(92490),t_=n(57633);let tT=e=>{let t=new t_.OAuth2Client({credentials:{access_token:e}});return(0,tx.gmail)({version:"v1",auth:t})},tC=async e=>await L.Ay.get("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:"Bearer ".concat(e)}}).json(),tS=async(e,t)=>{let{accessToken:n}=t;if(e){if(e.includes("@"))return e;let{email:t}=await tC(n);return"".concat(e," <").concat(t,">")}let{name:a,email:r}=await tC(n);return"".concat(a," <").concat(r,">")},tk={auth:tf,name:"Send email",options:x.object({to:x.string.layout({label:"To"}),subject:x.string.layout({label:"Subject"}),body:x.string.layout({label:"Body",inputType:"textarea"}),attachments:x.string.layout({inputType:"variableDropdown",label:"Attachments",moreInfoTooltip:"File URLs to attach. Note: Gmail has a 25MB total attachment limit."}),label:x.string.layout({label:"Label",fetcher:"fetchLabels",withVariableButton:!1,accordion:"Advanced configuration"}),from:x.string.layout({label:"From",accordion:"Advanced configuration",placeholder:"John Doe <john.doe@gmail.com>"}),threadId:x.string.layout({label:"Thread ID",accordion:"Advanced configuration",moreInfoTooltip:"If provided, the email will be sent as a reply of that specified thread."}),replyTo:x.string.layout({label:"Reply to",accordion:"Advanced configuration",placeholder:"john.doe@gmail.com",moreInfoTooltip:"If provided, the reply to this email will be set to the provided email address",isHidden:e=>{let{threadId:t}=e;return(0,o.hj)(t)}}),responseMapping:x.saveResponseArray(["Thread ID"]).layout({accordion:"Save response"})}),fetchers:[{id:"fetchLabels",dependencies:[],fetch:async e=>{let{credentials:t}=e;if(!t)return{data:[]};try{var n,a;let e=tT(t.accessToken);return{data:null!=(a=null==(n=(await e.users.labels.list({userId:"me"})).data.labels)?void 0:n.filter(e=>"user"===e.type).map(e=>{var t,n;return{value:null!=(t=e.id)?t:"",label:null!=(n=e.name)?n:""}}))?a:[]}}catch(e){return{error:await k({err:e,context:"While fetching Gmail labels"})}}}}],getSetVariableIds:e=>{var t,n;return null!=(n=null==(t=e.responseMapping)?void 0:t.map(e=>e.variableId).filter(o.O9))?n:[]},run:{server:async e=>{let{credentials:t,options:n,logs:a,variables:r}=e;if(!t.accessToken)return void a.add("No access token available");let i=tT(t.accessToken),l=n.attachments?r.get(n.attachments):void 0,s=Array.isArray(l)?l:l?[l]:void 0;try{var d;let e=await tS(n.from,{accessToken:t.accessToken}),l=(await tE({to:n.to,from:e,subject:n.subject,body:n.body,attachmentUrls:null==s?void 0:s.filter(o.O9)})).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),u=await i.users.messages.send({userId:"me",requestBody:{threadId:n.threadId,raw:l}});if(n.label&&u.data.id)try{await i.users.messages.modify({userId:"me",id:u.data.id,requestBody:{addLabelIds:[n.label]}})}catch(e){console.error(e),a.add("Failed to apply label: ".concat(e))}null==(d=n.responseMapping)||d.forEach(e=>{var t;if(!e.variableId)return;let n=null!=(t=e.item)?t:"Message ID";"Message ID"===n&&r.set([{id:e.variableId,value:u.data.id}]),"Thread ID"===n&&r.set([{id:e.variableId,value:u.data.threadId}])})}catch(t){let e=await k({err:t,context:"While sending email with Gmail"});a.add(e)}}}};var tN=n(2447);let tA="https://api.groq.com/openai/v1",tP={type:"encryptedCredentials",name:"Groq account",schema:x.object({apiKey:x.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can generate an API key [here](https://console.groq.com/keys).",withVariableButton:!1,isDebounceDisabled:!0}),baseUrl:x.string.layout({label:"Base URL",defaultValue:tA,withVariableButton:!1,isDebounceDisabled:!0})})},tR={name:"Create chat completion",auth:tP,options:e5({models:{type:"fetcher",id:"fetchModels"}}),fetchers:[{id:"fetchModels",fetch:async e=>{let{credentials:t}=e;if(!(null==t?void 0:t.apiKey))return{data:[]};try{return{data:(await L.Ay.get("".concat(tA,"/models"),{headers:{authorization:"Bearer ".concat(t.apiKey)}}).json()).data.sort((e,t)=>t.created-e.created).map(e=>e.id)}}catch(e){return{error:await k({err:e})}}},dependencies:[]}],turnableInto:[{blockId:"openai"},{blockId:"open-router"},{blockId:"mistral"},{blockId:"anthropic",transform:e=>({...e,action:"Create Chat Message"})},{blockId:"perplexity"},{blockId:"together-ai"},{blockId:"deepseek"}],getSetVariableIds:e$,run:{server:async e=>{var t;let{credentials:{apiKey:n},options:a,variables:r,logs:o,sessionStore:i}=e;if(!n)return o.add("No API key provided");let l=null==(t=a.model)?void 0:t.trim();return l?a.messages?void await en({model:(0,tN.c)({apiKey:n})(l),variables:r,messages:a.messages,tools:a.tools,isVisionEnabled:!1,temperature:a.temperature,responseMapping:a.responseMapping,logs:o,sessionStore:i}):o.add("No messages provided"):o.add("No model provided")},stream:{getStreamVariableId:C,run:async e=>{var t;let{credentials:{apiKey:n},options:a,variables:r,sessionStore:o}=e;if(!n)return{error:{description:"No API key provided"}};let i=null==(t=a.model)?void 0:t.trim();return i?a.messages?ea({model:(0,tN.c)({apiKey:n})(i),variables:r,messages:a.messages,isVisionEnabled:!1,tools:a.tools,temperature:a.temperature,responseMapping:a.responseMapping,sessionStore:o}):{error:{description:"No messages provided"}}:{error:{description:"No model provided"}}}}}};var tj=n(90614);let tL={type:"encryptedCredentials",name:"Mistral account",schema:x.object({apiKey:x.string.layout({label:"API key",isRequired:!0,inputType:"password",withVariableButton:!1,helperText:"You can generate an API key [here](https://console.mistral.ai/api-keys).",isDebounceDisabled:!0})})},tU=["mistral-medium-latest","mistral-large-latest","pixtral-large-latest","mistral-small-latest","mistral-saba-latest","ministral-3b-latest","ministral-8b-latest"],tO={name:"Create chat completion",auth:tL,options:e5({models:{type:"static",models:tU}}),turnableInto:[{blockId:"openai",transform:e=>({...e,model:void 0})},{blockId:"groq",transform:e=>({...e,model:void 0})},{blockId:"together-ai"},{blockId:"open-router"},{blockId:"anthropic",transform:e=>({...e,model:void 0,action:"Create Chat Message"})},{blockId:"perplexity",transform:e=>({...e,model:void 0})},{blockId:"deepseek",transform:e=>({...e,model:void 0})}],getSetVariableIds:e=>{var t,n;return null!=(n=null==(t=e.responseMapping)?void 0:t.map(e=>e.variableId).filter(o.O9))?n:[]},run:{server:async e=>{var t;let{credentials:{apiKey:n},options:a,variables:r,logs:o,sessionStore:i}=e;if(!n)return o.add("No API key provided");let l=null==(t=a.model)?void 0:t.trim();return l?a.messages?void await en({model:(0,tj.T)({apiKey:n}).chat(l),variables:r,messages:a.messages,tools:a.tools,isVisionEnabled:!1,temperature:a.temperature,responseMapping:a.responseMapping,logs:o,sessionStore:i}):o.add("No messages provided"):o.add("No model provided")},stream:{getStreamVariableId:C,run:async e=>{var t;let{credentials:{apiKey:n},options:a,variables:r,sessionStore:o}=e;if(!n)return{error:{description:"No API key provided"}};let i=null==(t=a.model)?void 0:t.trim();return i?a.messages?ea({model:(0,tj.T)({apiKey:n}).chat(i),variables:r,messages:a.messages,isVisionEnabled:!1,tools:a.tools,temperature:a.temperature,responseMapping:a.responseMapping,sessionStore:o}):{error:{description:"No messages provided"}}:{error:{description:"No model provided"}}}}}},tV={name:"Generate variables",auth:tL,options:ex({models:{type:"static",models:tU}}),turnableInto:[{blockId:"openai"},{blockId:"anthropic",transform:e=>({...e,model:void 0})}],aiGenerate:{models:{type:"static",items:tU},getModel:e=>{let{credentials:t,model:n}=e;return(0,tj.T)({apiKey:t.apiKey})(n)}},getSetVariableIds:e=>{var t,n;return null!=(n=null==(t=e.variablesToExtract)?void 0:t.map(e=>e.variableId).filter(o.O9))?n:[]},run:{server:e=>{let{credentials:t,options:n,variables:a,logs:r}=e;return(null==t?void 0:t.apiKey)===void 0?r.add("No API key provided"):void 0===n.model?r.add("No model provided"):e_({model:(0,tj.T)({apiKey:t.apiKey})(n.model),variablesToExtract:n.variablesToExtract,prompt:n.prompt,variables:a,logs:r})}}},tD="https://app.nocodb.com",tB=["Equal to","Not equal","Contains","Greater than","Less than","Is set","Is empty","Starts with","Ends with"],tz={type:"encryptedCredentials",name:"NocoDB account",schema:x.object({baseUrl:x.string.layout({label:"Base URL",isRequired:!0,helperText:"Change it only if you are self-hosting NocoDB.",withVariableButton:!1,defaultValue:tD}).transform(e=>null==e?void 0:e.replace(/\/$/,"")),apiKey:x.string.layout({label:"API Token",isRequired:!0,helperText:"You can generate an API token [here](https://app.nocodb.com/#/account/tokens)",inputType:"password",withVariableButton:!1})})},tM=async e=>{let{baseUrl:t,apiKey:n,tableId:a,updates:r,recordIdsToUpdate:i}=e;for(let e of(await L.Ay.get("".concat(null!=t?t:tD,"/api/v2/meta/tables/").concat(a),{headers:{"xc-token":n}}).json()).columns.filter(e=>"LinkToAnotherRecord"===e.uidt).map(e=>{var t;return{id:e.id,value:tH(null==(t=r.find(t=>t.fieldName===e.title))?void 0:t.value)}}).filter(e=>(0,o.O9)(e.value)))for(let r of i)await L.Ay.post("".concat(null!=t?t:tD,"/api/v2/tables/").concat(a,"/links/").concat(e.id,"/records/").concat(r),{headers:{"xc-token":n},json:e.value.map(e=>({Id:e}))}).json()},tH=e=>{if(e){if(e.startsWith("[")&&e.endsWith("]"))try{return JSON.parse(e)}catch(t){console.error("Failed to parse JSON value:",e,t)}return[e]}},tK=e=>{let t={};return e.forEach(e=>{let{key:n,value:a}=e;n&&a&&(t[n]=a)}),t},tG={auth:tz,name:"Create Record",options:x.object({tableId:x.string.layout({label:"Table ID",isRequired:!0,helperText:"Identifier of the table to create records in."}),fields:x.array(x.object({key:x.string.layout({label:"Field",isRequired:!0}),value:x.string.layout({label:"Value",isRequired:!0})})).layout({itemLabel:"field"})}),run:{server:async e=>{let{credentials:{baseUrl:t,apiKey:n},options:{tableId:a,fields:r},logs:o}=e;try{if(!r||0===r.length)return;if(!n)return o.add("API key is required");if(!a)return o.add("Table ID is required");let e=await L.Ay.post("".concat(null!=t?t:tD,"/api/v2/tables/").concat(a,"/records"),{headers:{"xc-token":n},json:tK(r)}).json();await tM({baseUrl:t,apiKey:n,tableId:a,updates:r,recordIdsToUpdate:[e.Id]})}catch(e){o.add(await k({err:e,context:"While creating NocoDB record"}))}}}},tW=e=>{if(!e||!e.comparisons||0===e.comparisons.length)return;let t=e.comparisons.map(e=>{switch(e.operator){case"Not equal":return"(".concat(e.input,",ne,").concat(e.value,")");case"Contains":return"(".concat(e.input,",like,%").concat(e.value,"%)");case"Greater than":return"(".concat(e.input,",gt,").concat(e.value,")");case"Less than":return"(".concat(e.input,",lt,").concat(e.value,")");case"Is set":return"(".concat(e.input,",isnot,null)");case"Is empty":return"(".concat(e.input,",is,null)");case"Starts with":return"(".concat(e.input,",like,").concat(e.value,"%)");case"Ends with":return"(".concat(e.input,",like,%").concat(e.value,")");default:return"(".concat(e.input,",eq,").concat(e.value,")")}}).filter(Boolean).join("~"+("OR"===e.joiner?"or":"and"));if(!(0,o.Im)(t))return t},tF=e=>Object.entries(e).reduce((e,t)=>{let[n,a]=t;return null==a?e:{...e,[n]:a.toString()}},{}),tq={auth:tz,name:"Search Records",options:x.object({tableId:x.string.layout({label:"Table ID",moreInfoTooltip:"Can be found by clicking on the 3 dots next to the table name.",isRequired:!0}),viewId:x.string.layout({label:"View ID",moreInfoTooltip:"Can be found by clicking on the 3 dots next to the view name."}),returnType:x.enum(["All","First","Last","Random"]).layout({accordion:"Filter",defaultValue:"All"}),filter:x.filter({operators:tB,isJoinerHidden:e=>{let{filter:t}=e;return!(null==t?void 0:t.comparisons)||t.comparisons.length<2}}).layout({accordion:"Filter"}),responseMapping:x.array(x.object({fieldName:x.string.layout({label:"Enter a field name"}),variableId:x.string.layout({inputType:"variableDropdown"})})).layout({accordion:"Response Mapping"})}),getSetVariableIds:e=>{var t;let{responseMapping:n}=e;return null!=(t=null==n?void 0:n.map(e=>e.variableId).filter(o.O9))?t:[]},run:{server:async e=>{let{credentials:{baseUrl:t,apiKey:n},options:{tableId:a,responseMapping:r,filter:i,returnType:l,viewId:s},variables:d,logs:u}=e;if(!n)return u.add("API key is required");try{let e,c=await L.Ay.get("".concat(null!=t?t:tD,"/api/v2/tables/").concat(a,"/records"),{headers:{"xc-token":n},searchParams:tF({where:tW(i),viewId:s,limit:1e3})}).json();if(l&&"All"!==l){let t=c.pageInfo.totalRows;"First"===l?e=0:"Last"===l?e=t-1:"Random"===l&&(e=Math.floor(Math.random()*t))}let p=(0,o.O9)(e)&&c.list[e]?[c.list[e]]:c.list;if(0===p.length)return u.add({status:"info",description:"Couldn't find any rows matching the filter",details:JSON.stringify(i,null,2)});null==r||r.forEach(e=>{if(!e.fieldName||!e.variableId)return;if((0,o.pN)(p[0][e.fieldName]))return void u.add("Field ".concat(e.fieldName," does not exist in the table"));let t=p.map(t=>t[e.fieldName]);d.set([{id:e.variableId,value:1===t.length?t[0]:t}])})}catch(e){u.add(await k({err:e,context:"While searching NocoDB records"}))}}}},tX=(e,t)=>e.map(e=>{let n={Id:e};return t.forEach(e=>{let{fieldName:t,value:a}=e;t&&(n[t]=null!=a?a:null)}),n}),tY={auth:tz,name:"Update Existing Record",options:x.object({tableId:x.string.layout({label:"Table ID",isRequired:!0,moreInfoTooltip:"Can be found by clicking on the 3 dots next to the table name."}),viewId:x.string.layout({label:"View ID",moreInfoTooltip:"Can be found by clicking on the 3 dots next to the view name."}),filter:x.filter({operators:tB,isJoinerHidden:e=>{let{filter:t}=e;return!(null==t?void 0:t.comparisons)||t.comparisons.length<2}}).layout({accordion:"Select Records"}),updates:x.array(x.object({fieldName:x.string.layout({label:"Enter a field name"}),value:x.string.layout({placeholder:"Enter a value"})})).layout({accordion:"Updates"})}),run:{server:async e=>{let{credentials:{baseUrl:t,apiKey:n},options:{tableId:a,filter:r,viewId:o,updates:i},logs:l}=e;if(!n)return l.add("API key is required");if(!i)return l.add("At least one update is required");if(!a)return l.add("Table ID is required");if(!(null==r?void 0:r.comparisons)||0===r.comparisons.length)return l.add("At least one filter is required");try{let e=await L.Ay.get("".concat(null!=t?t:tD,"/api/v2/tables/").concat(a,"/records"),{headers:{"xc-token":n},searchParams:tF({where:tW(r),viewId:o,limit:1e3})}).json();await L.Ay.patch("".concat(null!=t?t:tD,"/api/v2/tables/").concat(a,"/records"),{headers:{"xc-token":n},json:tX(e.list.map(e=>e.Id),i)}),await tM({baseUrl:t,apiKey:n,tableId:a,updates:i,recordIdsToUpdate:e.list.map(e=>e.Id)})}catch(e){l.add(await k({err:e,context:"While updating NocoDB existing record"}))}}}},tJ={id:"nocodb",name:"NocoDB",tags:["database"],LightLogo:e=>(0,r.jsxs)("svg",{viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e,children:[(0,r.jsx)("rect",{width:"32",height:"32",rx:"4",fill:"url(#paint0_linear_1871_109536)"}),(0,r.jsx)("path",{d:"M8.3335 15.1562L12.0047 18.8297V24.6454H8.3335V15.1562ZM23.7533 7.34649V24.0464C23.7533 24.3894 23.4738 24.6665 23.1309 24.6665C22.9665 24.6665 22.8092 24.6031 22.6917 24.4857L8.3335 11.5367V7.8726C8.3335 7.52968 8.61066 7.25253 8.95359 7.25253H8.98648C9.1509 7.25253 9.3106 7.31831 9.42569 7.4334L20.0798 16.6783V7.34649H23.7533Z",fill:"white"}),(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"paint0_linear_1871_109536",x1:"15.9976",y1:"42.7731",x2:"15.9976",y2:"-8.9707",gradientUnits:"userSpaceOnUse",children:[(0,r.jsx)("stop",{stopColor:"#4351E8"}),(0,r.jsx)("stop",{offset:"1",stopColor:"#2A1EA5"})]})})]}),auth:tz,actions:[tq,tG,tY],docsUrl:"https://docs.typebot.io/editor/blocks/integrations/nocodb",onboarding:{youtubeId:"ViKETDQ8Sfg",deployedAt:new Date("2023-06-20")}};var t$=n(96224);let tQ={type:"encryptedCredentials",name:"OpenRouter account",schema:x.object({apiKey:x.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can generate an API key [here](https://openrouter.ai/keys).",isDebounceDisabled:!0})})},tZ={baseUrl:"https://openrouter.ai/api/v1"},t0={name:"Create chat completion",auth:tQ,turnableInto:[{blockId:"openai"},{blockId:"groq"},{blockId:"together-ai"},{blockId:"mistral"},{blockId:"perplexity"},{blockId:"anthropic",transform:e=>({...e,action:"Create Chat Message"})},{blockId:"deepseek",transform:e=>({...e,model:void 0})}],options:e5({models:{type:"fetcher",id:"fetchModels"}}),getSetVariableIds:e$,fetchers:[{id:"fetchModels",dependencies:[],fetch:async()=>{try{return{data:(await L.Ay.get(tZ.baseUrl+"/models").json()).data.map(e=>({value:e.id,label:e.name}))}}catch(e){return{error:await k({err:e,context:"Fetching models"})}}}}],run:{server:async e=>{var t;let{credentials:{apiKey:n},options:a,variables:r,logs:o,sessionStore:i}=e;if(!n)return o.add("No API key provided");let l=null==(t=a.model)?void 0:t.trim();return l?a.messages?void await en({model:(0,t$.ER)({apiKey:n}).chat(l),variables:r,messages:a.messages,tools:a.tools,isVisionEnabled:!1,temperature:a.temperature,responseMapping:a.responseMapping,logs:o,sessionStore:i}):o.add("No messages provided"):o.add("No model provided")},stream:{getStreamVariableId:C,run:async e=>{var t;let{credentials:{apiKey:n},options:a,variables:r,sessionStore:o}=e;if(!n)return{error:{description:"No API key provided"}};let i=null==(t=a.model)?void 0:t.trim();return i?a.messages?ea({model:(0,t$.ER)({apiKey:n}).chat(i),variables:r,messages:a.messages,tools:a.tools,isVisionEnabled:!1,temperature:a.temperature,responseMapping:a.responseMapping,sessionStore:o}):{error:{description:"No messages provided"}}:{error:{description:"No model provided"}}}}}};var t1=n(90416),t2=n(52175);let t5={type:"encryptedCredentials",name:"OpenAI account",schema:x.object({apiKey:x.string.layout({isRequired:!0,label:"API key",placeholder:"sk-...",inputType:"password",helperText:"You can generate an API key [here](https://platform.openai.com/account/api-keys).",withVariableButton:!1,isDebounceDisabled:!0}),baseUrl:x.string.layout({label:"Base URL",defaultValue:"https://api.openai.com/v1",moreInfoTooltip:"Use a different URL prefix for API calls, e.g. to use proxy servers.",withVariableButton:!1,isDebounceDisabled:!0})})},t3=x.object({baseUrl:x.string.layout({accordion:"Customize provider",label:"Base URL"}),apiVersion:x.string.layout({accordion:"Customize provider",label:"API version"})}).layout({isHidden:!0}).describe("Deprecated, use other dedicated OpenAI compatible blocks instead"),t4=x.object({threadId:x.string.layout({label:"Thread ID",moreInfoTooltip:"Used to remember the conversation with the user. If empty, a new thread is created.",isHidden:!0})}),t9=["gpt-5","gpt-5-mini","gpt-5-nano","gpt-4.1","gpt-4.1-mini","gpt-4.1-nano","gpt-4o","gpt-4o-mini"],t6=["o3-mini","o1","o1-mini"],t7=["gpt-5*","gpt-4-turbo*","gpt-4o*","gpt-4*vision-preview"],t8=["gpt-4-turbo-preview"],ne={voiceModel:"tts-1"},nt=e=>!(!e||t8.includes(e))&&em(t7)(e),nn=async e=>{let t=e.split("\n\n"),n=[];for(let e of t){var a,r;if(e.startsWith("http")||e.startsWith('["http'))for(let t of e.startsWith("[")?JSON.parse(e):[e]){let e=t.trim();try{let r=await L.Ay.get(e);r.ok&&(null==(a=r.headers.get("content-type"))?void 0:a.startsWith("image/"))?n.push({type:"image_url",image_url:t.trim()}):n.push({type:"text",text:e})}catch(e){e instanceof U.H?console.log(e.response.status,await e.response.text()):console.error(e)}}else if((null==(r=n.at(-1))?void 0:r.type)==="text"){let t=n.at(-1);(n=n.slice(0,-1)).push({type:"text",text:t.text+"\n\n"+e})}else n.push({type:"text",text:e})}return n},na={auth:t5,baseOptions:t3,name:"Ask Assistant",options:x.object({assistantId:x.string.layout({label:"Assistant ID",placeholder:"Select an assistant",moreInfoTooltip:"The OpenAI assistant you want to ask question to.",fetcher:"fetchAssistants"}),threadVariableId:x.string.layout({label:"Thread ID",moreInfoTooltip:"Used to remember the conversation with the user. If empty, a new thread is created.",inputType:"variableDropdown"}),message:x.string.layout({label:"Message",inputType:"textarea"}),functions:x.array(x.object({name:x.string.layout({fetcher:"fetchAssistantFunctions",label:"Name"}),code:x.string.layout({inputType:"code",label:"Code",lang:"javascript",moreInfoTooltip:"A javascript code snippet that can use the defined parameters. It should return a value.",withVariableButton:!1})})).layout({accordion:"Functions",itemLabel:"function"}),additionalInstructions:x.string.layout({label:"Additional Instructions",inputType:"textarea",accordion:"Advanced settings"}),responseMapping:x.saveResponseArray(["Message","Thread ID"],{item:{hiddenItems:["Thread ID"]}}).layout({accordion:"Save response"})}).merge(t4),fetchers:[{id:"fetchAssistants",fetch:async e=>{var t;let{options:n,credentials:a}=e;if(!(null==a?void 0:a.apiKey))return{data:[]};let r={apiKey:a.apiKey,baseURL:null!=(t=a.baseUrl)?t:n.baseUrl,defaultHeaders:{"api-key":a.apiKey},defaultQuery:n.apiVersion?{"api-version":n.apiVersion}:void 0},i=new t2.z4(r);try{return{data:(await i.beta.assistants.list({limit:100})).data.map(e=>e.name?{label:e.name,value:e.id}:void 0).filter(o.O9)}}catch(e){return{error:await k({err:e})}}},dependencies:["baseUrl","apiVersion"]},{id:"fetchAssistantFunctions",fetch:async e=>{var t;let{options:n,credentials:a}=e;if(!n.assistantId||!(null==a?void 0:a.apiKey))return{data:[]};let r={apiKey:a.apiKey,baseURL:null!=(t=a.baseUrl)?t:n.baseUrl,defaultHeaders:{"api-key":a.apiKey},defaultQuery:n.apiVersion?{"api-version":n.apiVersion}:void 0},i=new t2.z4(r);try{return{data:(await i.beta.assistants.retrieve(n.assistantId)).tools.filter(e=>"function"===e.type).map(e=>"function"===e.type&&e.function.name?e.function.name:void 0).filter(o.O9)}}catch(e){return{error:await k({err:e})}}},dependencies:["baseUrl","apiVersion","assistantId"]}],getSetVariableIds:e=>{var t;let{responseMapping:n}=e;return null!=(t=null==n?void 0:n.map(e=>e.variableId).filter(o.O9))?t:[]},run:{stream:{getStreamVariableId:e=>{var t;let{responseMapping:n}=e;return null==n||null==(t=n.find(e=>!e.item||"Message"===e.item))?void 0:t.variableId},run:async e=>{var t;let{credentials:n,options:a,variables:r,sessionStore:o}=e;return{stream:await nr({apiKey:n.apiKey,assistantId:a.assistantId,message:a.message,baseUrl:null!=(t=n.baseUrl)?t:a.baseUrl,apiVersion:a.apiVersion,threadVariableId:a.threadVariableId,variables:r,functions:a.functions,responseMapping:a.responseMapping,additionalInstructions:a.additionalInstructions,sessionStore:o})}}},server:async e=>{let{credentials:{apiKey:t},options:{baseUrl:n,apiVersion:a,assistantId:r,message:o,responseMapping:i,threadId:l,threadVariableId:s,functions:d,additionalInstructions:u},variables:c,logs:p,sessionStore:m}=e,b=await nr({apiKey:t,assistantId:r,logs:p,message:o,baseUrl:n,apiVersion:a,threadVariableId:s,variables:c,threadId:l,functions:d,additionalInstructions:u,sessionStore:m});if(!b)return void p.add("createAssistantStream returned undefined");let g="";await (0,t1.EC)({stream:b,onTextPart:e=>{g+=e},onErrorPart:e=>{null==p||p.add(e)}}),null==i||i.forEach(e=>{e.variableId&&(!e.item||"Message"===e.item)&&c.set([{id:e.variableId,value:g.replace(/【.+】/g,"")}])})}}},nr=async e=>{var t,n;let a,{apiKey:r,assistantId:i,logs:l,message:s,baseUrl:d,apiVersion:u,threadVariableId:c,variables:p,threadId:m,functions:b,responseMapping:g,additionalInstructions:h,sessionStore:y}=e;if((0,o.Im)(i)){null==l||l.add("Assistant ID is empty");return}if((0,o.Im)(s)){null==l||l.add("Message is empty");return}let f=new t2.z4({apiKey:r,baseURL:d,defaultHeaders:{"api-key":r},defaultQuery:u?{"api-version":u}:void 0});if(c&&(0,o.hj)(null==(t=p.get(c))?void 0:t.toString()))a=null==(n=p.get(c))?void 0:n.toString();else if((0,o.hj)(m))a=m;else{a=(await f.beta.threads.create({})).id;let e=null==g?void 0:g.find(e=>"Thread ID"===e.item);(null==e?void 0:e.variableId)?await p.set([{id:e.variableId,value:a}]):c&&await p.set([{id:c,value:a}])}if(!a){null==l||l.add("Could not get thread ID");return}try{let e=await f.beta.assistants.retrieve(i);return await f.beta.threads.messages.create(a,{role:"user",content:nt(e.model)?await nn(s):s}),no(async e=>{var t;let{forwardStream:n}=e;if(!a)return;let r=f.beta.threads.runs.stream(a,{assistant_id:i,additional_instructions:h}),l=await n(r);for(;(null==l?void 0:l.status)==="requires_action"&&(null==(t=l.required_action)?void 0:t.type)==="submit_tool_outputs";){let e=(await Promise.all(l.required_action.submit_tool_outputs.tool_calls.map(async e=>{var t;let n=JSON.parse(e.function.arguments),a=null==b?void 0:b.find(t=>t.name===e.function.name);if(!a||!e.function.name||!a.code)return;let{output:r,newVariables:o}=await Z({variables:p.list(),body:a.code,args:n,sessionStore:y});return o&&o.length>0&&await p.set(o),{tool_call_id:e.id,output:null!=(t=z(r))?t:""}}))).filter(o.O9);l=await n(f.beta.threads.runs.submitToolOutputsStream(a,l.id,{tool_outputs:e}))}})}catch(e){null==l||l.add(await k({err:e}))}},no=e=>new ReadableStream({async start(t){let n=new TextEncoder,a=async e=>{let a;for await(let i of e)switch(i.event){case"thread.message.delta":{var r,o;let e=null==(r=i.data.delta.content)?void 0:r[0];(null==e?void 0:e.type)==="text"&&(null==(o=e.text)?void 0:o.value)!=null&&t.enqueue(n.encode((0,t1.H4)("text",e.text.value)));break}case"thread.run.completed":case"thread.run.requires_action":a=i.data}return a};try{await e({forwardStream:a})}catch(e){var r,o;o=null!=(r=e.message)?r:"".concat(e),t.enqueue(n.encode((0,t1.H4)("error",o)))}finally{t.close()}},pull(){},cancel(){}});var ni=n(23950);let nl={name:"Create chat completion",auth:t5,baseOptions:t3,options:e5({models:{type:"static",models:t9.concat(t6)}}),getSetVariableIds:e$,turnableInto:[{blockId:"open-router"},{blockId:"together-ai"},{blockId:"mistral",transform:e=>({...e,model:void 0})},{blockId:"groq"},{blockId:"perplexity",transform:e=>({...e,model:void 0})},{blockId:"anthropic",transform:e=>({...e,model:void 0,action:"Create Chat Message"})},{blockId:"deepseek",transform:e=>({...e,model:void 0})}],run:{server:async e=>{var t;let{credentials:{apiKey:n,baseUrl:a},options:r,variables:o,logs:i,sessionStore:l}=e;if(!n)return i.add("No API key provided");let s=null==(t=r.model)?void 0:t.trim();return s?r.messages?void await en({model:(0,ni.r)({baseURL:null!=a?a:r.baseUrl,apiKey:n,compatibility:"strict"})(s),variables:o,messages:r.messages,tools:r.tools,isVisionEnabled:nt(s),temperature:r.temperature,responseMapping:r.responseMapping,logs:i,sessionStore:l}):i.add("No messages provided"):i.add("No model provided")},stream:{getStreamVariableId:C,run:async e=>{var t;let{credentials:{apiKey:n,baseUrl:a},options:r,variables:o,sessionStore:i}=e,l="While streaming OpenAI chat completion";if(!n)return{error:{description:"No API key provided",context:l}};let s=null==(t=r.model)?void 0:t.trim();return s?r.messages?ea({model:(0,ni.r)({baseURL:null!=a?a:r.baseUrl,apiKey:n,compatibility:"strict"})(s),variables:o,messages:r.messages,isVisionEnabled:nt(s),tools:r.tools,temperature:r.temperature,responseMapping:r.responseMapping,sessionStore:i}):{error:{description:"No messages provided",context:l}}:{error:{description:"No model provided",context:l}}}}}};var ns=n(51642).Buffer;let nd={name:"Create speech",auth:t5,baseOptions:t3,options:x.object({model:x.string.layout({fetcher:"fetchSpeechModels",defaultValue:"tts-1",placeholder:"Select a model"}),input:x.string.layout({label:"Input",inputType:"textarea"}),voice:x.enum(["alloy","echo","fable","onyx","nova","shimmer"]).layout({label:"Voice",placeholder:"Select a voice"}),saveUrlInVariableId:x.string.layout({inputType:"variableDropdown",label:"Save URL in variable"})}),getSetVariableIds:e=>e.saveUrlInVariableId?[e.saveUrlInVariableId]:[],fetchers:[{id:"fetchSpeechModels",dependencies:["baseUrl","apiVersion"],fetch:async e=>{let{credentials:t,options:n}=e;if(!(null==t?void 0:t.apiKey))return{data:[]};let a=null==n?void 0:n.baseUrl,r={apiKey:t.apiKey,baseURL:a,defaultHeaders:{"api-key":t.apiKey},defaultQuery:(null==n?void 0:n.apiVersion)?{"api-version":n.apiVersion}:void 0},o=new t2.Ay(r);try{var i;return{data:null!=(i=(await o.models.list()).data.filter(e=>e.id.includes("tts")).sort((e,t)=>t.created-e.created).map(e=>e.id))?i:[]}}catch(e){return{error:await k({err:e,context:"While fetching OpenAI speech models"})}}}}],run:{server:async e=>{var t;let{credentials:{apiKey:n},options:a,variables:r,logs:i}=e;if(!a.input)return i.add("Create speech input is empty");if(!a.voice)return i.add("Create speech voice is empty");if(!a.saveUrlInVariableId)return i.add("Create speech save variable is empty");let l={apiKey:n,baseURL:a.baseUrl,defaultHeaders:{"api-key":n},defaultQuery:(0,o.hj)(a.apiVersion)?{"api-version":a.apiVersion}:void 0},s=new t2.Ay(l),d=null!=(t=a.model)?t:ne.voiceModel;try{let e=await s.audio.speech.create({input:a.input,voice:a.voice,model:d}),t=await tm({file:ns.from(await e.arrayBuffer()),key:"tmp/openai/audio/".concat((0,td.sX)()+(0,td.sX)(),".mp3"),mimeType:"audio/mpeg"});r.set([{id:a.saveUrlInVariableId,value:t}])}catch(e){i.add(await k({err:e,context:"While generating speech"}))}}}},nu={name:"Create transcription",auth:t5,baseOptions:t3,options:x.object({url:x.string.layout({label:"Audio URL"}),transcriptionVariableId:x.string.layout({label:"Save result to",inputType:"variableDropdown"})}),getSetVariableIds:e=>e.transcriptionVariableId?[e.transcriptionVariableId]:[],run:{server:async e=>{let{credentials:{apiKey:t},options:n,variables:a,logs:r}=e;if(!n.url)return r.add("Audio URL is empty");if(!n.transcriptionVariableId)return r.add("Missing transcription variable");let i={apiKey:t,baseURL:n.baseUrl,defaultHeaders:{"api-key":t},defaultQuery:(0,o.hj)(n.apiVersion)?{"api-version":n.apiVersion}:void 0},l=new t2.Ay(i),s=await l.audio.transcriptions.create({file:await fetch(n.url),model:"whisper-1"});a.set([{id:n.transcriptionVariableId,value:s.text}])}}},nc={name:"Generate variables",auth:t5,baseOptions:t3,options:ex({models:{type:"static",models:t9.concat(t6)}}),aiGenerate:{models:{type:"static",items:t9.concat(t6)},getModel:e=>{let{credentials:t,model:n}=e;return(0,ni.r)({apiKey:t.apiKey,compatibility:"strict"})(n)}},turnableInto:[{blockId:"mistral"},{blockId:"anthropic",transform:e=>({...e,model:void 0})}],getSetVariableIds:e=>{var t,n;return null!=(n=null==(t=e.variablesToExtract)?void 0:t.map(e=>e.variableId).filter(o.O9))?n:[]},run:{server:e=>{let{credentials:t,options:n,variables:a,logs:r}=e;return(null==t?void 0:t.apiKey)===void 0?r.add("No API key provided"):void 0===n.model?r.add("No model provided"):e_({model:(0,ni.r)({apiKey:t.apiKey,compatibility:"strict"})(n.model),prompt:n.prompt,variablesToExtract:n.variablesToExtract,variables:a,logs:r})}}};var np=n(59754);let nm={type:"encryptedCredentials",name:"Perplexity account",schema:x.object({apiKey:x.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can generate an API key [here](https://www.perplexity.ai/settings/api)",placeholder:"pplx-...",withVariableButton:!1,isDebounceDisabled:!0}),baseUrl:x.string.layout({label:"Base URL",defaultValue:"https://api.perplexity.ai",withVariableButton:!1,isDebounceDisabled:!0})})},nb={name:"Create chat completion",auth:nm,options:e5({models:{type:"static",models:["sonar-deep-research","sonar-reasoning-pro","sonar-reasoning","sonar-pro","sonar"]}}),turnableInto:[{blockId:"openai",transform:e=>({...e,model:void 0})},{blockId:"mistral",transform:e=>({...e,model:void 0})},{blockId:"groq",transform:e=>({...e,model:void 0})},{blockId:"together-ai"},{blockId:"open-router"},{blockId:"anthropic",transform:e=>({...e,model:void 0,action:"Create Chat Message"})},{blockId:"deepseek",transform:e=>({...e,model:void 0})}],getSetVariableIds:e=>{var t,n;return null!=(n=null==(t=e.responseMapping)?void 0:t.map(e=>e.variableId).filter(o.O9))?n:[]},run:{server:async e=>{var t;let{credentials:{apiKey:n,baseUrl:a},options:r,variables:o,logs:i,sessionStore:l}=e;if(!n)return i.add("No API key provided");let s=null==(t=r.model)?void 0:t.trim();return s?r.messages?void await en({model:(0,np.d)({apiKey:n,baseURL:null!=a?a:void 0})(s),variables:o,messages:r.messages,tools:r.tools,isVisionEnabled:!1,temperature:r.temperature,responseMapping:r.responseMapping,logs:i,sessionStore:l}):i.add("No messages provided"):i.add("No model provided")},stream:{getStreamVariableId:C,run:async e=>{var t;let{credentials:{apiKey:n,baseUrl:a},options:r,variables:o,sessionStore:i}=e;if(!n)return{error:{description:"No API key provided"}};let l=null==(t=r.model)?void 0:t.trim();return l?r.messages?ea({model:(0,np.d)({apiKey:n,baseURL:null!=a?a:void 0})(l),variables:o,messages:r.messages,isVisionEnabled:!1,tools:r.tools,temperature:r.temperature,responseMapping:r.responseMapping,sessionStore:i}):{error:{description:"No messages provided"}}:{error:{description:"No model provided"}}}}}},ng="https://us.i.posthog.com",nh={type:"encryptedCredentials",name:"Posthog account",schema:x.object({apiKey:x.string.layout({label:"Project API key",isRequired:!0,inputType:"password",withVariableButton:!1,isDebounceDisabled:!0}),host:x.string.layout({label:"Host",withVariableButton:!1,isDebounceDisabled:!0,defaultValue:ng})})};var ny=n(57246);let nf=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ng;return new ny.PostHog(e,{host:t,requestTimeout:5e3})},nv=e=>{if(!e)return;let t={};return e.forEach(e=>{let{type:n,key:a}=e;(null==a?void 0:a.trim())&&(null==n?void 0:n.trim())&&(t[n]=a)}),t},nw=e=>{let{properties:t,personProperties:n,isAnonymous:a}=e;if(!t)return;let r={};if(t.forEach(e=>{let{key:t,value:n}=e;t&&n&&(r[t]=n)}),a)r.$process_person_profile=!1;else if(n){let e={};n.forEach(t=>{let{key:n,value:a}=t;n&&a&&(e[n]=a)}),r.$set=e}return r},nI={auth:nh,name:"Capture",parseBlockNodeLabel:e=>"Capture ".concat(e.event),options:x.object({isAnonymous:x.boolean.layout({label:"Anonymous",isRequired:!1,defaultValue:!1}),distinctId:x.string.layout({label:"Distinct ID",isRequired:!1,isHidden:e=>e.isAnonymous}),event:x.string.layout({label:"Event",isRequired:!0}),properties:x.array(x.object({key:x.string.layout({label:"Key",isRequired:!0}),value:x.string.layout({label:"Value",isRequired:!0})})).layout({itemLabel:"a property",accordion:"Properties"}),personProperties:x.array(x.object({key:x.string.layout({label:"Key",isRequired:!0}),value:x.string.layout({label:"Value",isRequired:!0})})).layout({itemLabel:"a property",accordion:"Person properties"}),groups:x.array(x.object({type:x.string.layout({label:"Type",isRequired:!0}),key:x.string.layout({label:"Key",isRequired:!0})})).layout({itemLabel:"a group",accordion:"Associated groups"})}),run:{server:async e=>{let{credentials:{apiKey:t,host:n},options:{event:a,distinctId:r,isAnonymous:o,groups:i,properties:l,personProperties:s},logs:d}=e;if(void 0===a||0===a.length||!r||0===r.length||void 0===t||void 0===n)return void d.add("PostHog Capture: Missing required fields");let u=nf(t,n);u.capture({distinctId:o?(0,td.sX)():r,event:a,properties:nw({properties:l,personProperties:s,isAnonymous:o}),groups:nv(i)}),await u.shutdown()}}},nE={auth:nh,name:"Identify Group",options:x.object({distinctId:x.string.layout({label:"Distinct ID",isRequired:!1}),groupType:x.string.layout({label:"Type",isRequired:!0}),groupKey:x.string.layout({label:"Key",isRequired:!0}),properties:x.array(x.object({key:x.string.layout({label:"Key",isRequired:!0}),value:x.string.layout({label:"Value",isRequired:!0})})).layout({itemLabel:"property"})}),run:{server:async e=>{let{credentials:{apiKey:t,host:n},options:{distinctId:a,groupKey:r,groupType:o,properties:i},logs:l}=e;if(!t)return;let s=nf(t,n);return a?r&&o?void(s.groupIdentify({distinctId:a,groupType:o,groupKey:r,properties:nw({properties:i})}),await s.shutdown()):l.add("Group type and key are required"):l.add("Distinct ID is required")}}};var nx=n(27693);let n_={name:"Generate a QR Code",options:x.object({data:x.string.layout({label:"Data",helperText:"This can be a URL, or any text data you want to encode into a QR code."}),saveUrlInVariableId:x.string.layout({label:"Save QR code image URL",inputType:"variableDropdown"})}),getSetVariableIds:e=>e.saveUrlInVariableId?[e.saveUrlInVariableId]:[],run:{server:async e=>{let{options:t,variables:n,logs:a}=e;if(!t.data)return a.add("QR code data is empty. Please provide the data to be encoded into the QR code.");if(!t.saveUrlInVariableId)return a.add("QR code image URL is not specified. Please select a variable to save the generated QR code image.");let r=await tm({file:await (0,nx.toBuffer)(t.data),key:"tmp/qrcodes/".concat((0,td.sX)()+(0,td.sX)(),".png"),mimeType:"image/png"});n.set([{id:t.saveUrlInVariableId,value:r}])}}};var nT=n(45819);let nC={type:"encryptedCredentials",name:"Segment account",schema:x.object({apiKey:x.string.layout({label:"Write Key",isRequired:!0,inputType:"password",helperText:"You can find your Write Key in your Segment source settings.",withVariableButton:!1,isDebounceDisabled:!0})})},nS={auth:nC,name:"Alias",options:x.object({userId:x.string.layout({label:"User ID",isRequired:!0,moreInfoTooltip:"New ID of the user."}),previousId:x.string.layout({label:"Previous ID",moreInfoTooltip:"Previous ID of the user to alias."})}),run:{server:async e=>{let{credentials:{apiKey:t},options:{userId:n,previousId:a}}=e;if(!n||0===n.length||!a||0===a.length||void 0===t)return;let r=new nT.j0({writeKey:t});r.alias({userId:n,previousId:a}),await r.closeAndFlush()}}},nk={auth:nC,name:"Identify User",options:x.object({userId:x.string.layout({label:"User ID",isRequired:!0}),email:x.string.layout({label:"Email",isRequired:!1}),traits:x.array(x.object({key:x.string.layout({label:"Key",isRequired:!0}),value:x.string.layout({label:"Value",isRequired:!0})})).layout({itemLabel:"trait"})}),run:{server:async e=>{let{credentials:{apiKey:t},options:{userId:n,email:a,traits:r}}=e;if(!a||0===a.length||!n||0===n.length||void 0===t)return;let o=new nT.j0({writeKey:t});void 0===r||0===r.length?o.identify({userId:n,traits:{email:a}}):o.identify({userId:n,traits:nN(r,a)}),await o.closeAndFlush()}}},nN=(e,t)=>{let n={};return e.push({key:"email",value:t}),e.forEach(e=>{let{key:t,value:a}=e;t&&a&&(n[t]=a)}),n},nA={auth:nC,name:"Track",options:x.object({eventName:x.string.layout({label:"Name",isRequired:!0}),userId:x.string.layout({label:"User ID",isRequired:!0}),properties:x.array(x.object({key:x.string.layout({label:"Key",isRequired:!0}),value:x.string.layout({label:"Value",isRequired:!0})})).layout({itemLabel:"property"})}),run:{server:async e=>{let{credentials:{apiKey:t},options:{eventName:n,userId:a,properties:r}}=e;if(!n||0===n.length||!a||0===a.length||void 0===t)return;let o=new nT.j0({writeKey:t});void 0===r||0===r.length?o.track({userId:a,event:n}):o.track({userId:a,event:n,properties:nP(r)}),await o.closeAndFlush()}}},nP=e=>{let t={};return e.forEach(e=>{let{key:n,value:a}=e;n&&a&&(t[n]=a)}),t},nR={auth:nC,name:"Page",options:x.object({userId:x.string.layout({label:"User ID",isRequired:!0}),name:x.string.layout({label:"Name",isRequired:!0}),category:x.string.layout({label:"Category",isRequired:!1}),properties:x.array(x.object({key:x.string.layout({label:"Key",isRequired:!0}),value:x.string.layout({label:"Value",isRequired:!0})})).layout({itemLabel:"property"})}),run:{server:async e=>{let{credentials:{apiKey:t},options:{userId:n,name:a,category:r,properties:o}}=e;if(!a||0===a.length||!n||0===n.length||void 0===t)return;let i=new nT.j0({writeKey:t});void 0===o||0===o.length?i.page({userId:n,name:a,category:void 0!==r?r:""}):i.page({userId:n,name:a,category:void 0!==r?r:"",properties:nj(o)}),await i.closeAndFlush()}}},nj=e=>{let t={};return e.forEach(e=>{let{key:n,value:a}=e;n&&a&&(t[n]=a)}),t};var nL=n(46608);let nU={type:"encryptedCredentials",name:"Together account",schema:x.object({apiKey:x.string.layout({label:"API key",isRequired:!0,inputType:"password",helperText:"You can get your API key [here](https://api.together.xyz/settings/api-keys).",isDebounceDisabled:!0})})},nO={name:"Create chat completion",auth:nU,options:e5({models:{type:"text",helperText:"You can find the list of all the models available [here](https://docs.together.ai/docs/inference-models#chat-models). Copy the model string for API."}}),turnableInto:[{blockId:"openai"},{blockId:"open-router"},{blockId:"mistral"},{blockId:"perplexity"},{blockId:"anthropic",transform:e=>({...e,action:"Create Chat Message"})},{blockId:"groq"},{blockId:"deepseek"}],getSetVariableIds:e$,run:{server:async e=>{var t;let{credentials:{apiKey:n},options:a,variables:r,logs:o,sessionStore:i}=e;if(!n)return o.add("No API key provided");let l=null==(t=a.model)?void 0:t.trim();return l?a.messages?void await en({model:(0,nL.F)({apiKey:n})(l),variables:r,messages:a.messages,tools:a.tools,isVisionEnabled:!1,temperature:a.temperature,responseMapping:a.responseMapping,logs:o,sessionStore:i}):o.add("No messages provided"):o.add("No model provided")},stream:{getStreamVariableId:C,run:async e=>{var t;let{credentials:{apiKey:n},options:a,variables:r,sessionStore:o}=e;if(!n)return{error:{description:"No API key provided"}};let i=null==(t=a.model)?void 0:t.trim();return i?a.messages?ea({model:(0,nL.F)({apiKey:n})(i),variables:r,messages:a.messages,tools:a.tools,isVisionEnabled:!1,temperature:a.temperature,responseMapping:a.responseMapping,sessionStore:o}):{error:{description:"No messages provided"}}:{error:{description:"No model provided"}}}}}};var nV=n(51429);let nD={type:"encryptedCredentials",name:"Zendesk Conversations API",schema:x.object({conversationsKeyId:x.string.layout({label:"Conversations Key ID",isRequired:!0,withVariableButton:!1,isDebounceDisabled:!0,helperText:"[How to find my Zendesk Key ID and Secret Key?](https://docs.typebot.io/editor/blocks/integrations/zendesk#how-to-find-my-zendesk-key-id-and-secret-key)"}),conversationsSecretKey:x.string.layout({label:"Conversations Secret Key",isRequired:!0,inputType:"password",withVariableButton:!1,isDebounceDisabled:!0})})},nB={auth:nD,name:"Open Web Widget",options:x.object({userId:x.string.layout({label:"User ID"}),name:x.string.layout({label:"Name"}),email:x.string.layout({label:"Email"}),webWidgetKey:x.string.layout({label:"Web Widget Key",helperText:"[Finding web widget key](https://docs.typebot.io/editor/blocks/integrations/zendesk#open-web-widget)"})}),run:{web:{parseFunction:e=>{let{credentials:{conversationsSecretKey:t,conversationsKeyId:n},options:{userId:a,name:r,email:o,webWidgetKey:i}}=e,l="";return a&&o?l=(0,nV.sign)({scope:"user",external_id:null!=a?a:"",name:null!=r?r:"",email:o,email_verified:"true"},null!=t?t:"",{algorithm:"HS256",keyid:null!=n?n:""}):a&&(l=(0,nV.sign)({scope:"user",external_id:null!=a?a:"",name:null!=r?r:""},null!=t?t:"",{algorithm:"HS256",keyid:null!=n?n:""})),{args:{isAuthEnabled:void 0!==a&&""!==a?"true":"false",token:l,key:null!=i?i:""},content:nz()}}}}},nz=()=>'(function (d, t) {\n    var ZD_URL = "https://static.zdassets.com/ekr/snippet.js?key=" + key;\n\n    var ze_script = d.createElement(t);\n    var s = d.getElementsByTagName(t)[0];\n\n    ze_script.id="ze-snippet";\n    ze_script.src = ZD_URL;\n    ze_script.crossorigin = "anonymous";\n    ze_script.defer = true;\n    ze_script.async = true;\n    s.parentNode.insertBefore(ze_script, s);\n\n    ze_script.onload = function () {\n      if ( isAuthEnabled === "true" && token != "") {\n        zE("messenger", "loginUser", function (callback) {\n          callback(token);\n          zE("messenger", "open");\n        });\n      } else {\n        zE("messenger", "open");\n      }\n    };\n  })(document, "script");\n\n  return "'.concat("Zendesk Web Widget Opened",'"\n  ');tJ.id;let nM=e=>Object.values(p).includes(e.type),nH=e=>Object.values(c).includes(e.type),nK=e=>Object.values(b).includes(e.type),nG=e=>e.type===p.CHOICE,nW=e=>Object.values(m).concat(g).includes(e.type),nF=e=>Object.values(c).includes(e);var nq=n(92349);let nX=(e,t)=>{for(let s=0;s<t.length;s++){var n,a,r,o,i,l;for(let d=0;d<(null!=(r=null==(a=t.at(s))||null==(n=a.blocks)?void 0:n.length)?r:0);d++)if((null==(l=t.at(s))||null==(i=l.blocks)||null==(o=i.at(d))?void 0:o.id)===e)return{block:t[s].blocks[d],group:t[s],blockIndex:d,groupIndex:s}}throw Error("Block with id ".concat(e," was not found"))};var nY=n(98088),nJ=n(38852),n$=function(e){return e.GET="Get data from sheet",e.INSERT_ROW="Insert a row",e.UPDATE_ROW="Update a row",e}({}),nQ=n(97036),nZ=function(e){return e.OR="OR",e.AND="AND",e}({}),n0=function(e){return e.EQUAL="Equal to",e.NOT_EQUAL="Not equal",e.CONTAINS="Contains",e.NOT_CONTAINS="Does not contain",e.GREATER="Greater than",e.GREATER_OR_EQUAL="Greater or equal to",e.LESS="Less than",e.LESS_OR_EQUAL="Less or equal to",e.IS_SET="Is set",e.IS_EMPTY="Is empty",e.STARTS_WITH="Starts with",e.ENDS_WITH="Ends with",e.MATCHES_REGEX="Matches regex",e.NOT_MATCH_REGEX="Does not match regex",e}({}),n1=n(95232),n2=n(86387);let n5={labels:{placeholder:"<strong>\n      Click to upload\n    </strong> or drag and drop<br>\n    (size limit: 10MB)",button:"Upload",clear:"Clear",skip:"Skip",success:{single:"File uploaded",multiple:"{total} files uploaded"}}};var n3=function(e){return e.STRIPE="Stripe",e}({}),n4=n(78895);let n9={length:10};var n6=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fieldToParse:"value",escapeForJson:!1};return n=>n&&""!==n?n.replace(/\{\{(.*?)\}\}/g,(n,a)=>{let r=a.replace(/{{|}}/g,""),i=e.find(e=>r===e.name&&("id"===t.fieldToParse||(0,o.O9)(e.value)));if(!i)return"";if("id"===t.fieldToParse)return i.id;let{value:l}=i;return t.escapeForJson?ae("string"==typeof l?l:JSON.stringify(l)):n7(l)||""}):""},n7=e=>{if((0,o.pN)(e))return null;if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return console.warn("Failed to safely stringify variable value",e),null}},n8=e=>{if(null===e)return null;if(void 0!==e){if(Array.isArray(e)||"number"==typeof e)return e;if("true"===e)return!0;if("false"===e)return!1;if("null"===e)return null;if("undefined"!==e)try{return JSON.parse(e)}catch(t){return e}}},ae=e=>e.replace(/\n/g,"\\n").replace(/"/g,'\\"').replace(/\\[^n"]/g,"\\\\ "),at=(e,t)=>Object.keys(e).reduce((n,a)=>{let r=e[a];return{...n,[a]:"string"==typeof r?n6(t)(r):r}},{}),an=(0,u.createContext)({}),aa=e=>{let{children:t,resultId:n,onNewAnswer:a,onVariablesUpdated:i}=e,[l,s]=(0,u.useState)({answers:[],variables:[],createdAt:new Date}),d=e=>{let t=e.map(e=>({...e,value:n7(e.value)}));s(e=>{let n=[...e.variables.filter(e=>t.every(t=>t.id!==e.id||t.name!==e.name)),...t].filter(e=>(0,o.O9)(e.value));return i&&i(n),{...e,variables:n}})};return(0,r.jsx)(an.Provider,{value:{resultId:n,resultValues:l,addAnswer:e=>t=>{var n,r;return t.variableId&&d([{id:t.variableId,value:t.content,name:null!=(r=null==(n=e.find(e=>e.id===t.variableId))?void 0:n.name)?r:""}]),s(e=>({...e,answers:[...e.answers,t]})),a&&a(t)},updateVariables:d},children:t})},ar=()=>(0,u.useContext)(an),ao=e=>{var t;return null==(t=e.filter(e=>nH(e)||nM(e)).pop())?void 0:t.type},ai=e=>{try{var t;null==(t=window.top)||t.postMessage({from:"typebot",...e},"*")}catch(e){console.error(e)}},al=(0,u.createContext)({}),as=e=>{let{children:t,typebot:n,apiHost:a,isPreview:i,isLoading:l,onNewLog:s}=e,[d,c]=(0,u.useState)(n),[p,m]=(0,u.useState)([]),[b,g]=(0,u.useState)(n.typebotId),[h,y]=(0,u.useState)([]),[f,v]=(0,u.useState)([]);(0,u.useEffect)(()=>{c(e=>({...e,theme:n.theme,settings:n.settings}))},[n.theme,n.settings]);let w=(e,t)=>e.map(e=>{var n;let a=t.find(t=>t.name===e.name);return{...e,value:null!=(n=null==a?void 0:a.value)?n:e.value}});return(0,r.jsx)(al.Provider,{value:{typebot:d,linkedTypebots:p,apiHost:a,isPreview:i,updateVariableValue:(e,t)=>{var n,a;let r=n7(t);ai({newVariableValue:{name:null!=(a=null==(n=d.variables.find(t=>t.id===e))?void 0:n.name)?a:"",value:null!=r?r:""}});let i=d.variables.find(t=>t.id===e),l=d.variables.filter(t=>t.name===(null==i?void 0:i.name)&&t.id!==e),s=[i,...l].filter(o.O9);c(e=>({...e,variables:e.variables.map(e=>s.some(t=>t.id===e.id)?{...e,value:r}:e)}))},createEdge:e=>{c(t=>({...t,edges:[...t.edges,e]}))},injectLinkedTypebot:e=>{let t=w(e.variables,d.variables),n={id:"typebotId"in e?e.typebotId:e.id,groups:e.groups,edges:e.edges,variables:t};return m(e=>[...e,n]),c({...d,groups:[...d.groups,...n.groups],variables:[...d.variables,...n.variables],edges:[...d.edges,...n.edges]}),n},onNewLog:s,linkedBotQueue:h,isLoading:l,parentTypebotIds:f,pushParentTypebotId:e=>{v(t=>[...t,e])},pushEdgeIdInLinkedTypebotQueue:e=>y(t=>[...t,e]),popEdgeIdFromLinkedTypebotQueue:()=>{y(e=>e.slice(1)),v(e=>e.slice(1)),g(h[0].typebotId)},currentTypebotId:b,setCurrentTypebotId:g},children:t})},ad=()=>(0,u.useContext)(al),au={general:{bgImage:"--typebot-container-bg-image",bgColor:"--typebot-container-bg-color",fontFamily:"--typebot-container-font-family"},chat:{hostBubbles:{bgColor:"--typebot-host-bubble-bg-color",color:"--typebot-host-bubble-color"},guestBubbles:{bgColor:"--typebot-guest-bubble-bg-color",color:"--typebot-guest-bubble-color"},inputs:{bgColor:"--typebot-input-bg-color",color:"--typebot-input-color",placeholderColor:"--typebot-input-placeholder-color"},buttons:{bgColor:"--typebot-button-bg-color",color:"--typebot-button-color"}}},ac=(e,t)=>{e&&(e.general&&ap(e.general,t),e.chat&&am(e.chat,t))},ap=(e,t)=>{let{background:n,font:a}=e;a&&"string"==typeof a&&t.setProperty(au.general.fontFamily,a)},am=(e,t)=>{let{hostBubbles:n,guestBubbles:a,buttons:r,inputs:o}=e;n&&ab(n,t),a&&ag(a,t),r&&ah(r,t),o&&ay(o,t)},ab=(e,t)=>{e.backgroundColor&&t.setProperty(au.chat.hostBubbles.bgColor,e.backgroundColor),e.color&&t.setProperty(au.chat.hostBubbles.color,e.color)},ag=(e,t)=>{e.backgroundColor&&t.setProperty(au.chat.guestBubbles.bgColor,e.backgroundColor),e.color&&t.setProperty(au.chat.guestBubbles.color,e.color)},ah=(e,t)=>{e.backgroundColor&&t.setProperty(au.chat.buttons.bgColor,e.backgroundColor),e.color&&t.setProperty(au.chat.buttons.color,e.color)},ay=(e,t)=>{e.backgroundColor&&t.setProperty(au.chat.inputs.bgColor,e.backgroundColor),e.color&&t.setProperty(au.chat.inputs.color,e.color),e.placeholderColor&&t.setProperty(au.chat.inputs.placeholderColor,e.placeholderColor)},af=(0,u.createContext)({}),av=e=>{let{children:t,onScroll:n}=e;return(0,r.jsx)(af.Provider,{value:{scroll:n},children:t})},aw=()=>(0,u.useContext)(af),aI=window.matchMedia("only screen and (max-width: 760px)").matches,aE=window.parent&&window.location!==(null==(a=window.top)?void 0:a.location),ax=(e,t,n)=>({status:e?"error":"success",description:e?n:t,details:e&&JSON.stringify(e,null,2).substring(0,1e3)}),a_=e=>{var t;return'\nwindow.$chatwoot.setUser("'.concat(null!=(t=null==e?void 0:e.id)?t:"",'", {\n  email: ').concat((null==e?void 0:e.email)?'"'.concat(e.email,'"'):"undefined",",\n  name: ").concat((null==e?void 0:e.name)?'"'.concat(e.name,'"'):"undefined",",\n  avatar_url: ").concat((null==e?void 0:e.avatarUrl)?'"'.concat(e.avatarUrl,'"'):"undefined",",\n  phone_number: ").concat((null==e?void 0:e.phoneNumber)?'"'.concat(e.phoneNumber,'"'):"undefined",",\n});\n\n")},aT=function(){let{baseUrl:e,websiteToken:t,user:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"\nif (window.$chatwoot) {\n  if(".concat(!!n,") {\n    ").concat(a_(n),'\n  }\n  window.$chatwoot.toggle("open");\n} else {\n  (function (d, t) {\n    var BASE_URL = "').concat(e,'";\n    var g = d.createElement(t),\n      s = d.getElementsByTagName(t)[0];\n    g.src = BASE_URL + "/packs/js/sdk";\n    g.defer = true;\n    g.async = true;\n    s.parentNode.insertBefore(g, s);\n    g.onload = function () {\n      window.chatwootSDK.run({\n        websiteToken: "').concat(t,'",\n        baseUrl: BASE_URL,\n      });\n      window.addEventListener("chatwoot:ready", function () {\n        if(').concat(!!((null==n?void 0:n.id)||(null==n?void 0:n.email)),") {\n          ").concat(a_(n),'\n        }\n        window.$chatwoot.toggle("open");\n      });\n    };\n  })(document, "script");\n}')},aC=(e,t)=>{let{variables:n,isPreview:a,onNewLog:r}=t;if(a)r({status:"info",description:"Chatwoot won't open in preview mode"});else if(aE)ai({closeChatBubble:!0}),ai({codeToExecute:n6(n)(aT(e.options))});else{let t=Function(n6(n)(aT(e.options)));try{t()}catch(e){console.error(e)}}return e.outgoingEdgeId},aS=async(e,t)=>{var a;let{variables:r}=t;if(!(null==(a=e.options)?void 0:a.trackingId))return e.outgoingEdgeId;let{default:o}=await n.e(36).then(n.bind(n,11036));return await o(e.options.trackingId),(0,l.a)(at(e.options,r)),e.outgoingEdgeId},ak=async(e,t)=>{if(!e.options||!("action"in e.options))return e.outgoingEdgeId;switch(e.options.action){case n$.INSERT_ROW:aN(e.options,t);break;case n$.UPDATE_ROW:aA(e.options,t);break;case n$.GET:await aP(e.options,t)}return e.outgoingEdgeId},aN=(e,t)=>{let{variables:n,apiHost:a,onNewLog:r,resultId:i}=t;if(!e.cellsToInsert)return void r({status:"warning",description:"Cells to insert are undefined"});(0,o.w$)({url:"".concat(a,"/api/integrations/google-sheets/spreadsheets/").concat(e.spreadsheetId,"/sheets/").concat(e.sheetId),method:"POST",body:{action:n$.INSERT_ROW,credentialsId:e.credentialsId,resultId:i,values:aR(e.cellsToInsert,n)}}).then(e=>{let{error:t}=e;r(ax(t,"Succesfully inserted a row in the sheet","Failed to insert a row in the sheet"))})},aA=(e,t)=>{var n,a,r;let{variables:i,apiHost:l,onNewLog:s,resultId:d}=t;e.cellsToUpsert&&"referenceCell"in e&&(0,o.w$)({url:"".concat(l,"/api/integrations/google-sheets/spreadsheets/").concat(e.spreadsheetId,"/sheets/").concat(e.sheetId),method:"POST",body:{action:n$.UPDATE_ROW,credentialsId:e.credentialsId,values:aR(e.cellsToUpsert,i),resultId:d,referenceCell:{column:null==(n=e.referenceCell)?void 0:n.column,value:n6(i)(null!=(r=null==(a=e.referenceCell)?void 0:a.value)?r:"")}}}).then(e=>{let{error:t}=e;s(ax(t,"Succesfully updated a row in the sheet","Failed to update a row in the sheet"))})},aP=async(e,t)=>{var n,a,r,i,l,s;let{variables:d,updateVariableValue:u,updateVariables:c,apiHost:p,onNewLog:m,resultId:b}=t;if(!e.cellsToExtract)return;let{data:g,error:h}=await (0,o.w$)({url:"".concat(p,"/api/integrations/google-sheets/spreadsheets/").concat(e.spreadsheetId,"/sheets/").concat(e.sheetId),method:"POST",body:{action:n$.GET,credentialsId:e.credentialsId,referenceCell:"referenceCell"in e?{column:null==(n=e.referenceCell)?void 0:n.column,value:n6(d)(null!=(l=null==(a=e.referenceCell)?void 0:a.value)?l:"")}:void 0,filter:e.filter?{comparisons:null==(r=e.filter.comparisons)?void 0:r.map(e=>({...e,value:n6(d)(e.value)})),logicalOperator:null!=(s=null==(i=e.filter)?void 0:i.logicalOperator)?s:"AND"}:void 0,columns:e.cellsToExtract.map(e=>e.column),resultId:b}});m(ax(h,"Succesfully fetched data from sheet","Failed to fetch data from sheet")),g&&c(e.cellsToExtract.reduce((e,t)=>{var n,a;let r=d.find((0,o.$H)(t.variableId)),i=g.rows,l=null!=(a=i[Math.floor(Math.random()*i.length)][null!=(n=t.column)?n:""])?a:null;return r?(u(r.id,l),[...e,{...r,value:l}]):e},[]))},aR=(e,t)=>e.reduce((e,n)=>n.column&&n.value?{...e,[n.column]:n6(t)(n.value)}:e,{}),aj=(e,t)=>{var n,a,r,i,l,s;let{variables:d,apiHost:u,isPreview:c,onNewLog:p,resultId:m,typebotId:b,resultValues:g}=t;if(c)return p({status:"info",description:"Emails are not sent in preview mode"}),e.outgoingEdgeId;let{options:h}=e;return(0,o.w$)({url:"".concat(u,"/api/typebots/").concat(b,"/integrations/email?resultId=").concat(m),method:"POST",body:{credentialsId:null==h?void 0:h.credentialsId,recipients:null==h||null==(n=h.recipients)?void 0:n.map(n6(d)),subject:n6(d)(null!=(r=null==h?void 0:h.subject)?r:""),body:n6(d)(null!=(i=null==h?void 0:h.body)?i:""),cc:(null!=(l=null==h?void 0:h.cc)?l:[]).map(n6(d)),bcc:(null!=(s=null==h?void 0:h.bcc)?s:[]).map(n6(d)),replyTo:(null==h?void 0:h.replyTo)?n6(d)(h.replyTo):void 0,fileUrls:null==(a=d.find((0,o.$H)(null==h?void 0:h.attachmentsVariableId)))?void 0:a.value,isCustomBody:null==h?void 0:h.isCustomBody,isBodyCode:null==h?void 0:h.isBodyCode,resultValues:g}}).then(e=>{let{error:t}=e;p(ax(t,"Succesfully sent an email","Failed to send an email"))}),e.outgoingEdgeId},aL=async(e,t)=>{var n,a;let{blockId:r,variables:i,updateVariableValue:l,updateVariables:s,typebotId:d,apiHost:u,resultValues:c,onNewLog:p,resultId:m,parentTypebotIds:b}=t,g=(0,nQ.stringify)({resultId:m}),{data:h,error:y}=await (0,o.w$)({url:"".concat(u,"/api/typebots/").concat(d,"/blocks/").concat(r,"/executeWebhook?").concat(g),method:"POST",body:{variables:i,resultValues:c,parentTypebotIds:b}}),f=null==h?void 0:h.statusCode.toString(),v=!f||(null==f?void 0:f.startsWith("4"))||(null==f?void 0:f.startsWith("5"));p({status:y?"error":v?"warning":"success",description:v?"Webhook returned an error":"Webhook successfuly executed",details:JSON.stringify(null!=y?y:h,null,2).substring(0,1e3)});let w=null==(a=e.options)||null==(n=a.responseVariableMapping)?void 0:n.reduce((e,t)=>{if(!(null==t?void 0:t.bodyPath)||!t.variableId)return e;let n=i.find((0,o.$H)(t.variableId));if(!n)return e;let a=Function("data","return data.".concat(n6(i)(null==t?void 0:t.bodyPath)));try{let t=a(h);return l(null==n?void 0:n.id,t),[...e,{...n,value:t}]}catch(t){return e}},[]);return w&&s(w),e.outgoingEdgeId},aU=e=>{let{block:t,context:n}=e;switch(t.type){case m.GOOGLE_SHEETS:return ak(t,n);case m.GOOGLE_ANALYTICS:return aS(t,n);case m.ZAPIER:case m.MAKE_COM:case m.PABBLY_CONNECT:case m.HTTP_REQUEST:return aL(t,n);case m.EMAIL:return aj(t,n);case m.CHATWOOT:return aC(t,n);default:return}},aO=(e,t)=>{let{typebot:{variables:n}}=t,a=e.items.find(e=>{var t,a;let{content:r}=e;return(null==r?void 0:r.logicalOperator)===nZ.AND?null==(t=r.comparisons)?void 0:t.every(aV(n)):null==r||null==(a=r.comparisons)?void 0:a.some(aV(n))});return a?a.outgoingEdgeId:e.outgoingEdgeId},aV=e=>t=>{var n,a;if(!(null==t?void 0:t.variableId))return!1;let r=(null!=(a=null==(n=e.find(e=>e.id===t.variableId))?void 0:n.value)?a:"").toString().trim(),i=n6(e)(t.value).trim();return!(0,o.pN)(i)&&!!t.comparisonOperator&&aD(r,t.comparisonOperator,i)},aD=(e,t,n)=>{switch(t){case n0.CONTAINS:return e.toLowerCase().includes(n.toLowerCase());case n0.EQUAL:return e===n;case n0.NOT_EQUAL:return e!==n;case n0.GREATER:return Number.parseFloat(e)>Number.parseFloat(n);case n0.LESS:return Number.parseFloat(e)<Number.parseFloat(n);case n0.IS_SET:return(0,o.O9)(e)&&e.length>0}},aB=(e,t)=>{var n,a;let{typebot:{variables:r}}=t;if(!(null==(n=e.options)?void 0:n.url))return{nextEdgeId:e.outgoingEdgeId};let i=(0,o.Jf)(n6(r)(e.options.url)),l=window.parent&&window.location!==(null==(a=window.top)?void 0:a.location),s=null;if(l){if(!e.options.isNewTab)return window.top.location.href=i,{nextEdgeId:e.outgoingEdgeId};try{s=window.open(i)}catch(e){ai({redirectUrl:i})}}else s=window.open(i,e.options.isNewTab?"_blank":"_self");return{nextEdgeId:e.outgoingEdgeId,blockedPopupUrl:s?void 0:i}},az=async(e,t)=>{var n;let{typebot:{variables:a}}=t;if(null==(n=e.options)?void 0:n.content){if(e.options.shouldExecuteInParentContext&&aE)ai({codeToExecute:n6(a)(e.options.content)});else{let t=Function(...a.map(e=>e.id),n6(a,{fieldToParse:"id"})(e.options.content));try{await t(...a.map(e=>n8(e.value)))}catch(e){console.error(e)}}return e.outgoingEdgeId}},aM=(e,t)=>{var n;let{typebot:{variables:a},updateVariableValue:r,updateVariables:i}=t;if(!(null==(n=e.options)?void 0:n.variableId)||void 0!==e.options.type&&"Custom"!==e.options.type)return e.outgoingEdgeId;let l=e.options.expressionToEvaluate?aH(a)(e.options.expressionToEvaluate):void 0,s=a.find((0,o.$H)(e.options.variableId));return s&&(r(s.id,l),i([{...s,value:l}])),e.outgoingEdgeId},aH=e=>t=>{let n=n6(e,{fieldToParse:"id"})(t.includes("return ")?t:"return ".concat(t));try{return Function(...e.map(e=>e.id),n)(...e.map(e=>n8(e.value)))}catch(n){return n6(e)(t)}},aK=async(e,t)=>{var n,a;let{apiHost:r,injectLinkedTypebot:i,isPreview:l}=t,{data:s,error:d}=l?await (0,o.w$)("/api/typebots/".concat(null==(n=e.options)?void 0:n.typebotId)):await (0,o.w$)("".concat(r,"/api/publicTypebots/").concat(null==(a=e.options)?void 0:a.typebotId));if(!(!s||d))return i(s.typebot)},aG=async(e,t)=>{var n,a,r,o,i;let{typebot:l,linkedTypebots:s,onNewLog:d,createEdge:u,setCurrentTypebotId:c,pushEdgeIdInLinkedTypebotQueue:p,pushParentTypebotId:m,currentTypebotId:b}=t,g=(null==(n=e.options)?void 0:n.typebotId)==="current"?l:null!=(o=[l,...s].find(t=>{var n,a;return"typebotId"in t?t.typebotId===(null==(n=e.options)?void 0:n.typebotId):t.id===(null==(a=e.options)?void 0:a.typebotId)}))?o:await aK(e,t);if(!g)return d({status:"error",description:"Failed to link typebot",details:""}),{nextEdgeId:e.outgoingEdgeId};e.outgoingEdgeId&&p({edgeId:e.outgoingEdgeId,typebotId:b}),m(b),c("typebotId"in g?g.typebotId:g.id);let h=null!=(i=null==(a=e.options)?void 0:a.groupId)?i:null==(r=g.groups.find(e=>e.blocks.some(e=>"start"===e.type)))?void 0:r.id;if(!h)return{nextEdgeId:e.outgoingEdgeId};let y={id:(1e3*Math.random()).toString(),from:{blockId:""},to:{groupId:h}};return u(y),{nextEdgeId:y.id,linkedTypebot:{...g,edges:[...g.edges,y]}}},aW=async(e,t)=>{var n;let{typebot:{variables:a}}=t;if(!(null==(n=e.options)?void 0:n.secondsToWaitFor))return e.outgoingEdgeId;let r=n6(a)(e.options.secondsToWaitFor);return isNaN(r)||await new Promise(e=>setTimeout(e,1e3*Number.parseInt(r,10))),e.outgoingEdgeId},aF=async(e,t)=>{switch(e.type){case b.SET_VARIABLE:return{nextEdgeId:aM(e,t)};case b.CONDITION:return{nextEdgeId:aO(e,t)};case b.REDIRECT:return aB(e,t);case b.SCRIPT:return{nextEdgeId:await az(e,t)};case b.TYPEBOT_LINK:return aG(e,t);case b.WAIT:return{nextEdgeId:await aW(e,t)};default:return{}}},aq=u.forwardRef(function(e,t){let{onChange:n,...a}=e;return(0,r.jsx)("input",{ref:t,className:"focus:outline-none bg-transparent px-4 py-4 flex-1 w-full text-input",type:"text",style:{fontSize:"16px"},autoFocus:!aI,onChange:e=>n(e.target.value),...a})}),aX=e=>(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"19px",color:"white",...e,children:(0,r.jsx)("path",{d:"M476.59 227.05l-.16-.07L49.35 49.84A23.56 23.56 0 0027.14 52 24.65 24.65 0 0016 72.59v113.29a24 24 0 0019.52 23.57l232.93 43.07a4 4 0 010 7.86L35.53 303.45A24 24 0 0016 327v113.31A23.57 23.57 0 0026.59 460a23.94 23.94 0 0013.22 4 24.55 24.55 0 009.52-1.93L476.4 285.94l.19-.09a32 32 0 000-58.8z"})}),aY=e=>{let{label:t,isDisabled:n,isLoading:a,disableIcon:o,...i}=e;return(0,r.jsxs)("button",{type:"submit",disabled:n||a,...i,className:"py-2 px-4 justify-center font-semibold rounded-md text-white focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 typebot-button "+i.className,children:[a&&(0,r.jsx)(aJ,{className:"text-white"}),(0,r.jsx)("span",{className:"xs:flex "+(o?"":"hidden"),children:t}),(0,r.jsx)(aX,{className:"send-icon flex "+(o?"hidden":"xs:hidden")})]})},aJ=e=>(0,r.jsxs)("svg",{...e,className:"animate-spin -ml-1 mr-3 h-5 w-5 "+e.className,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","data-testid":"loading-spinner",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a$=e=>{var t,n,a,o,i,l;let{block:s,onSubmit:d,defaultValue:c,hasGuestAvatar:p}=e,[m,b]=(0,u.useState)(null!=c?c:""),g=(0,u.useRef)(null),h=()=>{var e;return""!==m&&(null==(e=g.current)?void 0:e.reportValidity())},y=()=>{h()&&d({value:m})};return(0,r.jsxs)("div",{className:"flex items-end justify-between rounded-lg pr-2 typebot-input w-full","data-testid":"input",style:{marginRight:p?"50px":"0.5rem",maxWidth:"350px"},onKeyDown:e=>{"Enter"===e.key&&y()},children:[(0,r.jsx)(aq,{ref:g,value:m,placeholder:null!=(i=null==(n=s.options)||null==(t=n.labels)?void 0:t.placeholder)?i:"Type your email...",onChange:e=>b(e),type:"email",autoComplete:"email"}),(0,r.jsx)(aY,{type:"button",label:null!=(l=null==(o=s.options)||null==(a=o.labels)?void 0:a.button)?l:"Send",isDisabled:""===m,className:"my-2 ml-2",onClick:y})]})},aQ=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,aZ=e=>aQ.test(e),a0=e=>{var t,n,a,o,i,l,s;let{block:d,onSubmit:c,defaultValue:p,hasGuestAvatar:m}=e,[b,g]=(0,u.useState)(null!=p?p:""),h=(0,u.useRef)(null),y=()=>{var e;return""!==b&&(null==(e=h.current)?void 0:e.reportValidity())},f=()=>{y()&&c({value:b})};return(0,r.jsxs)("div",{className:"flex items-end justify-between rounded-lg pr-2 typebot-input w-full","data-testid":"input",style:{marginRight:m?"50px":"0.5rem",maxWidth:"350px"},onKeyDown:e=>{"Enter"===e.key&&f()},children:[(0,r.jsx)(n1.Ay,{ref:h,value:b,onChange:e=>g(e),placeholder:null!=(l=null==(n=d.options)||null==(t=n.labels)?void 0:t.placeholder)?l:"Your phone number...",defaultCountry:null==(a=d.options)?void 0:a.defaultCountryCode,autoFocus:!aI}),(0,r.jsx)(aY,{type:"button",label:null!=(s=null==(i=d.options)||null==(o=i.labels)?void 0:o.button)?s:"Send",isDisabled:""===b,className:"my-2 ml-2",onClick:f})]})},a1=e=>(0,n1.h1)(e),a2=e=>{var t,n,a,o,i,l;let{block:s,onSubmit:d,defaultValue:c,hasGuestAvatar:p}=e,[m,b]=(0,u.useState)(null!=c?c:""),g=(0,u.useRef)(null),h=()=>{var e;return""!==m&&(null==(e=g.current)?void 0:e.reportValidity())},y=()=>{h()&&d({value:m})};return(0,r.jsxs)("div",{className:"flex items-end justify-between rounded-lg pr-2 typebot-input w-full","data-testid":"input",style:{marginRight:p?"50px":"0.5rem",maxWidth:"350px"},onKeyDown:e=>{"Enter"===e.key&&y()},children:[(0,r.jsx)(aq,{ref:g,value:m,placeholder:null!=(i=null==(n=s.options)||null==(t=n.labels)?void 0:t.placeholder)?i:"Type your URL...",onChange:e=>{if(!e.startsWith("https://"))return"https:/"===e?void 0:b("https://".concat(e));b(e)},type:"url",autoComplete:"url"}),(0,r.jsx)(aY,{type:"button",label:null!=(l=null==(o=s.options)||null==(a=o.labels)?void 0:a.button)?l:"Send",isDisabled:""===m,className:"my-2 ml-2",onClick:y})]})},a5=/^(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})$/,a3=e=>a5.test(e),a4=(e,t)=>{switch(t){case p.EMAIL:return aZ(e);case p.PHONE:return a1(e);case p.URL:return a3(e)}return!0},a9=e=>nM(e)&&(0,o.O9)(e.options)&&"retryMessageContent"in e.options,a6=(e,t,n,a)=>{var r;let o=n6(n)(null==(r=e.options)?void 0:r.retryMessageContent),i=e.id+1e3*Math.random(),l={id:(1e3*Math.random()).toString(),from:{blockId:i},to:{groupId:t,blockId:e.id}};return a(l),{id:i,type:c.TEXT,content:{html:"<div>".concat(o,"</div>"),richText:[],plainText:o},outgoingEdgeId:l.id}},a7=e=>{let{url:t,onLinkClick:n}=e;return(0,r.jsxs)("div",{className:"w-full max-w-xs p-4 text-gray-500 bg-white rounded-lg shadow flex flex-col gap-2",role:"alert",children:[(0,r.jsx)("span",{className:"mb-1 text-sm font-semibold text-gray-900",children:"Popup blocked"}),(0,r.jsx)("div",{className:"mb-2 text-sm font-normal",children:"The bot wants to open a new tab but it was blocked by your broswer. It needs a manual approval."}),(0,r.jsx)("a",{href:t,target:"_blank",className:"py-1 px-4 justify-center text-sm font-semibold rounded-md text-white focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 typebot-button",rel:"noreferrer",onClick:n,children:"Continue in new tab"})]})},a8=()=>(0,r.jsx)("figure",{className:"flex justify-center items-center rounded-full text-white w-6 h-6 text-sm relative xs:w-10 xs:h-10 xs:text-xl","data-testid":"default-avatar",children:(0,r.jsxs)("svg",{width:"75",height:"75",viewBox:"0 0 75 75",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"absolute top-0 left-0 w-6 h-6 xs:w-full xs:h-full xs:text-xl",children:[(0,r.jsx)("mask",{id:"mask0",x:"0",y:"0","mask-type":"alpha",children:(0,r.jsx)("circle",{cx:"37.5",cy:"37.5",r:"37.5",fill:"#0042DA"})}),(0,r.jsxs)("g",{mask:"url(#mask0)",children:[(0,r.jsx)("rect",{x:"-30",y:"-43",width:"131",height:"154",fill:"#0042DA"}),(0,r.jsx)("rect",{x:"2.50413",y:"120.333",width:"81.5597",height:"86.4577",rx:"2.5",transform:"rotate(-52.6423 2.50413 120.333)",stroke:"#FED23D",strokeWidth:"5"}),(0,r.jsx)("circle",{cx:"76.5",cy:"-1.5",r:"29",stroke:"#FF8E20",strokeWidth:"5"}),(0,r.jsx)("path",{d:"M-49.8224 22L-15.5 -40.7879L18.8224 22H-49.8224Z",stroke:"#F7F8FF",strokeWidth:"5"})]})]})}),re=e=>{let{avatarSrc:t}=e,[n]=(0,u.useState)(t);return""===n?null:(0,o.O9)(n)?(0,r.jsx)("figure",{className:"flex justify-center items-center rounded-full text-white w-6 h-6 text-sm relative xs:w-10 xs:h-10 xs:text-xl",children:(0,r.jsx)("img",{src:n,alt:"Bot avatar",className:"rounded-full object-cover w-full h-full"})}):(0,r.jsx)(a8,{})},rt=(0,u.forwardRef)(function(e,t){let{hostAvatarSrc:n,keepShowing:a}=e,[o,i]=(0,u.useState)(!1),[l,s]=(0,u.useState)(0),d=()=>{if(!c.current||!p.current)return;let{height:e}=c.current.getBoundingClientRect(),{height:t}=p.current.getBoundingClientRect();s(e-t)},c=(0,u.useRef)(null),p=(0,u.useRef)(null);return(0,u.useImperativeHandle)(t,()=>({refreshTopOffset:d})),(0,u.useEffect)(()=>{if(!document)return;i(!0);let e=new n2.tb(d);return e.observe(document.body),()=>{e.disconnect()}},[]),(0,r.jsx)("div",{className:"flex w-6 xs:w-10 mr-2 mb-2 flex-shrink-0 items-center relative typebot-avatar-container ",ref:c,children:(0,r.jsx)(nJ.A,{classNames:"bubble",timeout:500,in:o&&a,unmountOnExit:!0,children:(0,r.jsx)("div",{className:"absolute w-6 xs:w-10 h-6 xs:h-10 mb-4 xs:mb-2 flex items-center top-0",ref:p,style:{top:"".concat(l,"px"),transition:"top 350ms ease-out, opacity 500ms"},children:(0,r.jsx)(re,{avatarSrc:n})})})})}),rn=()=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-2 h-2 mr-1 rounded-full bubble1"}),(0,r.jsx)("div",{className:"w-2 h-2 mr-1 rounded-full bubble2"}),(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bubble3"})]}),ra=e=>{let{url:t,onTransitionEnd:n}=e,{typebot:a,isLoading:o}=ad(),i=(0,u.useRef)(null),[l,s]=(0,u.useState)(!0),[d]=(0,u.useState)(n6(a.variables)(t));return(0,u.useEffect)(()=>{if(!l||o)return;let e=setTimeout(()=>{s(!1),setTimeout(()=>{n()},400)},500);return()=>{clearTimeout(e)}},[o,l,n]),(0,r.jsx)("div",{className:"flex flex-col",children:(0,r.jsx)("div",{className:"flex mb-2 w-full lg:w-11/12 items-center",children:(0,r.jsxs)("div",{className:"flex relative z-10 items-start typebot-host-bubble",children:[(0,r.jsx)("div",{className:"flex items-center absolute px-4 py-2 rounded-lg bubble-typing z-10 ",style:{width:l?"4rem":"100%",height:l?"2rem":"100%"},children:l?(0,r.jsx)(rn,{}):null}),(0,r.jsx)("audio",{ref:i,src:d,className:"z-10 content-opacity m-2 "+(l?"opacity-0":"opacity-100"),style:{height:l?"2rem":"revert"},autoPlay:!0,controls:!0})]})})})},rr=e=>{var t,n;let{block:a,onTransitionEnd:o}=e,{typebot:i,isLoading:l}=ad(),s=(0,u.useRef)(null),[d,c]=(0,u.useState)(!0),[p]=(0,u.useState)(n6(i.variables)(null==(t=a.content)?void 0:t.url)),m=(0,u.useCallback)(()=>{c(!1),setTimeout(()=>{o()},400)},[o]);(0,u.useEffect)(()=>{if(!d||l)return;let e=setTimeout(()=>{c(!1),m()},1e3);return()=>{clearTimeout(e)}},[l,d,m]);let b=(null==(n=a.content)?void 0:n.height)?"string"==typeof a.content.height?n6(i.variables)(a.content.height)+"px":a.content.height:"2rem";return(0,r.jsx)("div",{className:"flex flex-col w-full",ref:s,children:(0,r.jsx)("div",{className:"flex mb-2 w-full lg:w-11/12 items-center",children:(0,r.jsxs)("div",{className:"flex relative z-10 items-start typebot-host-bubble w-full",children:[(0,r.jsx)("div",{className:"flex items-center absolute px-4 py-2 rounded-lg bubble-typing z-10 ",style:{width:d?"4rem":"100%",height:d?"2rem":"100%"},children:d?(0,r.jsx)(rn,{}):null}),(0,r.jsx)("iframe",{id:"embed-bubble-content",src:p,className:"w-full z-20 p-4 content-opacity "+(d?"opacity-0":"opacity-100"),style:{height:d?"2rem":b,borderRadius:"15px"}})]})})})},ro=e=>{var t;let{block:n,onTransitionEnd:a}=e,{typebot:o,isLoading:i}=ad(),l=(0,u.useRef)(null),s=(0,u.useRef)(null),[d,c]=(0,u.useState)(!0),[p]=(0,u.useState)(n6(o.variables)(null==(t=n.content)?void 0:t.url)),m=(0,u.useCallback)(()=>{c(!1),setTimeout(()=>{a()},400)},[a]);return(0,u.useEffect)(()=>{if(!d||i)return;let e=setTimeout(()=>{c(!1),m()},5e3);return()=>{clearTimeout(e)}},[i,d,m]),(0,u.useEffect)(()=>{let e=s.current;if(!(!e||i||!d))return e.onload=()=>{c(!1),m()},()=>{e.onload=null}},[i,d,m]),(0,r.jsx)("div",{className:"flex flex-col",ref:l,children:(0,r.jsx)("div",{className:"flex mb-2 w-full lg:w-11/12 items-center",children:(0,r.jsxs)("div",{className:"flex relative z-10 items-start typebot-host-bubble",children:[(0,r.jsx)("div",{className:"flex items-center absolute px-4 py-2 rounded-lg bubble-typing z-10 ",style:{width:d?"4rem":"100%",height:d?"2rem":"100%"},children:d?(0,r.jsx)(rn,{}):null}),(0,r.jsx)("img",{ref:s,src:p,className:"p-4 content-opacity z-10 w-auto rounded-lg "+(d?"opacity-0":"opacity-100"),style:{maxHeight:"32rem",height:d?"2rem":"auto",maxWidth:"100%"},alt:"Bubble image"})]})})})},ri=e=>{var t,n,a,r,o;let{bubbleContent:l,typingSettings:s}=e,d=null!=(n=null==(t=l.match(/(\w+)/g))?void 0:t.length)?n:0;0===d&&(d=l.length);let{enabled:u,speed:c,maxDelay:p}={enabled:null!=(a=null==s?void 0:s.enabled)?a:i.L6.typingEmulation.enabled,speed:null!=(r=null==s?void 0:s.speed)?r:i.L6.typingEmulation.speed,maxDelay:null!=(o=null==s?void 0:s.maxDelay)?o:i.L6.typingEmulation.maxDelay},m=u?d/c*6e4:0;return m>1e3*p&&(m=1e3*p),m},rl=e=>{var t,n,a;let{block:o,onTransitionEnd:i}=e,{typebot:l,isLoading:s}=ad(),d=(0,u.useRef)(null),[p,m]=(0,u.useState)(!0),[b]=(0,u.useState)(n6(l.variables)(null==(t=o.content)?void 0:t.html)),g=(0,u.useCallback)(()=>{m(!1),setTimeout(()=>{i()},400)},[i]);return(0,u.useEffect)(()=>{var e,t,n;if(!p||s)return;let a=setTimeout(()=>{g()},ri({bubbleContent:null!=(n=null==(e=o.content)?void 0:e.plainText)?n:"",typingSettings:null==(t=l.settings)?void 0:t.typingEmulation}));return()=>{clearTimeout(a)}},[null==(n=o.content)?void 0:n.plainText,s,p,g,null==(a=l.settings)?void 0:a.typingEmulation]),(0,r.jsx)("div",{className:"flex flex-col",ref:d,children:(0,r.jsx)("div",{className:"flex mb-2 w-full items-center",children:(0,r.jsxs)("div",{className:"flex relative items-start typebot-host-bubble",children:[(0,r.jsx)("div",{className:"flex items-center absolute px-4 py-2 rounded-lg bubble-typing ",style:{width:p?"4rem":"100%",height:p?"2rem":"100%"},"data-testid":"host-bubble",children:p?(0,r.jsx)(rn,{}):null}),o.type===c.TEXT&&(0,r.jsx)("p",{style:{textOverflow:"ellipsis"},className:"overflow-hidden content-opacity mx-4 my-2 whitespace-pre-wrap slate-html-container relative "+(p?"opacity-0 h-6":"opacity-100 h-full"),dangerouslySetInnerHTML:{__html:b}})]})})})},rs=e=>{let{block:t,onTransitionEnd:n}=e,{typebot:a,isLoading:o}=ad(),i=(0,u.useRef)(null),[l,s]=(0,u.useState)(!0),d=(0,u.useCallback)(()=>{s(!1),setTimeout(()=>{n()},400)},[n]);return(0,u.useEffect)(()=>{if(!l||o)return;let e=setTimeout(()=>{s(!1),d()},1e3);return()=>{clearTimeout(e)}},[o,l,d]),(0,r.jsx)("div",{className:"flex flex-col",ref:i,children:(0,r.jsx)("div",{className:"flex mb-2 w-full lg:w-11/12 items-center",children:(0,r.jsxs)("div",{className:"flex relative z-10 items-start typebot-host-bubble",children:[(0,r.jsx)("div",{className:"flex items-center absolute px-4 py-2 rounded-lg bubble-typing z-10 ",style:{width:l?"4rem":"100%",height:l?"2rem":"100%"},children:l?(0,r.jsx)(rn,{}):null}),(0,r.jsx)(rd,{content:t.content,isTyping:l,variables:a.variables})]})})})},rd=e=>{let{content:t,isTyping:n,variables:a}=e,[o]=(0,u.useState)(n6(a)(null==t?void 0:t.url));if(!(null==t?void 0:t.type))return null;switch(t.type){case eP.URL:{let e=window.navigator.vendor.match(/apple/i);return(0,r.jsxs)("video",{controls:!0,className:"p-4 focus:outline-none w-full z-10 content-opacity rounded-md "+(n?"opacity-0":"opacity-100"),style:{height:n?"2rem":"auto",maxHeight:e?"40vh":""},autoPlay:!0,children:[(0,r.jsx)("source",{src:o,type:"video/mp4"}),"Sorry, your browser doesn't support embedded videos."]})}case eP.VIMEO:case eP.YOUTUBE:{let e=t.type===eP.VIMEO?"https://player.vimeo.com/video":"https://www.youtube.com/embed";return(0,r.jsx)("iframe",{src:"".concat(e,"/").concat(t.id),className:"w-full p-4 content-opacity z-10 rounded-md "+(n?"opacity-0":"opacity-100"),height:n?"2rem":"200px",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}default:return null}},ru=e=>{let{block:t,onTransitionEnd:n}=e;switch(t.type){case c.TEXT:return(0,r.jsx)(rl,{block:t,onTransitionEnd:n});case c.IMAGE:return(0,r.jsx)(ro,{block:t,onTransitionEnd:n});case c.VIDEO:return(0,r.jsx)(rs,{block:t,onTransitionEnd:n});case c.EMBED:return(0,r.jsx)(rr,{block:t,onTransitionEnd:n});case c.AUDIO:var a;return(0,r.jsx)(ra,{url:null==(a=t.content)?void 0:a.url,onTransitionEnd:n})}},rc=e=>{var t,n;let{block:a,onSubmit:o}=e,{typebot:{variables:i}}=ad(),{resultValues:l}=ar(),[s,d]=(0,u.useState)([]),c=e=>t=>{var n;t.preventDefault(),(null==(n=a.options)?void 0:n.isMultipleChoice)?p(e):o({value:n6(i)(a.items[e].content),itemId:a.items[e].id})},p=e=>{let t=s.indexOf(e);-1!==t?(s.splice(t,1),d([...s])):d([...s,e])},m=l&&0===l.answers.length&&1===a.items.length;return(0,r.jsxs)("form",{className:"flex flex-col items-end",onSubmit:()=>o({value:s.map(e=>n6(i)(a.items[e].content)).join(", ")}),children:[(0,r.jsx)("div",{className:"flex flex-wrap justify-end",children:a.items.map((e,t)=>{var n,o;return(0,r.jsxs)("span",{className:"relative inline-flex ml-2 mb-2",children:[(0,r.jsx)("button",{role:(null==(n=a.options)?void 0:n.isMultipleChoice)?"checkbox":"button",onClick:c(t),className:"py-2 px-4 text-left font-semibold rounded-md transition-all filter hover:brightness-90 active:brightness-75 duration-100 focus:outline-none typebot-button "+(!s.includes(t)&&(null==(o=a.options)?void 0:o.isMultipleChoice)?"selectable":""),"data-testid":"button","data-itemid":e.id,children:n6(i)(e.content)}),m&&(0,r.jsxs)("span",{className:"flex h-3 w-3 absolute top-0 right-0 -mt-1 -mr-1 ping",children:[(0,r.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full brightness-225 opacity-75"}),(0,r.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 brightness-200"})]})]},e.id)})}),(0,r.jsx)("div",{className:"flex",children:s.length>0&&(0,r.jsx)(aY,{label:null!=(n=null==(t=a.options)?void 0:t.buttonLabel)?n:"Send",disableIcon:!0})})]})},rp=e=>{let{from:t,to:n,hasTime:a,isRange:r}=e,o=window.navigator.language,i={day:"2-digit",month:"2-digit",year:"numeric",hour:a?"2-digit":void 0,minute:a?"2-digit":void 0},l=new Date(a?t:t.replace(/-/g,"/")).toLocaleString(o,i),s=new Date(a?n:n.replace(/-/g,"/")).toLocaleString(o,i);return"".concat(l).concat(r?" to ".concat(s):"")},rm=e=>{var t,n,a;let{onSubmit:o,options:i}=e,{hasTime:l,isRange:s,labels:d}=null!=i?i:{},[c,p]=(0,u.useState)({from:"",to:""});return(0,r.jsx)("div",{className:"flex flex-col w-full lg:w-4/6",children:(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)("form",{className:"flex justify-between rounded-lg typebot-input pr-2 items-end",onSubmit:e=>{""===c.from&&""===c.to||(e.preventDefault(),o({value:"".concat(c.from).concat(s?" to ".concat(c.to):""),label:rp({...c,hasTime:l,isRange:s})}))},children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center p-4 "+(s?"pb-0":""),children:[s&&(0,r.jsx)("p",{className:"font-semibold mr-2",children:null!=(t=null==d?void 0:d.from)?t:"From:"}),(0,r.jsx)("input",{className:"focus:outline-none flex-1 w-full text-input",style:{minHeight:"2rem",minWidth:"100px",fontSize:"16px"},type:l?"datetime-local":"date",onChange:e=>p({...c,from:e.target.value}),"data-testid":"from-date"})]}),s&&(0,r.jsxs)("div",{className:"flex items-center p-4",children:[s&&(0,r.jsx)("p",{className:"font-semibold",children:null!=(n=null==d?void 0:d.to)?n:"To:"}),(0,r.jsx)("input",{className:"focus:outline-none flex-1 w-full text-input ml-2",style:{minHeight:"2rem",minWidth:"100px",fontSize:"16px"},type:l?"datetime-local":"date",onChange:e=>p({...c,to:e.target.value}),"data-testid":"to-date"})]})]}),(0,r.jsx)(aY,{label:null!=(a=null==d?void 0:d.button)?a:"Send",isDisabled:""===c.to&&""===c.from,className:"my-2 ml-2"})]})})})},rb=async e=>{let{basePath:t="/api",files:n,onUploadProgress:a}=e,r=[],i=0;for(let{file:e,path:l}of n){a&&a(i/n.length*100),i+=1;let{data:s}=await (0,o.w$)("".concat(t,"/storage/upload-url?filePath=").concat(encodeURIComponent(l),"&fileType=").concat(e.type));if(!(null==s?void 0:s.presignedUrl))continue;let d=s.presignedUrl;if(s.hasReachedStorageLimit)r.push(null);else{if(!(await fetch(d,{method:"PUT",body:e})).ok)continue;r.push(d.split("?")[0])}}return r},rg=e=>{var t,n,a,o;let{block:{id:i,options:l},onSubmit:s,onSkip:d}=e,{isMultipleAllowed:c,labels:p,isRequired:m}=null!=l?l:{},b=l&&"sizeLimit"in l?null==l?void 0:l.sizeLimit:void 0,{isPreview:g,currentTypebotId:h}=ad(),{resultId:y}=ar(),[f,v]=(0,u.useState)([]),[w,I]=(0,u.useState)(!1),[E,x]=(0,u.useState)(0),[_,T]=(0,u.useState)(!1),[C,S]=(0,u.useState)(),k=async e=>{e.target.files&&N(e.target.files)},N=e=>{S(void 0);let t=Array.from(e);return t.some(e=>e.size>(null!=b?b:10)*1048576)?S("A file is larger than ".concat(null!=b?b:10,"MB")):!c&&e?P(t[0]):void v([...f,...t])},A=async e=>{e.preventDefault(),0!==f.length&&R(f)},P=async e=>{var t;if(g)return s({label:"File uploaded",value:"http://fake-upload-url.com"});I(!0);let n=await rb({basePath:"/api/typebots/".concat(h,"/blocks/").concat(i),files:[{file:e,path:"public/results/".concat(y,"/").concat(i,"/").concat(e.name)}]});if(I(!1),n.length)return s({label:"File uploaded",value:null!=(t=n[0])?t:""});S("An error occured while uploading the file")},R=async e=>{if(g)return s({label:"".concat(e.length," file").concat(e.length>1?"s":""," uploaded"),value:e.map((e,t)=>"http://fake-upload-url.com/".concat(t)).join(", ")});I(!0);let t=await rb({basePath:"/api/typebots/".concat(h,"/blocks/").concat(i),files:e.map(e=>({file:e,path:"public/results/".concat(y,"/").concat(i,"/").concat(e.name)})),onUploadProgress:x});if(I(!1),x(0),t.length!==e.length)return S("An error occured while uploading the files");s({label:"".concat(t.length," file").concat(t.length>1?"s":""," uploaded"),value:t.join(", ")})};return(0,r.jsxs)("form",{className:"flex flex-col w-full",onSubmit:A,children:[(0,r.jsx)("label",{htmlFor:"dropzone-file",className:"typebot-upload-input py-6 flex flex-col justify-center items-center w-full bg-gray-50 rounded-lg border-2 border-gray-300 border-dashed cursor-pointer hover:bg-gray-100 px-8 mb-2 "+(_?"dragging-over":""),onDragOver:e=>{e.preventDefault(),T(!0)},onDragLeave:()=>T(!1),onDrop:e=>{e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&N(e.dataTransfer.files)},children:w?1===f.length?(0,r.jsx)(aJ,{}):(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,r.jsx)("div",{className:"upload-progress-bar h-2.5 rounded-full",style:{width:"".concat(E>0?E:10,"%"),transition:"width 150ms cubic-bezier(0.4, 0, 0.2, 1)"}})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[f.length?(0,r.jsxs)("span",{className:"relative",children:[(0,r.jsx)(ry,{}),(0,r.jsx)("div",{className:"total-files-indicator flex items-center justify-center absolute -right-1 rounded-full px-1 h-4",style:{bottom:"5px"},children:f.length})]}):(0,r.jsx)(rh,{}),(0,r.jsx)("p",{className:"text-sm text-gray-500 text-center",dangerouslySetInnerHTML:{__html:null!=(t=null==p?void 0:p.placeholder)?t:""}})]}),(0,r.jsx)("input",{id:"dropzone-file",type:"file",className:"hidden",multiple:c,onChange:k})]})}),0===f.length&&!1===m&&(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{className:"py-2 px-4 justify-center font-semibold rounded-md text-white focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 typebot-button ",onClick:d,children:null!=(n=null==p?void 0:p.skip)?n:n5.labels.skip})}),c&&f.length>0&&!w&&(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsxs)("div",{className:"flex",children:[f.length&&(0,r.jsx)("button",{className:"secondary-button py-2 px-4 justify-center font-semibold rounded-md text-white focus:outline-none flex items-center disabled:opacity-50 disabled:cursor-not-allowed disabled:brightness-100 transition-all filter hover:brightness-90 active:brightness-75 mr-2",onClick:()=>v([]),children:null!=(a=null==p?void 0:p.clear)?a:n5.labels.clear}),(0,r.jsx)(aY,{type:"submit",label:(null==p?void 0:p.button)===n5.labels.button?"".concat(p.button," ").concat(f.length," file").concat(f.length>1?"s":""):null!=(o=null==p?void 0:p.button)?o:"",disableIcon:!0})]})}),C&&(0,r.jsx)("p",{className:"text-red-500 text-sm",children:C})]})},rh=()=>(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mb-3",children:[(0,r.jsx)("polyline",{points:"16 16 12 12 8 16"}),(0,r.jsx)("line",{x1:"12",y1:"12",x2:"12",y2:"21"}),(0,r.jsx)("path",{d:"M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"}),(0,r.jsx)("polyline",{points:"16 16 12 12 8 16"})]}),ry=()=>(0,r.jsxs)("svg",{className:"mb-3",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"}),(0,r.jsx)("polyline",{points:"13 2 13 9 20 9"})]}),rf=e=>{var t,n,a,o,i,l,s,d,c,p;let{block:m,onSubmit:b,defaultValue:g,hasGuestAvatar:h}=e,[y,f]=(0,u.useState)(null!=g?g:""),v=(0,u.useRef)(null),w=()=>{var e;return""!==y&&(null==(e=v.current)?void 0:e.reportValidity())},I=()=>{w()&&b({value:y})};return(0,r.jsxs)("div",{className:"flex items-end justify-between rounded-lg pr-2 typebot-input w-full","data-testid":"input",style:{marginRight:h?"50px":"0.5rem",maxWidth:"350px"},onKeyDown:e=>{"Enter"===e.key&&I()},children:[(0,r.jsx)(aq,{ref:v,value:y,placeholder:null!=(d=null==(n=m.options)||null==(t=n.labels)?void 0:t.placeholder)?d:"Type your answer...",onChange:e=>f(e),type:"number",style:{appearance:"auto"},min:null==(a=m.options)?void 0:a.min,max:null==(o=m.options)?void 0:o.max,step:null!=(c=null==(i=m.options)?void 0:i.step)?c:"any"}),(0,r.jsx)(aY,{type:"button",label:null!=(p=null==(s=m.options)||null==(l=s.labels)?void 0:l.button)?p:"Send",isDisabled:""===y,className:"my-2 ml-2",onClick:I})]})},rv=e=>new Promise(t=>{if(e.getElementById("stripe-script"))return t();let n=e.createElement("script");n.src="https://js.stripe.com/v3",n.id="stripe-script",e.body.appendChild(n),n.onload=()=>{t()}}),rw=e=>{let{apiHost:t,isPreview:n,inputOptions:a,variables:r}=e;return(0,o.w$)({url:"".concat(t,"/api/integrations/stripe/createPaymentIntent"),method:"POST",body:{inputOptions:a,isPreview:n,variables:r}})},rI=e=>{let{options:t,onSuccess:n}=e,{apiHost:a,isPreview:o,typebot:{variables:i},onNewLog:l}=ad(),[s,d]=(0,u.useState)(null),[c,p]=(0,u.useState)(""),[m,b]=(0,u.useState)("");return(0,u.useEffect)(()=>{(async()=>{var e;let{data:n,error:r}=await rw({apiHost:a,isPreview:o,variables:i,inputOptions:t});if(r)return l({status:"error",description:r.name+" "+r.message,details:r.message});!n||!document||(await rv(document),(null==(e=window)?void 0:e.Stripe)&&(d(window.Stripe(n.publicKey)),p(n.clientSecret),b(n.amountLabel)))})()},[]),s&&c?(0,r.jsx)(n4.Elements,{stripe:s,options:{clientSecret:c},children:(0,r.jsx)(rE,{onSuccess:n,clientSecret:c,amountLabel:m,options:t,variables:i,viewerHost:a})}):(0,r.jsx)(aJ,{className:"text-blue-500"})},rE=e=>{var t;let{onSuccess:n,clientSecret:a,amountLabel:o,options:i,variables:l,viewerHost:s}=e,{scroll:d}=aw(),[c,p]=(0,u.useState)(!0),m=(0,n4.useStripe)(),b=(0,n4.useElements)(),[g,h]=(0,u.useState)(),[y,f]=(0,u.useState)(!1),[v,w]=(0,u.useState)(!1);return(0,u.useEffect)(()=>{if(!(!m||!a)){if(c)return p(!1);m.retrievePaymentIntent(a).then(e=>{let{paymentIntent:t}=e;switch(null==t?void 0:t.status){case"succeeded":h("Payment succeeded!");break;case"processing":h("Your payment is processing.");break;case"requires_payment_method":h("Your payment was not successful, please try again.");break;default:h("Something went wrong.")}})}},[m,a]),(0,r.jsxs)("form",{id:"payment-form",onSubmit:async e=>{var t,a,r,o,d;if(e.preventDefault(),!m||!b)return;f(!0);let{error:u,paymentIntent:c}=await m.confirmPayment({elements:b,confirmParams:{return_url:s,payment_method_data:{billing_details:{name:(null==i||null==(t=i.additionalInformation)?void 0:t.name)?n6(l)(i.additionalInformation.name):void 0,email:(null==i||null==(a=i.additionalInformation)?void 0:a.email)?n6(l)(null==(r=i.additionalInformation)?void 0:r.email):void 0,phone:(null==i||null==(o=i.additionalInformation)?void 0:o.phoneNumber)?n6(l)(null==(d=i.additionalInformation)?void 0:d.phoneNumber):void 0}}},redirect:"if_required"});if(f(!1),(null==u?void 0:u.type)!=="validation_error"){if((null==u?void 0:u.type)==="card_error")return h(u.message);if(!u&&"succeeded"===c.status)return n()}},className:"flex flex-col rounded-lg p-4 typebot-input w-full items-center",children:[(0,r.jsx)(n4.PaymentElement,{id:"payment-element",className:"w-full",onReady:()=>{w(!0),d()}}),v&&(0,r.jsx)(aY,{label:"".concat(null==i||null==(t=i.labels)?void 0:t.button," ").concat(o),isDisabled:y||!m||!b,isLoading:y,className:"mt-4 w-full max-w-lg",disableIcon:!0}),g&&(0,r.jsx)("div",{id:"payment-message",className:"typebot-input-error-message mt-4 text-center",children:g})]})},rx=e=>{let{onSuccess:t,options:n}=e;switch(null==n?void 0:n.provider){case void 0:case n3.STRIPE:return(0,r.jsx)(rI,{onSuccess:t,options:n})}},r_=e=>{var t,n,a,i,l,s,d,c,p,m;let{block:b,onSubmit:g}=e,[h,y]=(0,u.useState)(),f=e=>{var t;(null==(t=b.options)?void 0:t.isOneClickSubmitEnabled)&&g({value:e.toString()}),y(e)};return(0,r.jsxs)("form",{className:"flex flex-col",onSubmit:e=>{e.preventDefault(),(0,o.pN)(h)||g({value:h.toString()})},children:[(null==(n=b.options)||null==(t=n.labels)?void 0:t.left)&&(0,r.jsx)("span",{className:"text-sm w-full mb-2 rating-label",children:b.options.labels.left}),(0,r.jsx)("div",{className:"flex flex-wrap justify-center",children:Array.from(Array((null!=(p=null==(a=b.options)?void 0:a.length)?p:n9.length)+ +((null==(i=b.options)?void 0:i.buttonType)==="Numbers"))).map((e,t)=>{var n;return(0,u.createElement)(rT,{...b.options,key:t,rating:h,idx:t+ +((null==(n=b.options)?void 0:n.buttonType)!=="Numbers"),onClick:f})})}),(null==(s=b.options)||null==(l=s.labels)?void 0:l.right)&&(0,r.jsx)("span",{className:"text-sm w-full text-right mb-2 pr-2 rating-label",children:b.options.labels.right}),(0,r.jsx)("div",{className:"flex justify-end mr-2",children:(0,o.O9)(h)&&(0,r.jsx)(aY,{label:null!=(m=null==(c=b.options)||null==(d=c.labels)?void 0:d.button)?m:"Send",disableIcon:!0})})]})},rT=e=>{let{rating:t,idx:n,buttonType:a,customIcon:i,onClick:l}=e;return"Numbers"===a?(0,r.jsx)("button",{onClick:e=>{e.preventDefault(),l(n)},className:"py-2 px-4 mr-2 mb-2 text-left font-semibold rounded-md transition-all filter hover:brightness-90 active:brightness-75 duration-100 focus:outline-none typebot-button "+((0,o.O9)(t)&&n<=t?"":"selectable"),children:n}):(0,r.jsx)("div",{className:"flex justify-center items-center rating-icon-container cursor-pointer mr-2 mb-2 "+((0,o.O9)(t)&&n<=t?"selected":""),onClick:()=>l(n),dangerouslySetInnerHTML:{__html:(null==i?void 0:i.isEnabled)&&!(0,o.Im)(i.svg)?i.svg:rC}})},rC='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>',rS=u.forwardRef(function(e,t){let{onChange:n,...a}=e;return(0,r.jsx)("textarea",{ref:t,className:"focus:outline-none bg-transparent px-4 py-4 flex-1 w-full text-input",rows:6,"data-testid":"textarea",required:!0,style:{fontSize:"16px"},autoFocus:!aI,onChange:e=>n(e.target.value),...a})}),rk=e=>{var t,n,a,o,i,l,s,d,c,p;let{block:m,onSubmit:b,defaultValue:g,hasGuestAvatar:h}=e,[y,f]=(0,u.useState)(null!=g?g:""),v=(0,u.useRef)(null),w=null==(t=m.options)?void 0:t.isLong,I=e=>f(e),E=()=>{var e;return""!==y&&(null==(e=v.current)?void 0:e.reportValidity())},x=()=>{E()&&b({value:y})};return(0,r.jsxs)("div",{className:"flex items-end justify-between rounded-lg pr-2 typebot-input w-full","data-testid":"input",style:{marginRight:h?"50px":"0.5rem",maxWidth:w?void 0:"350px"},onKeyDown:e=>{w||"Enter"===e.key&&x()},children:[w?(0,r.jsx)(rS,{ref:v,onChange:I,value:y,placeholder:null!=(d=null==(a=m.options)||null==(n=a.labels)?void 0:n.placeholder)?d:"Type your answer..."}):(0,r.jsx)(aq,{ref:v,onChange:I,value:y,placeholder:null!=(c=null==(i=m.options)||null==(o=i.labels)?void 0:o.placeholder)?c:"Type your answer..."}),(0,r.jsx)(aY,{type:"button",label:null!=(p=null==(s=m.options)||null==(l=s.labels)?void 0:l.button)?p:"Send",isDisabled:""===y,className:"my-2 ml-2",onClick:x})]})},rN=e=>{let{message:t,showAvatar:n,avatarSrc:a}=e,[o]=(0,u.useState)(t);return(0,r.jsx)(nJ.A,{classNames:"bubble",timeout:1e3,children:(0,r.jsxs)("div",{className:"flex justify-end mb-2 items-end",style:{marginLeft:"50px"},children:[(0,r.jsx)("span",{className:"px-4 py-2 rounded-lg mr-2 whitespace-pre-wrap max-w-full typebot-guest-bubble cursor-pointer","data-testid":"guest-bubble",children:o}),n&&(0,r.jsx)(re,{avatarSrc:a})]})})},rA=e=>{var t,n,a,l,s,d,c,m,b;let{block:g,hasAvatar:h,hasGuestAvatar:y,onTransitionEnd:f,onSkip:v}=e,{typebot:w,isLoading:I}=ad(),{addAnswer:E}=ar(),[x,_]=(0,u.useState)(),[T,C]=(0,u.useState)(!1),{variableId:S}=null!=(a=g.options)?a:{},k=(null!=(l=null==(t=w.settings.general)?void 0:t.isInputPrefillEnabled)?l:i.L6.general.isInputPrefillEnabled)&&S?null==(n=w.variables.find(e=>{var t;return e.name===(null==(t=w.variables.find((0,o.$H)(S)))?void 0:t.name)}))?void 0:n.value:void 0,N=async e=>{let{label:t,value:n,itemId:a}=e;_(null!=t?t:n);let r=!a4(n,g.type);if(!r&&E){let{group:e}=nX(g.id,w.groups);await E(w.variables)({blockId:g.id,groupId:e.id,content:n,variableId:S,uploadedFiles:g.type===p.FILE})}T||f({label:t,value:n,itemId:a},r),C(!1)};if(I)return null;if(x){let e=null==(d=w.theme.chat)||null==(s=d.guestAvatar)?void 0:s.url;return(0,r.jsx)(rN,{message:x,showAvatar:null!=(b=null==(m=w.theme.chat)||null==(c=m.guestAvatar)?void 0:c.isEnabled)&&b,avatarSrc:e&&n6(w.variables)(e)})}return(0,r.jsxs)("div",{className:"flex justify-end",children:[h&&(0,r.jsx)("div",{className:"flex w-6 xs:w-10 h-6 xs:h-10 mr-2 mb-2 mt-1 flex-shrink-0 items-center"}),(0,r.jsx)(rP,{block:g,onSubmit:N,onSkip:v,defaultValue:null==k?void 0:k.toString(),hasGuestAvatar:y})]})},rP=e=>{let{block:t,onSubmit:n,onSkip:a,defaultValue:o,hasGuestAvatar:i}=e;switch(t.type){case p.TEXT:return(0,r.jsx)(rk,{block:t,onSubmit:n,defaultValue:o,hasGuestAvatar:i});case p.NUMBER:return(0,r.jsx)(rf,{block:t,onSubmit:n,defaultValue:o,hasGuestAvatar:i});case p.EMAIL:return(0,r.jsx)(a$,{block:t,onSubmit:n,defaultValue:o,hasGuestAvatar:i});case p.URL:return(0,r.jsx)(a2,{block:t,onSubmit:n,defaultValue:o,hasGuestAvatar:i});case p.PHONE:return(0,r.jsx)(a0,{block:t,onSubmit:n,defaultValue:o,hasGuestAvatar:i});case p.DATE:return(0,r.jsx)(rm,{options:t.options,onSubmit:n});case p.CHOICE:return(0,r.jsx)(rc,{block:t,onSubmit:n});case p.PAYMENT:return(0,r.jsx)(rx,{options:t.options,onSuccess:()=>{var e,a,r;return n({value:null!=(r=null==(a=t.options)||null==(e=a.labels)?void 0:e.success)?r:"Success"})}});case p.RATING:return(0,r.jsx)(r_,{block:t,onSubmit:n});case p.FILE:return(0,r.jsx)(rg,{block:t,onSubmit:n,onSkip:a});default:return null}},rR=e=>{var t,n;let{blocks:a,startBlockIndex:i,groupTitle:l,onGroupEnd:s,keepShowingHostAvatar:d}=e,{currentTypebotId:c,typebot:p,updateVariableValue:m,createEdge:g,apiHost:h,isPreview:y,parentTypebotIds:f,onNewLog:v,injectLinkedTypebot:w,linkedTypebots:I,setCurrentTypebotId:E,pushEdgeIdInLinkedTypebotQueue:x,pushParentTypebotId:_}=ad(),{resultValues:T,updateVariables:C,resultId:S}=ar(),{scroll:k}=aw(),[N,A]=(0,u.useState)([]),[P,R]=(0,u.useState)([]),[j,L]=(0,u.useState)(),U=e=>{if(A([...N,e]),nH(e)){let t=ao(N);t&&nF(t)?R(P.map((t,n)=>n===P.length-1?{bubbles:[...t.bubbles,e]}:t)):R([...P,{bubbles:[e]}])}nM(e)&&(0===P.length||(0,o.O9)(P[P.length-1].input)?R([...P,{bubbles:[],input:e}]):R(P.map((t,n)=>n===P.length-1?{...t,input:e}:t)))};(0,u.useEffect)(()=>{let e=a[i];e&&U(e)},[]),(0,u.useEffect)(()=>{k(),O()},[N]);let O=async()=>{let e=[...N].pop();if(e){if(nK(e)){var t;let{nextEdgeId:n,linkedTypebot:a,blockedPopupUrl:r}=await aF(e,{isPreview:y,apiHost:h,typebot:p,linkedTypebots:I,updateVariableValue:m,updateVariables:C,injectLinkedTypebot:w,onNewLog:v,createEdge:g,setCurrentTypebotId:E,pushEdgeIdInLinkedTypebotQueue:x,currentTypebotId:c,pushParentTypebotId:_});if(r&&L(r),e.type===b.REDIRECT&&(null==(t=e.options)?void 0:t.isNewTab)===!1)return;n?s({edgeId:n,updatedTypebot:a}):V()}if(nW(e)){let{group:t}=nX(e.id,p.groups),n=await aU({block:e,context:{apiHost:h,typebotId:c,groupId:t.id,blockId:e.id,variables:p.variables,isPreview:y,updateVariableValue:m,updateVariables:C,resultValues:T,groups:p.groups,onNewLog:v,resultId:S,parentTypebotIds:f}});n?s({edgeId:n}):V()}"start"===e.type&&s({edgeId:e.outgoingEdgeId})}},V=(e,t)=>{k();let n=[...N].pop();if(n){var r,l,d;if(t&&a9(n)){let{group:e}=nX(n.id,p.groups);return U(a6(n,e.id,p.variables,g))}if(nM(n)&&(null==(r=n.options)?void 0:r.variableId)&&e&&m(n.options.variableId,e.value),nG(n)&&!(null==(l=n.options)?void 0:l.isMultipleChoice)){let t=null==(d=n.items.find((0,o.$H)(null==e?void 0:e.itemId)))?void 0:d.outgoingEdgeId;if(t)return s({edgeId:t})}if((null==n?void 0:n.outgoingEdgeId)||N.length===a.length)return s({edgeId:n.outgoingEdgeId})}let u=a[N.length+i];u?U(u):s({})},D=null==(n=p.theme.chat)||null==(t=n.hostAvatar)?void 0:t.url;return(0,r.jsx)("div",{className:"flex w-full","data-group-name":l,children:(0,r.jsx)("div",{className:"flex flex-col w-full min-w-0",children:P.map((e,t)=>{var n,a,o,i,l,s;return(0,r.jsx)(rj,{displayChunk:e,hostAvatar:{isEnabled:null==(l=null==(a=p.theme.chat)||null==(n=a.hostAvatar)?void 0:n.isEnabled)||l,src:D&&n6(p.variables)(D)},hasGuestAvatar:null!=(s=null==(i=p.theme.chat)||null==(o=i.guestAvatar)?void 0:o.isEnabled)&&s,onDisplayNextBlock:V,keepShowingHostAvatar:d,blockedPopupUrl:j,onBlockedPopupLinkClick:()=>L(void 0)},t)})})})},rj=e=>{let{displayChunk:{bubbles:t,input:n},hostAvatar:a,hasGuestAvatar:i,keepShowingHostAvatar:l,blockedPopupUrl:s,onBlockedPopupLinkClick:d,onDisplayNextBlock:c}=e,[p,m]=(0,u.useState)(!1),b=(0,u.useRef)();(0,u.useEffect)(()=>{g()});let g=()=>{var e;return null==(e=b.current)?void 0:e.refreshTopOffset()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex",children:[a.isEnabled&&t.length>0&&(0,r.jsx)(rt,{ref:b,hostAvatarSrc:a.src,keepShowing:(l||(0,o.O9)(n))&&!p}),(0,r.jsx)("div",{className:"flex-1",style:{marginRight:i?"50px":"0.5rem"},children:(0,r.jsx)(nY.A,{children:t.map(e=>(0,r.jsx)(nJ.A,{classNames:"bubble",timeout:500,unmountOnExit:!0,children:(0,r.jsx)(ru,{block:e,onTransitionEnd:()=>{c(),g()}})},e.id))})})]}),!p&&(0,r.jsx)(nJ.A,{classNames:"bubble",timeout:500,unmountOnExit:!0,in:(0,o.O9)(n),children:n?(0,r.jsx)(rA,{block:n,onTransitionEnd:c,onSkip:()=>{c(),m(!0)},hasAvatar:a.isEnabled,hasGuestAvatar:i}):(0,r.jsx)("div",{})}),s?(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(a7,{url:s,onLinkClick:d})}):null]})},rL=e=>{let{theme:t,predefinedVariables:n,startGroupId:a,onNewGroupVisible:i,onCompleted:l}=e,{typebot:s,updateVariableValue:d,linkedBotQueue:c,popEdgeIdFromLinkedTypebotQueue:p}=ad(),[m,b]=(0,u.useState)([]),{updateVariables:g}=ar(),h=(0,u.useRef)(null),y=(0,u.useRef)(null),[f,v]=(0,u.useState)(!1),w=e=>{let{edgeId:t,updatedTypebot:n,groupId:a}=e,r=null!=n?n:s;if(a){let e=r.groups.find((0,o.$H)(a));return e?(i({id:"edgeId",from:{blockId:"block"},to:{groupId:a}}),b([...m,{group:e,startBlockIndex:0}])):void 0}let d=r.edges.find((0,o.$H)(t));if(!d){if(c.length>0){let e=c[0].edgeId;p(),w({edgeId:e})}return l()}let u=r.groups.find((0,o.$H)(d.to.groupId));if(!u)return l();let g=d.to.blockId?u.blocks.findIndex((0,o.$H)(d.to.blockId)):0;i(d),b([...m,{group:u,startBlockIndex:-1===g?0:g}])};(0,u.useEffect)(()=>{if(f)return;(0,o.O9)(n)&&Object.keys(n).length>0&&g(I(n)),v(!0);let e=s.groups[0].blocks[0].outgoingEdgeId;(e||a)&&w({edgeId:a?void 0:e,groupId:a})},[n]);let I=e=>{let t=[];return Object.keys(e).forEach(n=>{let a=s.variables.find(e=>e.name.toLowerCase()===n.toLowerCase());if(!e||(0,o.pN)(a))return;let r=e[n];r&&(d(null==a?void 0:a.id,r),t.push({...a,value:r}))}),t};return(0,u.useEffect)(()=>{document&&ac(t,document.body.style)},[t]),(0,r.jsxs)("div",{ref:y,className:"overflow-y-scroll w-full lg:w-3/4 min-h-full rounded lg:px-5 px-3 pt-10 relative scrollable-container typebot-chat-view",children:[(0,r.jsx)(av,{onScroll:()=>{y.current&&setTimeout(()=>{nq.Nk.scrollToBottom({duration:500,container:y.current})},1)},children:m.map((e,t)=>{let n=m[t+1],a=n&&nM(n.group.blocks[n.startBlockIndex]);return(0,r.jsx)(rR,{blocks:e.group.blocks,startBlockIndex:e.startBlockIndex,onGroupEnd:w,groupTitle:e.group.title,keepShowingHostAvatar:t===m.length-1||a},e.group.id+t)})}),(0,r.jsx)("div",{className:"w-full h-32",ref:h})]})},rU=()=>{let e=(0,u.useRef)(null);return(0,u.useEffect)(()=>{if(!document)return;let t=document.querySelector('[data-testid="container"]'),n=new MutationObserver(n=>{n.forEach(n=>{n.removedNodes.forEach(n=>{"lite-badge"===n.id&&t.append(e.current)})})});return n.observe(t,{subtree:!1,childList:!0}),()=>{n.disconnect()}},[]),(0,r.jsxs)("a",{ref:e,href:"https://www.typebot.io/?utm_source=litebadge",target:"_blank",rel:"noopener noreferrer",className:"fixed py-1 px-2 bg-white z-50 rounded shadow-md lite-badge",style:{bottom:"20px"},id:"lite-badge",children:["Made with ",(0,r.jsx)("span",{className:"text-blue-500",children:"Typebot"}),"."]})},rO=e=>{var t,n,a,o,i,l,c,p;let{typebot:m,apiHost:b=s._.NEXT_PUBLIC_VIEWER_URL[0],isPreview:g=!1,isLoading:h=!1,resultId:y,startGroupId:f,predefinedVariables:v,onNewLog:w,onNewGroupVisible:I,onNewAnswer:E,onCompleted:x,onVariablesUpdated:_}=e,T=(0,u.useMemo)(()=>{var e,t,n;return(null==m||null==(n=m.theme)||null==(t=n.general)||null==(e=t.background)?void 0:e.type)===d.hK.COLOR?m.theme.general.background.content:"transparent"},[null==m||null==(n=m.theme)||null==(t=n.general)?void 0:t.background]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("style",{children:['/* CSS variables. */\n:root {\n  --PhoneInput-color--focus: #03b2cb;\n  --PhoneInputInternationalIconPhone-opacity: 0.8;\n  --PhoneInputInternationalIconGlobe-opacity: 0.65;\n  --PhoneInputCountrySelect-marginRight: 0.35em;\n  --PhoneInputCountrySelectArrow-width: 0.3em;\n  --PhoneInputCountrySelectArrow-marginLeft: var(\n    --PhoneInputCountrySelect-marginRight\n  );\n  --PhoneInputCountrySelectArrow-borderWidth: 1px;\n  --PhoneInputCountrySelectArrow-opacity: 0.45;\n  --PhoneInputCountrySelectArrow-color: currentColor;\n  --PhoneInputCountrySelectArrow-color--focus: var(--PhoneInput-color--focus);\n  --PhoneInputCountrySelectArrow-transform: rotate(45deg);\n  --PhoneInputCountryFlag-aspectRatio: 1.5;\n  --PhoneInputCountryFlag-height: 1em;\n  --PhoneInputCountryFlag-borderWidth: 1px;\n  --PhoneInputCountryFlag-borderColor: rgba(0, 0, 0, 0.5);\n  --PhoneInputCountryFlag-borderColor--focus: var(--PhoneInput-color--focus);\n  --PhoneInputCountryFlag-backgroundColor--loading: rgba(0, 0, 0, 0.1);\n}\n\n.PhoneInput {\n  /* This is done to stretch the contents of this component. */\n  display: flex;\n  align-items: center;\n}\n\n.PhoneInputInput {\n  /* The phone number input stretches to fill all empty space */\n  flex: 1;\n  /* The phone number input should shrink\n	   to make room for the extension input */\n  min-width: 0;\n}\n\n.PhoneInputCountryIcon {\n  width: calc(\n    var(--PhoneInputCountryFlag-height) *\n    var(--PhoneInputCountryFlag-aspectRatio)\n  );\n  height: var(--PhoneInputCountryFlag-height);\n}\n\n.PhoneInputCountryIcon--square {\n  width: var(--PhoneInputCountryFlag-height);\n}\n\n.PhoneInputCountryIcon--border {\n  /* Removed `background-color` because when an `<img/>` was still loading\n	   it would show a dark gray rectangle. */\n  /* For some reason the `<img/>` is not stretched to 100% width and height\n	   and sometime there can be seen white pixels of the background at top and bottom. */\n  background-color: var(--PhoneInputCountryFlag-backgroundColor--loading);\n  /* Border is added via `box-shadow` because `border` interferes with `width`/`height`. */\n  /* For some reason the `<img/>` is not stretched to 100% width and height\n	   and sometime there can be seen white pixels of the background at top and bottom,\n	   so an additional "inset" border is added. */\n  box-shadow:\n    0 0 0 var(--PhoneInputCountryFlag-borderWidth)\n    var(--PhoneInputCountryFlag-borderColor),\n    inset 0 0 0 var(--PhoneInputCountryFlag-borderWidth)\n    var(--PhoneInputCountryFlag-borderColor);\n}\n\n.PhoneInputCountryIconImg {\n  /* Fixes weird vertical space above the flag icon. */\n  /* https://gitlab.com/catamphetamine/react-phone-number-input/-/issues/7#note_348586559 */\n  display: block;\n  /* 3rd party <SVG/> flag icons won\'t stretch if they have `width` and `height`.\n	   Also, if an <SVG/> icon\'s aspect ratio was different, it wouldn\'t fit too. */\n  width: 100%;\n  height: 100%;\n}\n\n.PhoneInputInternationalIconPhone {\n  opacity: var(--PhoneInputInternationalIconPhone-opacity);\n}\n\n.PhoneInputInternationalIconGlobe {\n  opacity: var(--PhoneInputInternationalIconGlobe-opacity);\n}\n\n/* Styling native country `<select/>`. */\n\n.PhoneInputCountry {\n  position: relative;\n  align-self: stretch;\n  display: flex;\n  align-items: center;\n  margin-right: var(--PhoneInputCountrySelect-marginRight);\n}\n\n.PhoneInputCountrySelect {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n  z-index: 1;\n  border: 0;\n  opacity: 0;\n  cursor: pointer;\n}\n\n.PhoneInputCountrySelect[disabled],\n.PhoneInputCountrySelect[readonly] {\n  cursor: default;\n}\n\n.PhoneInputCountrySelectArrow {\n  display: block;\n  content: "";\n  width: var(--PhoneInputCountrySelectArrow-width);\n  height: var(--PhoneInputCountrySelectArrow-width);\n  margin-left: var(--PhoneInputCountrySelectArrow-marginLeft);\n  border-style: solid;\n  border-color: var(--PhoneInputCountrySelectArrow-color);\n  border-top-width: 0;\n  border-bottom-width: var(--PhoneInputCountrySelectArrow-borderWidth);\n  border-left-width: 0;\n  border-right-width: var(--PhoneInputCountrySelectArrow-borderWidth);\n  transform: var(--PhoneInputCountrySelectArrow-transform);\n  opacity: var(--PhoneInputCountrySelectArrow-opacity);\n}\n\n.PhoneInputCountrySelect:focus\n  + .PhoneInputCountryIcon\n  + .PhoneInputCountrySelectArrow {\n  opacity: 1;\n  color: var(--PhoneInputCountrySelectArrow-color--focus);\n}\n\n.PhoneInputCountrySelect:focus + .PhoneInputCountryIcon--border {\n  box-shadow:\n    0 0 0 var(--PhoneInputCountryFlag-borderWidth)\n    var(--PhoneInputCountryFlag-borderColor--focus),\n    inset 0 0 0 var(--PhoneInputCountryFlag-borderWidth)\n    var(--PhoneInputCountryFlag-borderColor--focus);\n}\n\n.PhoneInputCountrySelect:focus\n  + .PhoneInputCountryIcon\n  .PhoneInputInternationalIconGlobe {\n  opacity: 1;\n  color: var(--PhoneInputCountrySelectArrow-color--focus);\n}\n\n.PhoneInputInput {\n  padding: 1rem 0.5rem;\n  outline: none;\n  background: transparent;\n  flex: 1 1 0%;\n  width: 100%;\n  font-size: 16px;\n}\n\n.PhoneInputCountry {\n  padding-left: 0.5rem;\n}\n\n.PhoneInputCountryIcon,\n.PhoneInputCountryIconImg {\n  border-radius: 3px;\n}\n\ninput.PhoneInputInput::-moz-placeholder {\n  color: var(--typebot-input-placeholder-color);\n}\n\ninput.PhoneInputInput::placeholder {\n  color: var(--typebot-input-placeholder-color);\n}\n',"*, ::before, ::after {\n  --tw-border-spacing-x: 0;\n  --tw-border-spacing-y: 0;\n  --tw-translate-x: 0;\n  --tw-translate-y: 0;\n  --tw-rotate: 0;\n  --tw-skew-x: 0;\n  --tw-skew-y: 0;\n  --tw-scale-x: 1;\n  --tw-scale-y: 1;\n  --tw-pan-x:  ;\n  --tw-pan-y:  ;\n  --tw-pinch-zoom:  ;\n  --tw-scroll-snap-strictness: proximity;\n  --tw-gradient-from-position:  ;\n  --tw-gradient-via-position:  ;\n  --tw-gradient-to-position:  ;\n  --tw-ordinal:  ;\n  --tw-slashed-zero:  ;\n  --tw-numeric-figure:  ;\n  --tw-numeric-spacing:  ;\n  --tw-numeric-fraction:  ;\n  --tw-ring-inset:  ;\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: rgb(59 130 246 / 0.5);\n  --tw-ring-offset-shadow: 0 0 #0000;\n  --tw-ring-shadow: 0 0 #0000;\n  --tw-shadow: 0 0 #0000;\n  --tw-shadow-colored: 0 0 #0000;\n  --tw-blur:  ;\n  --tw-brightness:  ;\n  --tw-contrast:  ;\n  --tw-grayscale:  ;\n  --tw-hue-rotate:  ;\n  --tw-invert:  ;\n  --tw-saturate:  ;\n  --tw-sepia:  ;\n  --tw-drop-shadow:  ;\n  --tw-backdrop-blur:  ;\n  --tw-backdrop-brightness:  ;\n  --tw-backdrop-contrast:  ;\n  --tw-backdrop-grayscale:  ;\n  --tw-backdrop-hue-rotate:  ;\n  --tw-backdrop-invert:  ;\n  --tw-backdrop-opacity:  ;\n  --tw-backdrop-saturate:  ;\n  --tw-backdrop-sepia:  ;\n  --tw-contain-size:  ;\n  --tw-contain-layout:  ;\n  --tw-contain-paint:  ;\n  --tw-contain-style:  ;\n}\n\n::backdrop {\n  --tw-border-spacing-x: 0;\n  --tw-border-spacing-y: 0;\n  --tw-translate-x: 0;\n  --tw-translate-y: 0;\n  --tw-rotate: 0;\n  --tw-skew-x: 0;\n  --tw-skew-y: 0;\n  --tw-scale-x: 1;\n  --tw-scale-y: 1;\n  --tw-pan-x:  ;\n  --tw-pan-y:  ;\n  --tw-pinch-zoom:  ;\n  --tw-scroll-snap-strictness: proximity;\n  --tw-gradient-from-position:  ;\n  --tw-gradient-via-position:  ;\n  --tw-gradient-to-position:  ;\n  --tw-ordinal:  ;\n  --tw-slashed-zero:  ;\n  --tw-numeric-figure:  ;\n  --tw-numeric-spacing:  ;\n  --tw-numeric-fraction:  ;\n  --tw-ring-inset:  ;\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: rgb(59 130 246 / 0.5);\n  --tw-ring-offset-shadow: 0 0 #0000;\n  --tw-ring-shadow: 0 0 #0000;\n  --tw-shadow: 0 0 #0000;\n  --tw-shadow-colored: 0 0 #0000;\n  --tw-blur:  ;\n  --tw-brightness:  ;\n  --tw-contrast:  ;\n  --tw-grayscale:  ;\n  --tw-hue-rotate:  ;\n  --tw-invert:  ;\n  --tw-saturate:  ;\n  --tw-sepia:  ;\n  --tw-drop-shadow:  ;\n  --tw-backdrop-blur:  ;\n  --tw-backdrop-brightness:  ;\n  --tw-backdrop-contrast:  ;\n  --tw-backdrop-grayscale:  ;\n  --tw-backdrop-hue-rotate:  ;\n  --tw-backdrop-invert:  ;\n  --tw-backdrop-opacity:  ;\n  --tw-backdrop-saturate:  ;\n  --tw-backdrop-sepia:  ;\n  --tw-contain-size:  ;\n  --tw-contain-layout:  ;\n  --tw-contain-paint:  ;\n  --tw-contain-style:  ;\n}/*\n! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com\n*//*\n1. Prevent padding and border from affecting element width. (https://github.com/mozdevs/cssremedy/issues/4)\n2. Allow adding a border to an element by just adding a border-width. (https://github.com/tailwindcss/tailwindcss/pull/116)\n*/\n\n*,\n::before,\n::after {\n  box-sizing: border-box; /* 1 */\n  border-width: 0; /* 2 */\n  border-style: solid; /* 2 */\n  border-color: #e5e7eb; /* 2 */\n}\n\n::before,\n::after {\n  --tw-content: '';\n}\n\n/*\n1. Use a consistent sensible line-height in all browsers.\n2. Prevent adjustments of font size after orientation changes in iOS.\n3. Use a more readable tab size.\n4. Use the user's configured `sans` font-family by default.\n5. Use the user's configured `sans` font-feature-settings by default.\n6. Use the user's configured `sans` font-variation-settings by default.\n7. Disable tap highlights on iOS\n*/\n\nhtml,\n:host {\n  line-height: 1.5; /* 1 */\n  -webkit-text-size-adjust: 100%; /* 2 */\n  -moz-tab-size: 4; /* 3 */\n  -o-tab-size: 4;\n     tab-size: 4; /* 3 */\n  font-family: ui-sans-serif, system-ui, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\", \"Noto Color Emoji\"; /* 4 */\n  font-feature-settings: normal; /* 5 */\n  font-variation-settings: normal; /* 6 */\n  -webkit-tap-highlight-color: transparent; /* 7 */\n}\n\n/*\n1. Remove the margin in all browsers.\n2. Inherit line-height from `html` so users can set them as a class directly on the `html` element.\n*/\n\nbody {\n  margin: 0; /* 1 */\n  line-height: inherit; /* 2 */\n}\n\n/*\n1. Add the correct height in Firefox.\n2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)\n3. Ensure horizontal rules are visible by default.\n*/\n\nhr {\n  height: 0; /* 1 */\n  color: inherit; /* 2 */\n  border-top-width: 1px; /* 3 */\n}\n\n/*\nAdd the correct text decoration in Chrome, Edge, and Safari.\n*/\n\nabbr:where([title]) {\n  -webkit-text-decoration: underline dotted;\n          text-decoration: underline dotted;\n}\n\n/*\nRemove the default font size and weight for headings.\n*/\n\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  font-size: inherit;\n  font-weight: inherit;\n}\n\n/*\nReset links to optimize for opt-in styling instead of opt-out.\n*/\n\na {\n  color: inherit;\n  text-decoration: inherit;\n}\n\n/*\nAdd the correct font weight in Edge and Safari.\n*/\n\nb,\nstrong {\n  font-weight: bolder;\n}\n\n/*\n1. Use the user's configured `mono` font-family by default.\n2. Use the user's configured `mono` font-feature-settings by default.\n3. Use the user's configured `mono` font-variation-settings by default.\n4. Correct the odd `em` font sizing in all browsers.\n*/\n\ncode,\nkbd,\nsamp,\npre {\n  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, \"Liberation Mono\", \"Courier New\", monospace; /* 1 */\n  font-feature-settings: normal; /* 2 */\n  font-variation-settings: normal; /* 3 */\n  font-size: 1em; /* 4 */\n}\n\n/*\nAdd the correct font size in all browsers.\n*/\n\nsmall {\n  font-size: 80%;\n}\n\n/*\nPrevent `sub` and `sup` elements from affecting the line height in all browsers.\n*/\n\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\n\nsub {\n  bottom: -0.25em;\n}\n\nsup {\n  top: -0.5em;\n}\n\n/*\n1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)\n2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)\n3. Remove gaps between table borders by default.\n*/\n\ntable {\n  text-indent: 0; /* 1 */\n  border-color: inherit; /* 2 */\n  border-collapse: collapse; /* 3 */\n}\n\n/*\n1. Change the font styles in all browsers.\n2. Remove the margin in Firefox and Safari.\n3. Remove default padding in all browsers.\n*/\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  font-family: inherit; /* 1 */\n  font-feature-settings: inherit; /* 1 */\n  font-variation-settings: inherit; /* 1 */\n  font-size: 100%; /* 1 */\n  font-weight: inherit; /* 1 */\n  line-height: inherit; /* 1 */\n  letter-spacing: inherit; /* 1 */\n  color: inherit; /* 1 */\n  margin: 0; /* 2 */\n  padding: 0; /* 3 */\n}\n\n/*\nRemove the inheritance of text transform in Edge and Firefox.\n*/\n\nbutton,\nselect {\n  text-transform: none;\n}\n\n/*\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Remove default button styles.\n*/\n\nbutton,\ninput:where([type='button']),\ninput:where([type='reset']),\ninput:where([type='submit']) {\n  -webkit-appearance: button; /* 1 */\n  background-color: transparent; /* 2 */\n  background-image: none; /* 2 */\n}\n\n/*\nUse the modern Firefox focus style for all focusable elements.\n*/\n\n:-moz-focusring {\n  outline: auto;\n}\n\n/*\nRemove the additional `:invalid` styles in Firefox. (https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737)\n*/\n\n:-moz-ui-invalid {\n  box-shadow: none;\n}\n\n/*\nAdd the correct vertical alignment in Chrome and Firefox.\n*/\n\nprogress {\n  vertical-align: baseline;\n}\n\n/*\nCorrect the cursor style of increment and decrement buttons in Safari.\n*/\n\n::-webkit-inner-spin-button,\n::-webkit-outer-spin-button {\n  height: auto;\n}\n\n/*\n1. Correct the odd appearance in Chrome and Safari.\n2. Correct the outline style in Safari.\n*/\n\n[type='search'] {\n  -webkit-appearance: textfield; /* 1 */\n  outline-offset: -2px; /* 2 */\n}\n\n/*\nRemove the inner padding in Chrome and Safari on macOS.\n*/\n\n::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n\n/*\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Change font properties to `inherit` in Safari.\n*/\n\n::-webkit-file-upload-button {\n  -webkit-appearance: button; /* 1 */\n  font: inherit; /* 2 */\n}\n\n/*\nAdd the correct display in Chrome and Safari.\n*/\n\nsummary {\n  display: list-item;\n}\n\n/*\nRemoves the default spacing and border for appropriate elements.\n*/\n\nblockquote,\ndl,\ndd,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6,\nhr,\nfigure,\np,\npre {\n  margin: 0;\n}\n\nfieldset {\n  margin: 0;\n  padding: 0;\n}\n\nlegend {\n  padding: 0;\n}\n\nol,\nul,\nmenu {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n\n/*\nReset default styling for dialogs.\n*/\ndialog {\n  padding: 0;\n}\n\n/*\nPrevent resizing textareas horizontally by default.\n*/\n\ntextarea {\n  resize: vertical;\n}\n\n/*\n1. Reset the default placeholder opacity in Firefox. (https://github.com/tailwindlabs/tailwindcss/issues/3300)\n2. Set the default placeholder color to the user's configured gray 400 color.\n*/\n\ninput::-moz-placeholder, textarea::-moz-placeholder {\n  opacity: 1; /* 1 */\n  color: #9ca3af; /* 2 */\n}\n\ninput::placeholder,\ntextarea::placeholder {\n  opacity: 1; /* 1 */\n  color: #9ca3af; /* 2 */\n}\n\n/*\nSet the default cursor for buttons.\n*/\n\nbutton,\n[role=\"button\"] {\n  cursor: pointer;\n}\n\n/*\nMake sure disabled buttons don't get the pointer cursor.\n*/\n:disabled {\n  cursor: default;\n}\n\n/*\n1. Make replaced elements `display: block` by default. (https://github.com/mozdevs/cssremedy/issues/14)\n2. Add `vertical-align: middle` to align replaced elements more sensibly by default. (https://github.com/jensimmons/cssremedy/issues/14#issuecomment-634934210)\n   This can trigger a poorly considered lint error in some tools but is included by design.\n*/\n\nimg,\nsvg,\nvideo,\ncanvas,\naudio,\niframe,\nembed,\nobject {\n  display: block; /* 1 */\n  vertical-align: middle; /* 2 */\n}\n\n/*\nConstrain images and videos to the parent width and preserve their intrinsic aspect ratio. (https://github.com/mozdevs/cssremedy/issues/14)\n*/\n\nimg,\nvideo {\n  max-width: 100%;\n  height: auto;\n}\n\n/* Make elements with the HTML hidden attribute stay hidden by default */\n[hidden]:where(:not([hidden=\"until-found\"])) {\n  display: none;\n}\n.container {\n  width: 100%;\n}\n@media (min-width: 400px) {\n\n  .container {\n    max-width: 400px;\n  }\n}\n@media (min-width: 640px) {\n\n  .container {\n    max-width: 640px;\n  }\n}\n@media (min-width: 768px) {\n\n  .container {\n    max-width: 768px;\n  }\n}\n@media (min-width: 1024px) {\n\n  .container {\n    max-width: 1024px;\n  }\n}\n@media (min-width: 1280px) {\n\n  .container {\n    max-width: 1280px;\n  }\n}\n@media (min-width: 1536px) {\n\n  .container {\n    max-width: 1536px;\n  }\n}\n.fixed {\n  position: fixed;\n}\n.absolute {\n  position: absolute;\n}\n.relative {\n  position: relative;\n}\n.-right-1 {\n  right: -0.25rem;\n}\n.left-0 {\n  left: 0px;\n}\n.right-0 {\n  right: 0px;\n}\n.top-0 {\n  top: 0px;\n}\n.z-10 {\n  z-index: 10;\n}\n.z-20 {\n  z-index: 20;\n}\n.z-50 {\n  z-index: 50;\n}\n.m-2 {\n  margin: 0.5rem;\n}\n.mx-4 {\n  margin-left: 1rem;\n  margin-right: 1rem;\n}\n.my-2 {\n  margin-top: 0.5rem;\n  margin-bottom: 0.5rem;\n}\n.-ml-1 {\n  margin-left: -0.25rem;\n}\n.-mr-1 {\n  margin-right: -0.25rem;\n}\n.-mt-1 {\n  margin-top: -0.25rem;\n}\n.mb-1 {\n  margin-bottom: 0.25rem;\n}\n.mb-2 {\n  margin-bottom: 0.5rem;\n}\n.mb-3 {\n  margin-bottom: 0.75rem;\n}\n.mb-4 {\n  margin-bottom: 1rem;\n}\n.ml-2 {\n  margin-left: 0.5rem;\n}\n.mr-1 {\n  margin-right: 0.25rem;\n}\n.mr-2 {\n  margin-right: 0.5rem;\n}\n.mr-3 {\n  margin-right: 0.75rem;\n}\n.mt-1 {\n  margin-top: 0.25rem;\n}\n.mt-4 {\n  margin-top: 1rem;\n}\n.\\!block {\n  display: block !important;\n}\n.block {\n  display: block;\n}\n.inline {\n  display: inline;\n}\n.flex {\n  display: flex;\n}\n.inline-flex {\n  display: inline-flex;\n}\n.hidden {\n  display: none;\n}\n.h-2 {\n  height: 0.5rem;\n}\n.h-2\\.5 {\n  height: 0.625rem;\n}\n.h-3 {\n  height: 0.75rem;\n}\n.h-32 {\n  height: 8rem;\n}\n.h-4 {\n  height: 1rem;\n}\n.h-5 {\n  height: 1.25rem;\n}\n.h-6 {\n  height: 1.5rem;\n}\n.h-full {\n  height: 100%;\n}\n.h-screen {\n  height: 100vh;\n}\n.min-h-full {\n  min-height: 100%;\n}\n.w-2 {\n  width: 0.5rem;\n}\n.w-3 {\n  width: 0.75rem;\n}\n.w-5 {\n  width: 1.25rem;\n}\n.w-6 {\n  width: 1.5rem;\n}\n.w-auto {\n  width: auto;\n}\n.w-full {\n  width: 100%;\n}\n.w-screen {\n  width: 100vw;\n}\n.min-w-0 {\n  min-width: 0px;\n}\n.max-w-full {\n  max-width: 100%;\n}\n.max-w-lg {\n  max-width: 32rem;\n}\n.max-w-xs {\n  max-width: 20rem;\n}\n.flex-1 {\n  flex: 1 1 0%;\n}\n.flex-shrink-0 {\n  flex-shrink: 0;\n}\n.transform {\n  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n}\n@keyframes ping {\n\n  75%, 100% {\n    transform: scale(2);\n    opacity: 0;\n  }\n}\n.animate-ping {\n  animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;\n}\n@keyframes spin {\n\n  to {\n    transform: rotate(360deg);\n  }\n}\n.animate-spin {\n  animation: spin 1s linear infinite;\n}\n.cursor-pointer {\n  cursor: pointer;\n}\n.flex-col {\n  flex-direction: column;\n}\n.flex-wrap {\n  flex-wrap: wrap;\n}\n.items-start {\n  align-items: flex-start;\n}\n.items-end {\n  align-items: flex-end;\n}\n.items-center {\n  align-items: center;\n}\n.justify-end {\n  justify-content: flex-end;\n}\n.justify-center {\n  justify-content: center;\n}\n.justify-between {\n  justify-content: space-between;\n}\n.gap-2 {\n  gap: 0.5rem;\n}\n.overflow-hidden {\n  overflow: hidden;\n}\n.overflow-y-scroll {\n  overflow-y: scroll;\n}\n.whitespace-pre-wrap {\n  white-space: pre-wrap;\n}\n.rounded {\n  border-radius: 0.25rem;\n}\n.rounded-full {\n  border-radius: 9999px;\n}\n.rounded-lg {\n  border-radius: 0.5rem;\n}\n.rounded-md {\n  border-radius: 0.375rem;\n}\n.border-2 {\n  border-width: 2px;\n}\n.border-dashed {\n  border-style: dashed;\n}\n.border-gray-300 {\n  --tw-border-opacity: 1;\n  border-color: rgb(209 213 219 / var(--tw-border-opacity, 1));\n}\n.bg-gray-200 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(229 231 235 / var(--tw-bg-opacity, 1));\n}\n.bg-gray-50 {\n  --tw-bg-opacity: 1;\n  background-color: rgb(249 250 251 / var(--tw-bg-opacity, 1));\n}\n.bg-transparent {\n  background-color: transparent;\n}\n.bg-white {\n  --tw-bg-opacity: 1;\n  background-color: rgb(255 255 255 / var(--tw-bg-opacity, 1));\n}\n.bg-cover {\n  background-size: cover;\n}\n.object-cover {\n  -o-object-fit: cover;\n     object-fit: cover;\n}\n.p-4 {\n  padding: 1rem;\n}\n.px-1 {\n  padding-left: 0.25rem;\n  padding-right: 0.25rem;\n}\n.px-2 {\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n}\n.px-3 {\n  padding-left: 0.75rem;\n  padding-right: 0.75rem;\n}\n.px-4 {\n  padding-left: 1rem;\n  padding-right: 1rem;\n}\n.px-8 {\n  padding-left: 2rem;\n  padding-right: 2rem;\n}\n.py-1 {\n  padding-top: 0.25rem;\n  padding-bottom: 0.25rem;\n}\n.py-2 {\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n.py-4 {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n}\n.py-6 {\n  padding-top: 1.5rem;\n  padding-bottom: 1.5rem;\n}\n.pb-0 {\n  padding-bottom: 0px;\n}\n.pr-2 {\n  padding-right: 0.5rem;\n}\n.pt-10 {\n  padding-top: 2.5rem;\n}\n.text-left {\n  text-align: left;\n}\n.text-center {\n  text-align: center;\n}\n.text-right {\n  text-align: right;\n}\n.text-base {\n  font-size: 1rem;\n  line-height: 1.5rem;\n}\n.text-sm {\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n}\n.font-normal {\n  font-weight: 400;\n}\n.font-semibold {\n  font-weight: 600;\n}\n.text-blue-500 {\n  --tw-text-opacity: 1;\n  color: rgb(59 130 246 / var(--tw-text-opacity, 1));\n}\n.text-gray-500 {\n  --tw-text-opacity: 1;\n  color: rgb(107 114 128 / var(--tw-text-opacity, 1));\n}\n.text-gray-900 {\n  --tw-text-opacity: 1;\n  color: rgb(17 24 39 / var(--tw-text-opacity, 1));\n}\n.text-red-500 {\n  --tw-text-opacity: 1;\n  color: rgb(239 68 68 / var(--tw-text-opacity, 1));\n}\n.text-white {\n  --tw-text-opacity: 1;\n  color: rgb(255 255 255 / var(--tw-text-opacity, 1));\n}\n.opacity-0 {\n  opacity: 0;\n}\n.opacity-100 {\n  opacity: 1;\n}\n.opacity-25 {\n  opacity: 0.25;\n}\n.opacity-75 {\n  opacity: 0.75;\n}\n.shadow {\n  --tw-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.shadow-md {\n  --tw-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);\n  --tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);\n}\n.brightness-200 {\n  --tw-brightness: brightness(2);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.brightness-225 {\n  --tw-brightness: brightness(2.25);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.filter {\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n.transition {\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n.transition-all {\n  transition-property: all;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n.duration-100 {\n  transition-duration: 100ms;\n}\n\n:root {\n  --typebot-container-bg-image: none;\n  --typebot-container-bg-color: transparent;\n  --typebot-container-font-family: \"Open Sans\";\n\n  --typebot-button-bg-color: #0042da;\n  --typebot-button-color: #ffffff;\n\n  --typebot-host-bubble-bg-color: #f7f8ff;\n  --typebot-host-bubble-color: #303235;\n\n  --typebot-guest-bubble-bg-color: #ff8e21;\n  --typebot-guest-bubble-color: #ffffff;\n\n  --typebot-input-bg-color: #ffffff;\n  --typebot-input-color: #303235;\n  --typebot-input-placeholder-color: #9095a0;\n\n  --typebot-header-bg-color: #ffffff;\n  --typebot-header-color: #303235;\n\n  /* Phone input */\n  --PhoneInputCountryFlag-borderColor: transparent;\n  --PhoneInput-color--focus: transparent;\n}\n\n/* Hide scrollbar for Chrome, Safari and Opera */\n.scrollable-container::-webkit-scrollbar {\n  display: none;\n}\n\n/* Hide scrollbar for IE, Edge and Firefox */\n.scrollable-container {\n  -ms-overflow-style: none; /* IE and Edge */\n  scrollbar-width: none; /* Firefox */\n}\n\n/* Transitions */\n.bubble-enter {\n  opacity: 0;\n}\n.bubble-enter-active {\n  opacity: 1;\n  transition-property: opacity;\n  transition-duration: 500ms;\n  transition-timing-function: ease-out;\n}\n.bubble-exit {\n  opacity: 1;\n}\n.bubble-exit-active {\n  opacity: 0;\n  transition-delay: 0ms;\n  transition-property: opacity;\n  transition-duration: 400ms;\n  transition-timing-function: ease-out;\n}\n\n.bubble-typing {\n  transition:\n    width 400ms ease-out,\n    height 400ms ease-out;\n}\n\n.content-opacity {\n  transition: opacity 400ms ease-in 200ms;\n}\n\n.bubble1,\n.bubble2,\n.bubble3 {\n  background-color: var(--typebot-host-bubble-color);\n  opacity: 0.5;\n}\n\n.bubble1 {\n  animation: chatBubbles 1s ease-in-out infinite;\n}\n\n.bubble2 {\n  animation: chatBubbles 1s ease-in-out infinite;\n  animation-delay: 0.3s;\n}\n\n.bubble3 {\n  animation: chatBubbles 1s ease-in-out infinite;\n  animation-delay: 0.5s;\n}\n\n@keyframes chatBubbles {\n  0% {\n    transform: translateY(0);\n  }\n  50% {\n    transform: translateY(-5px);\n  }\n  100% {\n    transform: translateY(0);\n  }\n}\n\nbutton,\ninput,\ntextarea {\n  font-weight: 300;\n}\n\n.slate-a {\n  text-decoration: underline;\n}\n\n.slate-html-container > div {\n  min-height: 24px;\n}\n\n.slate-bold {\n  font-weight: bold;\n}\n\n.slate-italic {\n  font-style: oblique;\n}\n\n.slate-underline {\n  text-decoration: underline;\n}\n.text-input::-moz-placeholder {\n  color: var(--typebot-input-placeholder-color);\n  opacity: 1;\n}\n.text-input::placeholder {\n  color: var(--typebot-input-placeholder-color);\n  opacity: 1;\n}\n\n.typebot-container {\n  background-image: var(--typebot-container-bg-image);\n  background-color: var(--typebot-container-bg-color);\n  font-family: var(--typebot-container-font-family);\n}\n\n.custom-header {\n  color: var(--typebot-header-color);\n  background-color: var(--typebot-header-bg-color);\n}\n\n.typebot-button {\n  color: var(--typebot-button-color);\n  background-color: var(--typebot-button-bg-color);\n  border: 1px solid var(--typebot-button-bg-color);\n}\n\n.typebot-button.selectable {\n  color: var(--typebot-host-bubble-color);\n  background-color: var(--typebot-host-bubble-bg-color);\n  border: 1px solid var(--typebot-button-bg-color);\n}\n\n.typebot-host-bubble {\n  color: var(--typebot-host-bubble-color);\n}\n\n.typebot-host-bubble > .bubble-typing {\n  background-color: var(--typebot-host-bubble-bg-color);\n  border: var(--typebot-host-bubble-border);\n}\n\n.typebot-guest-bubble {\n  color: var(--typebot-guest-bubble-color);\n  background-color: var(--typebot-guest-bubble-bg-color);\n}\n\n.typebot-input {\n  color: var(--typebot-input-color);\n  background-color: var(--typebot-input-bg-color);\n  box-shadow: 0 2px 6px -1px rgba(0, 0, 0, 0.1);\n}\n\n.typebot-input-error-message {\n  color: var(--typebot-input-color);\n}\n\n.typebot-button > .send-icon {\n  fill: var(--typebot-button-color);\n}\n\n.typebot-chat-view {\n  max-width: 800px;\n}\n\n.ping span {\n  background-color: var(--typebot-button-bg-color);\n}\n\n.rating-icon-container svg {\n  width: 42px;\n  height: 42px;\n  stroke: var(--typebot-button-bg-color);\n  fill: var(--typebot-host-bubble-bg-color);\n  transition: fill 100ms ease-out;\n}\n\n.rating-icon-container.selected svg {\n  fill: var(--typebot-button-bg-color);\n}\n\n.rating-icon-container:hover svg {\n  filter: brightness(0.9);\n}\n\n.rating-icon-container:active svg {\n  filter: brightness(0.75);\n}\n\n.upload-progress-bar {\n  background-color: var(--typebot-button-bg-color);\n}\n\n.total-files-indicator {\n  background-color: var(--typebot-button-bg-color);\n  color: var(--typebot-button-color);\n  font-size: 10px;\n}\n\n.typebot-upload-input {\n  transition: border-color 100ms ease-out;\n}\n\n.typebot-upload-input.dragging-over {\n  border-color: var(--typebot-button-bg-color);\n}\n\n.secondary-button {\n  background-color: var(--typebot-host-bubble-bg-color);\n  color: var(--typebot-host-bubble-color);\n}\n\n.hover\\:bg-gray-100:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgb(243 244 246 / var(--tw-bg-opacity, 1));\n}\n\n.hover\\:brightness-90:hover {\n  --tw-brightness: brightness(.9);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n\n.focus\\:outline-none:focus {\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n}\n\n.active\\:brightness-75:active {\n  --tw-brightness: brightness(.75);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n\n.disabled\\:cursor-not-allowed:disabled {\n  cursor: not-allowed;\n}\n\n.disabled\\:opacity-50:disabled {\n  opacity: 0.5;\n}\n\n.disabled\\:brightness-100:disabled {\n  --tw-brightness: brightness(1);\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n\n@media (min-width: 400px) {\n\n  .xs\\:mb-2 {\n    margin-bottom: 0.5rem;\n  }\n\n  .xs\\:flex {\n    display: flex;\n  }\n\n  .xs\\:hidden {\n    display: none;\n  }\n\n  .xs\\:h-10 {\n    height: 2.5rem;\n  }\n\n  .xs\\:h-full {\n    height: 100%;\n  }\n\n  .xs\\:w-10 {\n    width: 2.5rem;\n  }\n\n  .xs\\:w-full {\n    width: 100%;\n  }\n\n  .xs\\:text-xl {\n    font-size: 1.25rem;\n    line-height: 1.75rem;\n  }\n}\n\n@media (min-width: 1024px) {\n\n  .lg\\:w-11\\/12 {\n    width: 91.666667%;\n  }\n\n  .lg\\:w-3\\/4 {\n    width: 75%;\n  }\n\n  .lg\\:w-4\\/6 {\n    width: 66.666667%;\n  }\n\n  .lg\\:px-5 {\n    padding-left: 1.25rem;\n    padding-right: 1.25rem;\n  }\n}\n"]}),(0,r.jsx)("style",{children:null==(a=m.theme)?void 0:a.customCss}),(0,r.jsx)("style",{children:".lite-badge {\n  display: block;\n}\n"}),(null==m||null==(i=m.theme)||null==(o=i.general)?void 0:o.font)&&(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:"@import url('https://fonts.googleapis.com/css2?family=".concat(null!=(p=null==(l=m.theme.general)?void 0:l.font)?p:"Open Sans",":ital,wght@0,300;0,400;0,600;1,300;1,400;1,600&display=swap');")}}),(0,r.jsx)(as,{typebot:m,apiHost:b,isPreview:g,onNewLog:e=>w&&w(e),isLoading:h,children:(0,r.jsx)(aa,{resultId:y,onNewAnswer:e=>E&&E(e),onVariablesUpdated:_,children:(0,r.jsxs)("div",{className:"flex text-base overflow-hidden bg-cover h-screen w-screen flex-col items-center typebot-container",style:{backgroundColor:null!=T?T:"transparent"},"data-testid":"container",children:[(0,r.jsx)("div",{className:"flex w-full h-full justify-center",children:(0,r.jsx)(rL,{theme:m.theme,onNewGroupVisible:e=>I&&I(e),onCompleted:()=>x&&x(),predefinedVariables:v,startGroupId:f})}),(null==(c=m.settings.general)?void 0:c.isBrandingEnabled)&&(0,r.jsx)(rU,{})]})})})]})},rV=n(81278);let rD=async e=>(0,o.w$)({url:"/api/typebots/t/results/r/answers",method:"PUT",body:e}),rB=async e=>(0,o.w$)({url:"/api/typebots/".concat(e,"/results"),method:"POST"}),rz=async(e,t)=>(0,o.w$)({url:"/api/typebots/t/results/".concat(e),method:"PATCH",body:t}),rM="resultId",rH=()=>{try{return sessionStorage.getItem(rM)}catch(e){}},rK=e=>{try{return sessionStorage.setItem(rM,e)}catch(e){}};var rG=n(51511),rW=n(59393),rF=n(98965);let rq=e=>{let{publishedTypebot:t,isIE:n,url:a,customHeadCode:l}=e,{asPath:s,push:d}=(0,rV.useRouter)(),[c,p]=(0,u.useState)(!1),[m,b]=(0,u.useState)(),[g,h]=(0,u.useState)(n?Error("Internet explorer is not supported"):void 0),[y,f]=(0,u.useState)(),[v,w]=(0,u.useState)([]),[I,E]=(0,u.useState)(!1);(0,u.useEffect)(()=>{var e;p(!0);let n=new URLSearchParams(location.search);x();let a={};n.forEach((e,t)=>{a[t]=e}),b(a),_().then(),(0,o.O9)(l)&&(0,o._C)(l);let r=null==(e=t.settings.metadata)?void 0:e.googleTagManagerId;(0,o.hj)(r)&&document.body.prepend((0,rG.f)(r))},[]);let x=()=>{var e,n;s.includes("?")&&(null!=(n=null==(e=t.settings.general)?void 0:e.isHideQueryParamsEnabled)?n:i.L6.general.isHideQueryParamsEnabled)!==!1&&d(s.split("?")[0],void 0,{shallow:!0})},_=async()=>{let e=rH();if(e)f(e);else{let{error:e,data:a}=await rB(t.typebotId);if(e)return h(e);if(null==a?void 0:a.hasReachedLimit)return h(Error("This bot is now closed."));if(null==a?void 0:a.result){var n;f(a.result.id),(null==(n=t.settings.general)?void 0:n.isNewResultOnRefreshEnabled)!==!0&&rK(a.result.id)}}};(0,u.useEffect)(()=>{y&&0!==v.length&&(Promise.all(v.map(C(y))).then(),w([]))},[y]);let T=async e=>{if(!y)return w([...v,e]);await C(y)(e)},C=e=>async t=>{let{error:n}=await rz(e,{variables:t});n&&h(n)},S=async e=>{if(!y)return h(Error("Error: result was not created"));let{error:t}=await rD({...e,resultId:y});t&&h(t),I||rz(y,{hasStarted:!0}).then(e=>{let{error:t}=e;return t?h(t):E(!0)})},k=async()=>{if(!y)return h(Error("Error: result was not created"));let{error:e}=await rz(y,{isCompleted:!0});e&&h(e)};return g?(0,r.jsx)(rW.M,{error:g}):(0,r.jsxs)("div",{style:{height:"100dvh"},children:[(0,r.jsx)(rF.k,{url:a,typebotName:t.typebot.name,metadata:t.settings.metadata}),c&&(0,r.jsx)(rO,{typebot:t,resultId:y,predefinedVariables:m,onNewAnswer:S,onCompleted:k,onVariablesUpdated:T,isLoading:(0,o.pN)(y)})]})}},2283:(e,t,n)=>{"use strict";n.d(t,{$H:()=>s,Im:()=>i,Jf:()=>u,O9:()=>r,_C:()=>c,hj:()=>l,pN:()=>o,w$:()=>a});let a=async e=>{let t;try{let n="string"==typeof e?e:e.url;t=await fetch(n,{method:"string"==typeof e?"GET":e.method,mode:"cors",headers:"string"!=typeof e&&r(e.body)?{"Content-Type":"application/json"}:void 0,body:"string"!=typeof e&&r(e.body)?JSON.stringify(e.body):void 0});let a=await t.json();if(!t.ok)throw"error"in a?a.error:a;return{data:a,response:t}}catch(e){return console.error(e),{error:e,response:t}}},r=e=>null!=e,o=e=>null==e,i=e=>null==e||""===e,l=e=>null!=e&&""!==e,s=e=>t=>t.id===e,d=e=>/^\{\{.*\}\}/.test(e),u=e=>e.startsWith("http")||e.startsWith("mailto:")||e.startsWith("tel:")||e.startsWith("sms:")||d(e)?e:"https://".concat(e),c=e=>{e.split("</noscript>").forEach(e=>{let[t,n]=e.split("<noscript>"),a=document.createRange().createContextualFragment(null!=t?t:"");if(document.head.append(a),o(n))return;let r=document.createElement("noscript"),i=document.createRange().createContextualFragment(n);r.append(i),document.head.append(r)})}},3735:(e,t,n)=>{"use strict";n.d(t,{_:()=>L});var a,r=n(79616),o=n(31078);n(29143);let i=(e,t)=>{var n;return window.__ENV?null!=(n=window.__ENV[e])?n:t:void 0};var l=n(29143);let s=o.z.enum(["true","false"]).transform(e=>"true"===e),d={server:{NODE_ENV:o.z.enum(["development","staging","production","test"]).optional(),DATABASE_URL:o.z.string().url().refine(e=>e.startsWith("postgres")||e.startsWith("mysql")),ENCRYPTION_SECRET:o.z.string().length(32),NEXTAUTH_URL:o.z.preprocess(e=>e&&"string"==typeof e&&e.length>0||"preview"!==l.env.VERCEL_ENV||!l.env.VERCEL_BUILDER_PROJECT_NAME||!l.env.NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME?e:l.env.VERCEL_BRANCH_URL.includes(l.env.VERCEL_BUILDER_PROJECT_NAME)?"https://".concat(l.env.VERCEL_BRANCH_URL):"https://".concat(l.env.VERCEL_BRANCH_URL).replace(l.env.NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME,l.env.VERCEL_BUILDER_PROJECT_NAME),o.z.string().url()),DISABLE_SIGNUP:s.optional().default("false"),ADMIN_EMAIL:o.z.string().min(1).optional().transform(e=>null==e?void 0:e.split(",")),DEFAULT_WORKSPACE_PLAN:o.z.enum(["FREE","STARTER","PRO","LIFETIME","UNLIMITED"]).refine(e=>["FREE","STARTER","PRO","LIFETIME","UNLIMITED"].includes(e)).default("FREE"),DEBUG:s.optional().default("false"),CHAT_API_TIMEOUT:o.z.coerce.number().optional(),RADAR_HIGH_RISK_KEYWORDS:o.z.string().min(1).transform(e=>e.split(",")).optional(),RADAR_INTERMEDIATE_RISK_KEYWORDS:o.z.string().min(1).transform(e=>e.split(",")).optional(),RADAR_CUMULATIVE_KEYWORDS:o.z.string().min(1).transform(e=>e.split("/").map(e=>e.split(",").map(e=>e.split("|")))).optional(),TRADEMARK_VIOLATION_KEYWORDS:o.z.string().min(1).transform(e=>e.split(",")).optional(),LANDING_PAGE_URL:o.z.preprocess(e=>e&&"string"==typeof e&&e.length>0||"preview"!==l.env.VERCEL_ENV||!l.env.VERCEL_LANDING_PROJECT_NAME?e:"https://".concat(l.env.VERCEL_BRANCH_URL),o.z.string().url().optional())},client:{NEXT_PUBLIC_E2E_TEST:s.optional(),NEXT_PUBLIC_VIEWER_URL:o.z.preprocess(e=>e&&"string"==typeof e&&e.length>0||"preview"!==l.env.VERCEL_ENV||!l.env.VERCEL_BUILDER_PROJECT_NAME||!l.env.NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME?e:l.env.VERCEL_BRANCH_URL.includes(l.env.NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME)?"https://".concat(l.env.VERCEL_BRANCH_URL):"https://".concat(l.env.VERCEL_BRANCH_URL).replace(l.env.VERCEL_BUILDER_PROJECT_NAME,l.env.NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME),o.z.string().min(1).transform(e=>e.split(","))),NEXT_PUBLIC_ONBOARDING_TYPEBOT_ID:o.z.string().min(1).optional(),NEXT_PUBLIC_BOT_FILE_UPLOAD_MAX_SIZE:o.z.coerce.number().optional(),NEXT_PUBLIC_CHAT_API_URL:o.z.string().url().optional(),NEXT_PUBLIC_VIEWER_404_TITLE:o.z.string().optional().default("404"),NEXT_PUBLIC_VIEWER_404_SUBTITLE:o.z.string().optional().default("The bot you're looking for doesn't exist")},runtimeEnv:{NEXT_PUBLIC_E2E_TEST:i("NEXT_PUBLIC_E2E_TEST"),NEXT_PUBLIC_VIEWER_URL:i("NEXT_PUBLIC_VIEWER_URL"),NEXT_PUBLIC_ONBOARDING_TYPEBOT_ID:i("NEXT_PUBLIC_ONBOARDING_TYPEBOT_ID"),NEXT_PUBLIC_BOT_FILE_UPLOAD_MAX_SIZE:i("NEXT_PUBLIC_BOT_FILE_UPLOAD_MAX_SIZE"),NEXT_PUBLIC_CHAT_API_URL:i("NEXT_PUBLIC_CHAT_API_URL"),NEXT_PUBLIC_USE_EXPERIMENTAL_CHAT_API_ON:i("NEXT_PUBLIC_USE_EXPERIMENTAL_CHAT_API_ON"),NEXT_PUBLIC_VIEWER_404_TITLE:i("NEXT_PUBLIC_VIEWER_404_TITLE"),NEXT_PUBLIC_VIEWER_404_SUBTITLE:i("NEXT_PUBLIC_VIEWER_404_SUBTITLE")}},u={server:{GITHUB_CLIENT_ID:o.z.string().min(1).optional(),GITHUB_CLIENT_SECRET:o.z.string().min(1).optional()}},c={server:{FACEBOOK_CLIENT_ID:o.z.string().min(1).optional(),FACEBOOK_CLIENT_SECRET:o.z.string().min(1).optional()}},p={server:{SMTP_USERNAME:o.z.string().min(1).optional(),SMTP_PASSWORD:o.z.string().min(1).optional(),SMTP_HOST:o.z.string().min(1).optional(),SMTP_PORT:o.z.coerce.number().optional().default(25),SMTP_AUTH_DISABLED:s.optional().default("false"),SMTP_SECURE:s.optional().default("false"),SMTP_IGNORE_TLS:s.optional()},client:{NEXT_PUBLIC_SMTP_FROM:o.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_SMTP_FROM:i("NEXT_PUBLIC_SMTP_FROM")}},m={server:{GITLAB_CLIENT_ID:o.z.string().min(1).optional(),GITLAB_CLIENT_SECRET:o.z.string().min(1).optional(),GITLAB_BASE_URL:o.z.string().url().optional().default("https://gitlab.com"),GITLAB_NAME:o.z.string().min(1).optional().default("GitLab"),GITLAB_REQUIRED_GROUPS:o.z.string().transform(e=>e?e.split(","):void 0).optional()}},b={server:{AZURE_AD_CLIENT_ID:o.z.string().min(1).optional(),AZURE_AD_CLIENT_SECRET:o.z.string().min(1).optional(),AZURE_AD_TENANT_ID:o.z.string().min(1).optional()}},g={server:{CUSTOM_OAUTH_NAME:o.z.string().min(1).optional().default("Custom OAuth"),CUSTOM_OAUTH_SCOPE:o.z.string().min(1).optional().default("openid profile email"),CUSTOM_OAUTH_CLIENT_ID:o.z.string().min(1).optional(),CUSTOM_OAUTH_CLIENT_SECRET:o.z.string().min(1).optional(),CUSTOM_OAUTH_WELL_KNOWN_URL:o.z.string().url().optional(),CUSTOM_OAUTH_USER_ID_PATH:o.z.string().min(1).optional().default("id"),CUSTOM_OAUTH_USER_EMAIL_PATH:o.z.string().min(1).optional().default("email"),CUSTOM_OAUTH_USER_NAME_PATH:o.z.string().min(1).optional().default("name"),CUSTOM_OAUTH_USER_IMAGE_PATH:o.z.string().min(1).optional().default("image"),CUSTOM_OAUTH_ISSUER:o.z.preprocess(e=>{var t;return e||(null==(t=l.env.CUSTOM_OAUTH_WELL_KNOWN_URL)?void 0:t.split("/.well-known")[0])},o.z.string().url().optional())}},h={server:{GOOGLE_AUTH_CLIENT_ID:o.z.string().min(1).optional(),GOOGLE_AUTH_CLIENT_SECRET:o.z.string().min(1).optional()}},y={server:{GOOGLE_SHEETS_CLIENT_ID:o.z.string().min(1).optional(),GOOGLE_SHEETS_CLIENT_SECRET:o.z.string().min(1).optional()},client:{NEXT_PUBLIC_GOOGLE_SHEETS_API_KEY:o.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_GOOGLE_SHEETS_API_KEY:i("NEXT_PUBLIC_GOOGLE_SHEETS_API_KEY")}},f={client:{NEXT_PUBLIC_GOOGLE_FONTS_API_KEY:o.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_GOOGLE_FONTS_API_KEY:i("NEXT_PUBLIC_GOOGLE_FONTS_API_KEY")}},v={server:{STRIPE_SECRET_KEY:o.z.string().min(1).optional(),STRIPE_WEBHOOK_SECRET:o.z.string().min(1).optional(),STRIPE_STARTER_PRICE_ID:o.z.string().min(1).optional(),STRIPE_STARTER_CHATS_PRICE_ID:o.z.string().min(1).optional(),STRIPE_PRO_PRICE_ID:o.z.string().min(1).optional(),STRIPE_PRO_CHATS_PRICE_ID:o.z.string().min(1).optional()},client:{NEXT_PUBLIC_STRIPE_PUBLIC_KEY:o.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_STRIPE_PUBLIC_KEY:i("NEXT_PUBLIC_STRIPE_PUBLIC_KEY")}},w={server:{S3_ACCESS_KEY:o.z.string().min(1).optional(),S3_SECRET_KEY:o.z.string().min(1).optional(),S3_BUCKET:o.z.string().min(1).optional().default("typebot"),S3_PORT:o.z.coerce.number().optional(),S3_ENDPOINT:o.z.string().min(1).optional(),S3_SSL:s.optional().default("true"),S3_REGION:o.z.string().min(1).optional(),S3_PUBLIC_CUSTOM_DOMAIN:o.z.string().url().optional()}},I={client:{NEXT_PUBLIC_GIPHY_API_KEY:o.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_GIPHY_API_KEY:i("NEXT_PUBLIC_GIPHY_API_KEY")}},E={server:{VERCEL_TOKEN:o.z.string().min(1).optional(),VERCEL_TEAM_ID:o.z.string().min(1).optional(),VERCEL_GIT_COMMIT_SHA:o.z.string().min(1).optional(),VERCEL_BUILDER_PROJECT_NAME:o.z.string().min(1).optional(),VERCEL_LANDING_PROJECT_NAME:o.z.string().min(1).optional()},client:{NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME:o.z.string().min(1).optional(),NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA:o.z.string().min(1).optional(),NEXT_PUBLIC_VERCEL_ENV:o.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME:i("NEXT_PUBLIC_VERCEL_VIEWER_PROJECT_NAME"),NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA:i("NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA"),NEXT_PUBLIC_VERCEL_ENV:i("NEXT_PUBLIC_VERCEL_ENV")}},x={server:{SLEEKPLAN_SSO_KEY:o.z.string().min(1).optional()}},_={client:{NEXT_PUBLIC_UNSPLASH_APP_NAME:o.z.string().min(1).optional(),NEXT_PUBLIC_UNSPLASH_ACCESS_KEY:o.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_UNSPLASH_APP_NAME:i("NEXT_PUBLIC_UNSPLASH_APP_NAME"),NEXT_PUBLIC_UNSPLASH_ACCESS_KEY:i("NEXT_PUBLIC_UNSPLASH_ACCESS_KEY")}},T={client:{NEXT_PUBLIC_PEXELS_API_KEY:o.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_PEXELS_API_KEY:i("NEXT_PUBLIC_PEXELS_API_KEY")}},C={server:{META_SYSTEM_USER_TOKEN:o.z.string().min(1).optional(),WHATSAPP_PREVIEW_FROM_PHONE_NUMBER_ID:o.z.string().min(1).optional(),WHATSAPP_PREVIEW_TEMPLATE_NAME:o.z.string().min(1).optional(),WHATSAPP_PREVIEW_TEMPLATE_LANG:o.z.string().min(1).optional().default("en_US"),WHATSAPP_CLOUD_API_URL:o.z.string().url().optional().default("https://graph.facebook.com"),WHATSAPP_INTERACTIVE_GROUP_SIZE:o.z.coerce.number().optional().default(3)}},S={server:{REDIS_URL:o.z.string().url().optional()}},k={server:{SENTRY_DSN:o.z.string().min(1).optional(),SENTRY_AUTH_TOKEN:o.z.string().min(1).optional(),SENTRY_PROJECT:o.z.string().min(1).optional(),SENTRY_ORG:o.z.string().min(1).optional()}},N={server:{MESSAGE_WEBHOOK_URL:o.z.string().url().optional(),USER_CREATED_WEBHOOK_URL:o.z.string().url().optional()}},A={client:{NEXT_PUBLIC_POSTHOG_KEY:o.z.string().min(1).optional()},server:{POSTHOG_API_HOST:o.z.preprocess(e=>e||l.env.POSTHOG_API_HOST,o.z.string().url().optional().default("https://us.posthog.com")),POSTHOG_PERSONAL_API_KEY:o.z.string().min(1).optional(),POSTHOG_PROJECT_ID:o.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_POSTHOG_KEY:i("NEXT_PUBLIC_POSTHOG_KEY")}},P={client:{NEXT_PUBLIC_TOLGEE_API_KEY:o.z.string().min(1).optional(),NEXT_PUBLIC_TOLGEE_API_URL:o.z.string().url().optional().default('https://tolgee.server.baptistearno.com"')},runtimeEnv:{NEXT_PUBLIC_TOLGEE_API_KEY:i("NEXT_PUBLIC_TOLGEE_API_KEY"),NEXT_PUBLIC_TOLGEE_API_URL:null!=(a=i("NEXT_PUBLIC_TOLGEE_API_URL"))?a:"https://tolgee.server.baptistearno.com"}},R={server:{KEYCLOAK_CLIENT_ID:o.z.string().min(1).optional(),KEYCLOAK_CLIENT_SECRET:o.z.string().min(1).optional(),KEYCLOAK_REALM:o.z.string().min(1).optional(),KEYCLOAK_BASE_URL:o.z.string().url().optional()}},j={client:{NEXT_PUBLIC_PARTYKIT_HOST:o.z.string().min(1).optional()},runtimeEnv:{NEXT_PUBLIC_PARTYKIT_HOST:i("NEXT_PUBLIC_PARTYKIT_HOST")}},L=(0,r.w)({server:{...d.server,...u.server,...c.server,...p.server,...h.server,...y.server,...v.server,...w.server,...E.server,...x.server,...C.server,...S.server,...m.server,...b.server,...g.server,...k.server,...N.server,...R.server,...A.server},client:{...d.client,...p.client,...y.client,...f.client,...v.client,...I.client,...E.client,..._.client,...T.client,...A.client,...P.client,...j.client},experimental__runtimeEnv:{...d.runtimeEnv,...p.runtimeEnv,...y.runtimeEnv,...f.runtimeEnv,...v.runtimeEnv,...I.runtimeEnv,...E.runtimeEnv,..._.runtimeEnv,...T.runtimeEnv,...A.runtimeEnv,...P.runtimeEnv,...j.runtimeEnv},skipValidation:"true"===l.env.SKIP_ENV_CHECK||void 0===window.__ENV,onValidationError(e){throw console.error("❌ Invalid environment variables:",e.flatten().fieldErrors),Error("Invalid environment variables: ".concat(JSON.stringify(e.flatten().fieldErrors)))},onInvalidAccess:e=>{throw Error("❌ Attempted to access a server-side environment variable on the client: ".concat(e))}})},27693:()=>{},28157:(e,t,n)=>{"use strict";n.d(t,{hK:()=>r,lG:()=>i,at:()=>o});let a={orange:{light:{1:"#fefcfb",2:"#fff4f0",3:"#ffe8de",4:"#ffd6c7",5:"#ffc8b5",6:"#ffb8a0",7:"#ffa286",8:"#f98868",9:"#ff5924",10:"#f24905",11:"#dc3b00",12:"#5b2a1c"},dark:{1:"#120b09",2:"#1f1411",3:"#371810",4:"#4e1606",5:"#5e1e0b",6:"#6e2c18",7:"#873c26",8:"#ad4d31",9:"#ff5924",10:"#f14b0f",11:"#ff9776",12:"#ffd7ca"}},gray:{light:{1:"#ffffff",2:"#f1f1f1",3:"#f0f0f0",4:"#e8e8e8",5:"#e0e0e0",6:"#dfdfdf",7:"#cecece",8:"#bbbbbb",9:"#8d8d8d",10:"#838383",11:"#464646",12:"#202020"},dark:{1:"#0D0D0D",2:"#1D1D1D",3:"#222222",4:"#2a2a2a",5:"#313131",6:"#3a3a3a",7:"#484848",8:"#606060",9:"#6e6e6e",10:"#7b7b7b",11:"#b4b4b4",12:"#eeeeee"}}};var r=function(e){return e.COLOR="Color",e.IMAGE="Image",e.NONE="None",e}({});let o="Color",i={6:"#FFFFFF","6.1":a.gray.light["2"]};a.orange.light["9"],a.gray.light["3"],a.gray.light["9"],a.gray.light["1"],a.gray.light["12"],a.gray.light["6"],a.orange.light["9"],a.gray.light["1"],a.orange.light["6"],a.orange.light["9"],a.gray.light["1"],a.orange.light["8"],a.gray.light["12"],a.gray.light["7"]},47668:()=>{},51511:(e,t,n)=>{"use strict";n.d(t,{Y:()=>a,f:()=>r});let a=e=>"\x3c!-- Google Tag Manager --\x3e\n(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\nnew Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\nj=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n})(window,document,'script','dataLayer','".concat(e,"');\n\x3c!-- End Google Tag Manager --\x3e"),r=e=>{if(document.getElementById("gtm-noscript"))return"";let t=document.createElement("noscript");t.id="gtm-noscript";let n=document.createElement("iframe");return n.src="https://www.googletagmanager.com/ns.html?id=".concat(e),n.height="0",n.width="0",n.style.display="none",n.style.visibility="hidden",t.appendChild(n),t}},57246:()=>{},57608:()=>{},57633:()=>{},59393:(e,t,n)=>{"use strict";n.d(t,{M:()=>o});var a=n(6029),r=n(3735);let o=e=>{let{error:t}=e;return(0,a.jsx)("div",{style:{height:"100dvh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",padding:"0 1rem"},children:r._.NEXT_PUBLIC_VIEWER_URL[0]?(0,a.jsx)("p",{style:{fontSize:"24px",textAlign:"center"},children:t.message}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h1",{style:{fontWeight:"bold",fontSize:"30px"},children:"NEXT_PUBLIC_VIEWER_URL is missing"}),(0,a.jsxs)("h2",{children:["Make sure to configure the app properly (",(0,a.jsx)("a",{href:"https://docs.typebot.io/self-hosting/configuration",children:"https://docs.typebot.io/self-hosting/configuration"}),")"]})]})})}},69443:(e,t,n)=>{"use strict";n.d(t,{L6:()=>a});let a={general:{isInputPrefillEnabled:!1,isHideQueryParamsEnabled:!0,isNewResultOnRefreshEnabled:!0,rememberUser:{isEnabled:!1,storage:"session"},isBrandingEnabled:!1,isTypingEmulationEnabled:!0},typingEmulation:{enabled:!0,speed:400,maxDelay:3,delayBetweenBubbles:0,isDisabledOnFirstMessage:!0},metadata:{description:"Build beautiful conversational forms and embed them directly in your applications without a line of code. Triple your response rate and collect answers that has more value compared to a traditional form.",favIconUrl:e=>e+"/favicon.svg",imageUrl:e=>e+"/site-preview.png"}}},73848:()=>{},83814:(e,t,n)=>{"use strict";n.d(t,{j:()=>o});var a=n(6029),r=n(3735);let o=()=>(0,a.jsxs)("div",{style:{height:"100dvh",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,a.jsx)("h1",{style:{fontWeight:"bold",fontSize:"30px"},children:r._.NEXT_PUBLIC_VIEWER_404_TITLE}),(0,a.jsx)("h2",{children:r._.NEXT_PUBLIC_VIEWER_404_SUBTITLE})]})},86973:()=>{},92490:()=>{},96059:(e,t,n)=>{"use strict";n.d(t,{a:()=>a,b:()=>r});var a=e=>{e&&gtag("event",e.action,{event_category:e.category,event_label:e.label,value:e.value})},r=e=>new Promise(t=>{let n=document.getElementById("gtag");if(!n){let n=document.createElement("script");n.src="https://www.googletagmanager.com/gtag/js?id=".concat(e),n.id="gtag";let a=document.createElement("script");a.innerHTML="window.dataLayer = window.dataLayer || [];\n      function gtag(){dataLayer.push(arguments);}\n      gtag('js', new Date());\n\n      gtag('config', '".concat(e,"');\n      "),document.body.appendChild(n),document.body.appendChild(a),n.onload=()=>{t()}}n&&t()})},98965:(e,t,n)=>{"use strict";n.d(t,{k:()=>p});var a=n(6029),r=n(3735),o=n(2283),i=n(69443),l=n(95669),s=n.n(l),d=n(6772),u=n.n(d),c=n(51511);let p=e=>{let{url:t,typebotName:n,isMatchingViewerUrl:l,metadata:{title:d,description:p,favIconUrl:m,imageUrl:b,googleTagManagerId:g,allowIndexing:h}={}}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s(),{children:[(0,a.jsx)("title",{children:null!=d?d:n}),l&&!0!==h?(0,a.jsx)("meta",{name:"robots",content:"noindex"}):null,(0,a.jsx)("link",{rel:"icon",type:m?"image/png":"images/svg+xml",href:null!=m?m:i.L6.metadata.favIconUrl(r._.NEXT_PUBLIC_VIEWER_URL[0])}),(0,a.jsx)("meta",{name:"title",content:null!=d?d:n}),(0,a.jsx)("meta",{name:"description",content:null!=p?p:"Build beautiful conversational forms and embed them directly in your applications without a line of code. Triple your response rate and collect answers that has more value compared to a traditional form."}),(0,a.jsx)("meta",{property:"og:type",content:"website"}),(0,a.jsx)("meta",{property:"og:url",content:null!=t?t:"https://bot.typebot.io"}),(0,a.jsx)("meta",{property:"og:title",content:null!=d?d:n}),(0,a.jsx)("meta",{property:"og:site_name",content:null!=d?d:n}),(0,a.jsx)("meta",{property:"og:description",content:null!=p?p:"Build beautiful conversational forms and embed them directly in your applications without a line of code. Triple your response rate and collect answers that has more value compared to a traditional form."}),(0,a.jsx)("meta",{property:"og:image",itemProp:"image",content:null!=b?b:i.L6.metadata.imageUrl(r._.NEXT_PUBLIC_VIEWER_URL[0])}),(0,a.jsx)("meta",{property:"twitter:card",content:"summary_large_image"}),(0,a.jsx)("meta",{property:"twitter:url",content:null!=t?t:"https://bot.typebot.io"}),(0,a.jsx)("meta",{property:"twitter:title",content:null!=d?d:n}),(0,a.jsx)("meta",{property:"twitter:description",content:null!=p?p:"Build beautiful conversational forms and embed them directly in your applications without a line of code. Triple your response rate and collect answers that has more value compared to a traditional form."}),(0,a.jsx)("meta",{property:"twitter:image",content:null!=b?b:i.L6.metadata.imageUrl(r._.NEXT_PUBLIC_VIEWER_URL[0])})]},"seo"),(0,o.hj)(g)&&(0,a.jsx)(u(),{id:"google-tag-manager",children:(0,c.Y)(g)})]})}}}]);